window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},Microsoft.Maps.Gimme=function(){var n=function(){function n(n){Array.prototype.push.apply(this,n)}function t(i,r){var u=!i&&[]||(r||typeof i=="string")&&t.query(i,r)||i instanceof Array&&i||[i];return new n(u)}function i(n,t){var i;for(i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i])}return i(n,{length:Array.prototype.length,entities:function(){return Array.prototype.slice.apply(this)},sort:function(n){return Array.prototype.sort.call(this,n),this},reverse:function(){return Array.prototype.reverse.call(this),this},push:function(){return Array.prototype.push.apply(this,arguments),this},pop:function(){var t=Array.prototype.pop.call(this);return new n([t])},shift:function(){var t=Array.prototype.shift.call(this);return new n([t])},unshift:function(){return Array.prototype.unshift.apply(this,arguments),this},slice:function(){return new n(Array.prototype.slice.apply(this,arguments))},splice:function(){return new n(Array.prototype.splice.apply(this,arguments))},concat:function(t){return new n(Array.prototype.concat.apply(this.entities(),t.entities&&t.entities()||arguments))}}),t.Helper={get_guid:function(){var n=0;return function(t){if(!t)return"";if(t===window)return"win";if(t===document)return"doc";if(t.uniqueID)return t.uniqueID;var i="__$gimme$_guid__";return typeof t[i]=="undefined"&&(t[i]=i+n++),t[i]}}()},t.Browser=function(){var n=navigator.userAgent.toLowerCase();return{is_ie:typeof ActiveXObject!="undefined",is_opera:typeof window.opera!="undefined",is_khtml:n.indexOf("khtml")!==-1,is_gecko:n.indexOf("khtml")===-1&&n.indexOf("gecko")!==-1,is_in_quirks_mode:document.compatMode==="BackCompat"}}(),t.undefined={}._$gimme$_undefined,t.ext=n.prototype,t}();return n.ext.select=function(t){return n(t,this[0])},typeof g=="undefined"&&(window.g=n),n.Internals=new function(){function n(n){return function(t,i,r){this[n](t,i,r)}}return{addEventListener:n("addEventListener"),removeEventListener:n("removeEventListener"),attachEvent:n("attachEvent"),detachEvent:n("detachEvent"),parseJSON:function(n){return JSON.parse(n)}}},n.query=function(){return function(){function d(n,t,i){return u[t](n,i)}function k(n,t){var r=[],u=t.length,i;do i=p(n,t[--u]||t),i&&r.push(i);while(u);return r}function p(n,t){if(n===document||!t)return t;var i=t;while((i=i.parentNode)&&i!==n);return i===n&&t||null}function g(n,t){return p(n,document.getElementById(t))}function w(n,t){var u,f,i,e;t=t||document;if(n.id)return o([g(t,n.id)],n);delete n.id,u=t.getElementsByTagName(n.tag||"*");if((!n.classes||n.classes.length<1)&&(!n.attributes||n.attributes.length<1)&&(!n.pseudos||n.pseudos.length<1))return a(u);for(f=[],e=u.length,i=0;i<e;i++)r(n,u[i])&&f.push(u[i]);return f}function r(n,t){if(!t)return!1;for(var r=n.propNames,f=r.length,i=0;i<f;i++)if(!u[r[i]](t,n[r[i]]))return!1;return!0}function a(n){for(var i=[],r=n.length,t=0;t<r;t++)i[t]=n[t];return i}function o(n,t){for(var u=[],f=n.length,i=0;i<f;i++)n[i]&&n[i].nodeType===1&&r(t,n[i])&&u.push(n[i]);return u}function l(n,t){return h(n,t)!==-1}function c(n){var r;i.inc();for(var f=i.name,u=[],e=n.length,t=0;t<e;t++)r=n[t],r[f]!==i.t&&(r[f]=i.t,u.push(r));return u}function e(n){this.name=n,this.f=0,this.t=1,this.inc=function(){this.f=(this.t+=2)-1}}function b(n){this.parse=function(t){var f,i,e,o=n.preprocessInput,r,u;t=o&&o(t)||t,n.reset(),r=0,u=t.length;while(r<u){f=t.charAt(r),i=i||n[f]||n["default"];if(i){e=i(t.substring(r,u));if(!e)throw'No valid match found for "'+i.name+'" rule';r+=e}else throw'No suitable rule found to handle character "'+f+'"';i=null}return n.finish()}}function s(t,i){var b=i,e,r,h,o,c,l,s;i=i||document,n.inc();if(typeof t!="string")return k(i||document,t);r=[];try{r=a(i.querySelectorAll(t))}catch(p){for(h=y.parse(t),c=h.length,o=0;o<c;o++){var u=h[o],v=u.length,f=v%2-1;e=f===0?w(u[f],i):[i||document];while(u[++f])l=u[f++],s=u[f],s.root=i,e=d(e,l,s);r=c>1?r.concat(e):e}}return r}var i,t,n,u,v,y,h=function(){function t(n,t){return n.indexOf(t)}function n(n,t){for(var r=n.length,i=0;i<r;i++)if(n[i]===t)return i;return-1}return typeof Array.prototype.indexOf!="undefined"?t:n}(),f=function(){function t(n,t){return n.getAttribute(t)}function n(n,t){switch(t.toLowerCase()){case"class":return n.className||null;case"id":return n.id||null;case"href":case"src":if(typeof n.getAttribute!="undefined")return n.getAttribute(t,2)}return n.attributes&&n.attributes[t]&&n.attributes[t].nodeValue||n.getAttribute(t)}return function(){var r=document.createElement("div"),i;return r.innerHTML='<a href="#test">test</a>',i=r.firstChild,i.getAttribute("href")==="#test"?t:n}()}();return i=new e("__$gimme$_unique__"),t=new e("__$gimme$_genSib__"),n=new e("__$gimme$_nth__"),u={id:function(n,t){return n.id===t},tag:function(n,t){return n.tagName===t||t==="*"},classes:function(n,t){var i=n.className,u,r;typeof i!="string"&&(i=f(n,"class"));if(!i)return!1;u=" "+i+" ",r=t.length;while(r--)if(u.indexOf(" "+t[r]+" ")===-1)return!1;return!0},attributes:function(){var t={},n={parse:function(n){var i=n.match(/^\[([\w-_]+)?(\=|\^=|\$=|\*=|\|=|~=|!=)?(.*)\]$/);return t[n]={name:i&&i[1],delim:i&&i[2],val:i&&i[3].replace(/^['"]|["']$/g,"")}},"=":function(n,t){return n===t},"^=":function(n,t){return n.indexOf(t)===0},"$=":function(n,t){var i=n.lastIndexOf(t);return i!==-1&&i+t.length===n.length},"*=":function(n,t){return n.indexOf(t)!==-1},"|=":function(n,t){return n===t||n.indexOf(t+"-")===0},"~=":function(n,t){return n===t||l(n.split(" "),t)},"!=":function(n,t){return n!==t},unknown:function(){return!1}};return function(i,r){var o=r.length,u,e;while(o--){u=t[r[o]]||n.parse(r[o]),e=f(i,u.name);if(!e)return!1;if(!u.delim)continue;if(!n[u.delim||"unknown"](e,u.val))return!1}return!0}}(),pseudos:function(){function i(n){var t=n+"Sibling";return function(n){var i=n[t];while(i&&i.nodeType!==1)i=i[t];return!i}}var r={},t={parse:function(n){var t=n.match(/([\w-_]+)\b(\((((-?\d*)n)?([+-]?\d+)?|.*)\))?/),i={name:t&&t[1],param:{wholeValue:t&&t[3],a:t&&t[5]||0,b:t&&t[6]||0}};return i.param.wholeValue==="even"?(i.param.a=2,i.param.b=0):i.param.wholeValue==="odd"&&(i.param.a=2,i.param.b=1),r[n]=i},"first-child":i("previous"),"last-child":i("next"),"only-child":function(n){return t["first-child"](n)&&t["last-child"](n)},"nth-child":function(t,i){var l=1e4,s=n.t*l,u=n.name,r=t.parentNode,h=0,f;if(r){if(r[u+":parent"]!==n.t){r[u+":parent"]=n.t;var h=0,a,e=r.children||r.childNodes,o=-1,c=e.length;while(++o<c)e[o].nodeType===1&&(h++,e[o][u]=s+h)}return f=t[u]-s-i.param.b,!i.param.a&&i.param.b?f===0:i.param.a*f>=0&&f%(i.param.a||1)==0}return!1},contains:function(n,t){return(n.textContent||n.innerText||n.innerHTML).indexOf(t.param.wholeValue)!==-1},not:function(){return!1}};return function(n,i){var f=i.length,u;while(f--){u=r[i[f]]||t.parse(i[f]);if(!t[u.name](n,u))return!1}return!0}}()," ":function(n,t){for(var u=[],f=n.length,r,i=0;i<f;i++){r=w(t,n[i]),u=u.concat(r);if(t.id&&r.length===1)break}return c(u)},">":function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r=r.concat(o(n[i].childNodes,t));return r},"+":function(n,t){for(var e=[],o=n.length,f,i,u=0;u<o;u++){f=n[u],i=f.nextSibling;while(i&&i.nodeType!==1)i=i.nextSibling;r(t,i)&&e.push(i)}return e},"~":function(n,i){var e,u;t.inc();for(var s=t.name,o=[],h=n.length,f=0;f<h;f++){e=n[f],u=e.nextSibling;while(u&&u[s]!==t.t)u.nodeType===1&&(u[s]=t.t,r(i,u)&&o.push(u)),u=u.nextSibling}return o}},v=new function(){function i(){this.propNames=[]}var r,t,n,u;return i.prototype.propNames=[],i.prototype.storePropertyValue=function(n,t){this[n]=t,this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},i.prototype.storeArrayValue=function(n,t){this[n]||(this[n]=[]),this[n].push(t),this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},u={preprocessInput:function(n){return n.replace(/\s*([ >+~,])\s*/g,"$1")},reset:function(){r=[],t=[],n=new i},finish:function(){return n&&n.propNames.length>0&&t.push(n),t.length>0&&r.push(t),r},"default":function(t){var u="tag",r=t.match(/(\w+|\*)/),i;return r?(i=r[0].toUpperCase(),n.storePropertyValue(u,i),i.length):null},"#":function(t){var u="id",i=t.match(/#([_\-\w]+)/),r;return i?(r=i[1],n.storePropertyValue(u,r),i[0].length):null},".":function(t){var u="classes",i=t.match(/\.([_\-\w\d]+)/),r;if(i)return r=i[1],n.storeArrayValue(u,r),i[0].length},"[":function(t){var u="attributes",r=t.match(/(\[.*"\]|.*?\])/),i;return r?(i=r[0],n.storeArrayValue(u,i),i.length):null},":":function(t){var u="pseudos",r=t.match(/:[\w-_]+\b(\(.*\))?/),i;return r?(i=r[0],n.storeArrayValue(u,i),i.length):null}," ":function(){return t.push(n," "),n=new i,1},">":function(){return n.propNames.length>0&&t.push(n),t.push(">"),n=new i,1},"~":function(){return t.push(n,"~"),n=new i,1},"+":function(){return t.push(n,"+"),n=new i,1},",":function(){return t.push(n),r.push(t),t=[],n=new i,1}}},y=new b(v),s.Internal={unique:c,index_of:h,contains:l,has_class:u.classes,get_attr:f},s}()}(),n.Helper.index_of=n.query.Internal.index_of,n.Helper.contains=n.query.Internal.contains,n.Helper.unique=n.query.Internal.unique,n.Helper.has_class=n.query.Internal.has_class,n.Helper.get_attr=n.query.Internal.get_attr,n.Effects={Animation:function(n){function s(n){var h=e(n),o=t.length,r,s;while(o--){s={};for(r in u)s[r]=i[r][o]+u[r][o]*h;f(t[o],s,n)}}var t=n.elements||[],o=n.duration||1,i=n.from||{},r=n.to||{},u={},f,e;(function(){var f,n,h,e={},o={},s={};for(n in i){e[n]=[],o[n]=[],s[n]=[],f=t.length;while(f--)h=t[f],e[n][f]=typeof i[n]=="function"?i[n](h,n):i[n],o[n][f]=typeof r[n]=="function"?r[n](h,n):r[n],s[n][f]=o[n][f]-e[n][f]}i=e,r=o,u=s})(),f=n.animate,e=n.easing||function(n){return n},this.startTime=n.startTime||0,this.duration=o,this.add_element=function(n){t.push(n)},this.remove_element=function(n){var i=t.length;while(i--)if(t[i]===n){t.splice(i,1);break}},this.tick=s},Storyboard:function(n){function r(){f||(f=!0,e=+new Date,l=setInterval(b,1))}function nt(){t=0,i=1,r()}function w(){s(),a&&a(t)}function s(){clearInterval(l),f=!1}function g(){r()}function d(){i=1,r()}function rt(){i=-1,r()}function it(){i*=-1,r()}function tt(n){t=n,h()}function p(){return f}function y(){return i}function v(){return u}function k(){return o}function b(){var n=+new Date;t+=(n-e)/o*i,e=n,t=t<0?0:t>1?1:t,h(),(i===-1&&t===0||i===1&&t===1)&&(s(),c&&c(t))}function h(){var r=u.length,n;while(r--)n=(o*t-u[r].startTime)/u[r].duration,n=i===-1&&n<0?0:i===1&&n>1?1:n,n<0||n>1||u[r].tick(n)}var l,e,t=0,i=1,f=!1,u=n.animations,o=n.duration||0,c=n.completed,a=n.aborted;this.begin=nt,this.abort=w,this.pause=s,this.resume=g,this.forward=d,this.backward=rt,this.reverse=it,this.seek=tt,this.is_running=p,this.get_direction=y,this.get_animations=v,this.get_duration=k},Easing:{Back:new function(){function i(n,t,i,r){return t=.5,i=0,r=.5,Math.pow(1-n,i)*r*Math.sin(2*Math.PI*n*t)*-1+n}function t(){}function n(){}this.ease_in=i,this.ease_out=t,this.ease_in_out=n},Bounce:new function(){function r(n,t,i){return t=t||1.5,i=i||4,Math.abs(Math.pow(n,t)*Math.cos(Math.PI*n*i))}function i(t,i,r){return 1-n.Effects.Easing.Bounce.ease_in(1-t,i,r)}function t(t,i,r){var e=1,f=0,u=n.Effects.Easing.Bounce.ease_in;return t>.5&&(u=n.Effects.Easing.Bounce.ease_out,t-=.5,f=e/2),u(t,i,r)-f}this.ease_in=r,this.ease_out=i,this.ease_in_out=t},Elastic:new function(){function i(){}function t(n,t,i){return t=t||3.5,i=i||5,1-Math.pow(1-n,t)*Math.cos(2*Math.PI*n*i)}function n(){}this.ease_in=i,this.ease_out=t,this.ease_in_out=n},Exponential:new function(){function t(n,t){return Math.pow(n,t)}function n(n,t){return Math.pow(n,1/t)}function i(i,r){return i<=.5?t(i*2,r)*.5:n((i-.5)*2,r)*.5+.5}this.ease_in=t,this.ease_out=n,this.ease_in_out=i}},Enums:{Directions:{vertically:1,horizontally:2,both:3},Speeds:{quickly:500,slowly:1e3}},RunningAnimations:function(){var t={};return{add:function(n,i){t[n]=i},remove:function(n){delete t[n]},get:function(i){return t[i]||new n.Effects.Storyboard({animations:[]})},contains:function(n){return!!t[n]}}}()},n.Effects.Storyboard.create=function(t,i,r,u,f,e,o,s){f=Math.floor(f)||n.Effects.Enums.Speeds[f]||n.Effects.Enums.Speeds.quickly;var h=new n.Effects.Storyboard({duration:f,completed:function(){o&&o.call(this),n.Effects.RunningAnimations.remove(e),h=null},aborted:function(){n.Effects.RunningAnimations.remove(e),h=null},animations:[new n.Effects.Animation({from:i,to:r,duration:f,animate:u,easing:s,elements:t})]});return e&&n.Effects.RunningAnimations.add(e,h),h},function(){var t=0,i={};n.Effects.Animation.requestAnimationFrame=function(){function r(n,t){return function(){i[t]&&n(+new Date),delete i[t]}}function e(n,f){var e=i[++t]=r(n,t);return u(e,f),t}function f(u){var f=i[++t]=r(u,t);return n.setTimeout(f,o),t}var o=16,n=window,u=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame;return u?e:f}(),n.Effects.Animation.cancelAnimationFrame=function(n){delete i[n]}}(),n.Ajax=new function(){function i(n,i){t(n,i,!0)}function u(n,i){t(n,i,!1)}function r(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){throw new Error("Error invoking XMLHTTP");}else throw new Error("XMLHttp is not supported");}function t(t,i,u){var f=r();f.onreadystatechange=function(){if(f.readyState===4){var t=f.responseText;u&&t&&(t=n.Internals.parseJSON(t)),i.call(f,t,f.status),f=null,i=null}},f.open("GET",t,!0),f.send("")}this.request_json=i,this.request_ahah=u},n.Screen=new function(){function r(){var n={width:0,height:0};return n=typeof window.innerWidth!="undefined"?{width:window.innerWidth,height:window.innerHeight}:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0?{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}:{width:document.getElementsByTagName("body")[0].clientWidth,height:document.getElementsByTagName("body")[0].clientHeight}}function i(n){var t,i;return n=n||window.event,t={x:0,y:0},typeof n.pageX!="undefined"?(t.x=n.pageX,t.y=n.pageY):(i=this.get_scroll_pos(),t.x=n.clientX+i.x,t.y=n.clientY+i.y),t}function t(){return n(window).get_scroll_pos()}this.get_viewport_size=r,this.get_mouse_pos=i,this.get_scroll_pos=t},n.Util=new function(){function t(){return n(arguments,!1)}function i(){return n(arguments,!0)}function n(n,t){function i(){u.apply(this,Array.prototype.slice.call(n,2)),t||(u=null)}var u=n[0],r=n[1];return t===!0?window.setInterval(i,r):window.setTimeout(i,r)}this.set_timeout=t,this.set_interval=i},n.Style=new function(){function o(i){var f=i.scrollTop&&i!==document.documentElement&&i!==document.body&&i.tagName!=="TEXTAREA"&&i.tagName!=="INPUT"?-1:0,r={x:i.scrollLeft*f,y:i.scrollTop*f},u;return n.Browser.is_ie&&t(i,"position")==="static"?(u=i.style.position,i.style.position="relative",r.x+=i.offsetLeft,r.y+=i.offsetTop,i.style.position=u):(r.x+=i.offsetLeft,r.y+=i.offsetTop),r}function a(i){var r={x:0,y:0},u;if(i.getBoundingClientRect){var f=i.getBoundingClientRect(),c=s(),e=n(window).get_scroll_pos();r.x=f.left-c.x+e.x,r.y=f.top-c.y+e.y}else while(i!==null)u=o(i),r.x+=u.x,r.y+=u.y,i=i.offsetParent,i&&!h()&&(r.x+=parseFloat(t(i,"borderLeftWidth"))||0,r.y+=parseFloat(t(i,"borderTopWidth"))||0);return r}function h(){var n,t;return typeof arguments.callee.constantValue=="undefined"&&(n=document.createElement("div"),n.style.cssText="position:absolute;visibility:hidden;top:0;left:0;border:1px solid #000;",t=document.createElement("div"),n.appendChild(t),document.body.appendChild(n),arguments.callee.constantValue=t.offsetTop===1,document.body.removeChild(n),n=t=null),arguments.callee.constantValue}function s(){var i,r;if(typeof arguments.callee.constantValue=="undefined"){var t=document.body,f=t.style.position,u=t.style.margin,e=t.style.border;t.style.position="static",t.style.margin="0",t.style.border="1px solid transparent",i=t.getBoundingClientRect(),r=n(window).get_scroll_pos(),arguments.callee.constantValue={x:i.left+r.x,y:i.top+r.y},t.style.position=f,t.style.margin=u,t.style.border=e,document.documentElement.className=document.documentElement.className}return arguments.callee.constantValue}function t(n,t){var i="",f,e,r;return n.currentStyle&&(t==="right"||t==="bottom")?i=u(t,"auto","auto",n)+"px":(f=document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(n,null)||n.currentStyle,f&&(i=f[t]||"",e=i.match(/px$/),e||(r=i.match(/(em|ex|%|in|cm|mm|pt|pc|small|medium|large|thin|thick|auto)$/),r&&(i=u(t,i,r[0],n)+"px")))),i}function u(i,r,u,f){var s,a,y,o,l,h,p,w,c,e,v;if(r){if(u==="px")return parseFloat(r);if(r==="auto")switch(i){case"top":case"left":return 0;case"bottom":case"right":s={bottom:["top","offsetTop","height","offsetHeight"],right:["left","offsetLeft","width","offsetWidth"]},a=n(f);if(a.get_style("position")==="relative")return y=s[i][0],-parseInt(a.get_style(y));o=f.parentNode;while(o!==document&&n(o).get_style("position")==="static")o=o.parentNode;return l=s[i][2],h=o===document?n.Screen.get_viewport_size()[l]:parseInt(n(o).get_style(l)),p=s[i][1],w=s[i][3],h-f[p]-f[w];case"height":return f.clientHeight||f.offsetHeight&&f.offsetHeight-parseFloat(t(f,"borderTopWidth"))-parseFloat(t(f,"borderBottomWidth"))||0;case"width":return f.clientWidth||f.offsetWidth&&f.offsetWidth-parseFloat(t(f,"borderLeftWidth"))-parseFloat(t(f,"borderRightWidth"))||0;default:return 0}else{switch(i){case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":return i=i.replace("Width","Style"),c=t(f,i),c==="none"?0:parseFloat(c)}f=f||document.body,e=document.createElement("div"),e.style.visbility="hidden",e.style.position="absolute",e.style.lineHeight="0",u==="%"?(f=f.parentNode,i==="height"||i==="top"?e.style.height=r:(i==="width"||i==="left")&&(e.style.width=r)):(e.style.borderStyle="solid",e.style.borderBottomWidth="0",e.style.borderTopWidth=r);try{f.appendChild(e)}catch(b){f=f.parentNode,f.appendChild(e)}return f.offsetWidth,f.offsetHeight,v=e.offsetHeight||e.offsetWidth,f.removeChild(e),v}}else return 0}function v(n,t){var i=f(n,t);return i.camelizedName||n}function y(n,t){var i=f(n,t);return i.nonCamelizedName||n}function f(n,t){var u,s,f,o,h;t=t||document.body||document.createElement("div"),u=r[n];if(!u){u={},s=i.length;while(s--){f=i[s],o=e(f+n);if(t.style[o]!==undefined){h=(f&&"-"||"")+f.toLowerCase()+n,u.camelizedName=o,u.nonCamelizedName=h;break}}r[n]=u}return u}function e(n){return n.replace(/-(\w)/g,function(n,t){return t.toUpperCase()})}var l,c,r,i;this.get_relative_pos=o,this.get_absolute_pos=a,this.offset_includes_borders=h,this.get_bounding_client_rect_offsets=s,l=function(){function t(n,t){n.style.opacity=t}function i(n,t){t*=100;var i;try{i=n.filters.item("DXImageTransform.Microsoft.Alpha"),t<100?(i.Opacity=t,i.enabled||(i.enabled=!0)):i.enabled=!1}catch(r){t<100&&(n.style.filter=(n.currentStyle||n.runtimeStyle).filter+" progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")")}}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&t||typeof n.style.filter!="undefined"&&i||function(){}}(),this.set_opacity=l,c=function(){function i(n){return parseFloat(n.style.opacity)||t(n,"opacity")}function r(n){var t=n.filters["DXIMageTransform.Microsoft.Alpha"];return t?t.Opacity/100:1}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&i||typeof n.style.filter!="undefined"&&r||function(){}}(),this.get_opacity=c,this.get_rendered_style=t,this.normalize_style=u,r={},i=["O-","ms-","Moz-","webkit-",""],this.get_camelized_style_name=v,this.get_css_style_name=y,this.camelize=e},n.Events=new function(){var r=n.Helper,i=null,t=null;this.capture_mouse=function(r,u){return n.Events.release_mouse(),i=r,u!==!1&&(u=!0),r.setCapture!==undefined?r.setCapture(u):(t=function(r){var s=r.target,f=document.createEvent("MouseEvents"),o,e;f.initMouseEvent(r.type,r.bubbles,r.cancelable,window,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget),f.__defineGetter__&&(o=n.Screen.get_scroll_pos(),f.__defineGetter__("pageX",function(){return this.clientX+o.x}),f.__defineGetter__("pageY",function(){return this.clientY+o.y})),document.removeEventListener(r.type,t,!0),f.captureTarget=s,e=i,u||n(i).has(s)&&(e=s),e.dispatchEvent(f),t!==null&&document.addEventListener(r.type,t,!0),delete f.captureTarget,r.stopPropagation()},document.addEventListener("mouseover",t,!0),document.addEventListener("mouseout",t,!0),document.addEventListener("mousemove",t,!0),document.addEventListener("mouseup",t,!0),document.addEventListener("mousedown",t,!0),document.addEventListener("click",t,!0),document.addEventListener("dblclick",t,!0)),this},this.release_mouse=function(){return i!==null&&(i.releaseCapture!==undefined?i.releaseCapture():(document.removeEventListener("mouseover",t,!0),document.removeEventListener("mouseout",t,!0),document.removeEventListener("mousemove",t,!0),document.removeEventListener("mouseup",t,!0),document.removeEventListener("mousedown",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("dblclick",t,!0)),i=t=null),this},this.get_capture_target=function(n){return n.captureTarget||n.srcElement||n.target},this.Pseudo=new function(){function t(n,t,i){this.pseudoName=n,this.getNativeName=t,this.getProxiedHandler=i}function v(n,t,i){if(n===t)return!1;var r=0;while(t&&t!=n)r++,t=t.parentNode;return i=i||r,t===n&&i===r}function a(n){var i=r.get_guid(n),t=u[i];return t||(t=u[i]=function(t){var i=t.relatedTarget;if(!i||this===i||v(this,i))return;n.call(this,t)}),t}function p(t){if(!n.Browser.is_gecko)return t;var f=r.get_guid(t),i=u[f];return i||(i=u[f]=function(n){n.wheelDelta=-40*n.detail,t.call(this,n),n.wheelDelta=null}),i}function e(t){if(!n.Browser.is_ie)return t;var e=r.get_guid(t),f=u[e];return f||(f=u[e]=function(u){var o,e,h,s,f;if(u.pointerType===2){u.type==="MSPointerUp"||u.type==="MSPointerCancel"?delete i[u.pointerId]:(o=n.Screen.get_mouse_pos(u),i[u.pointerId]={_$targetId:r.get_guid(u.target),identifier:u.pointerId,pageX:o.x,pageY:o.y}),h=[],s=[];for(e in i)i.hasOwnProperty(e)&&i[e]&&(f=i[e],h.push(f),f._$targetId===r.get_guid(u.target)&&s.push(f));u.touches=h,u.targetTouches=s,u.type==="MSPointerDown"&&(u.preventDefault=y),t.call(this,u),u.touches=u.targetTouches=null}}),f}function y(){return f[this.pointerId]=!0,document.addEventListener("MSPointerUp",c,!0),document.addEventListener("click",h,!0),MSPointerEvent.prototype.preventDefault.call(this)}function c(n){o=n.pointerId,f[o]&&(f[o]=!1)}function h(n){var t,i=0;for(t in f)t=parseInt(t),f[t]===!1&&delete f[t]||i++,t===o&&(n.stopPropagation()||n.preventDefault());i===0&&(document.removeEventListener("MSPointerUp",c,!0),document.removeEventListener("click",h,!0))}function l(){}var o=null,f={},u={},i={},s={touchstart:"MSPointerDown",touchend:"MSPointerUp",touchmove:"MSPointerMove",touchcancel:"MSPointerCancel"};return t.prototype.add=function(n,t,i){n.add_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},t.prototype.remove=function(n,t,i){n.remove_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},{mouseenter:new t("mouseenter",function(){return"mouseover"},function(n){return a(n)}),mouseleave:new t("mouseleave",function(){return"mouseout"},function(n){return a(n)}),mousewheel:new t("mousewheel",function(t){return n.Browser.is_gecko?"DOMMouseScroll":t},function(n){return p(n)}),touchstart:new t("touchstart",function(t){return n.Browser.is_ie?s[t]:t},function(t){return n(document).add_event("touchend",l,!0).add_event("touchcancel",l,!0),e(t)}),touchend:new t("touchend",function(t){return n.Browser.is_ie?s[t]:t},function(n){return e(n)}),touchmove:new t("touchmove",function(t){return n.Browser.is_ie?s[t]:t},function(n){return e(n)}),touchcancel:new t("touchcancel",function(t){return n.Browser.is_ie?s[t]:t},function(n){return e(n)})}}},function(){var f=n.Helper,e=n.Internals,r,t,o={},u={},i={load:!1,unload:!1,focus:!1,blur:!1,beforeunload:!1,stop:!1,beforeprint:!1,afterprint:!1,propertychange:!1,filterchange:!1,readystatechange:!1,losecapture:!1};n.ext.add_event=function(){function h(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].add(this,i,r):this.for_each(function(n){e.addEventListener.call(n,t,i,r)}),this}function s(s,h,c,l){function y(i,r){t=t||1,r.eventPhase=t,r.target=r.srcElement,r.currentTarget=i;var u=n.Screen.get_mouse_pos(r);r.pageX=u.x,r.pageY=u.y;switch(r.type){case"keyup":case"keydown":case"keypress":i.type!=="file"&&(r.keyCode===186?r.keyCode=59:r.keyCode===187?r.keyCode=61:r.keyCode===189?r.keyCode=109:null),r.which=r.keyCode,r.charCode=r.keyCode;break;case"mousedown":case"mouseup":case"click":case"dblclick":case"contextmenu":r.which=[1,1,3,r.button,2][r.button];break;case"mouseover":r.relatedTarget=r.fromElement;break;case"mouseout":r.relatedTarget=r.toElement}return r.preventDefault=function(){r.returnValue=!1},r.stopPropagation=function(){r.cancelBubble=!0},r}function p(n,t,r){var u=i[n],f;return u===!1?!1:(u||(u=i[n]={}),f=u[t],f||(f=u[t]=[]),f.push(r),!0)}function a(n,t){var r=u[n],i;r||(r=u[n]={}),i=r[t],i||(i=r[t]={handlerCount:0,remainingHandlers:0}),i.handlerCount++,i.remainingHandlers=i.handlerCount}function v(n,u){var a=[],l=n,h,e,o,v,c;while(l)a.push(l),l=l.parentNode;while(h=a.pop()){e=f.get_guid(h);if(i[s][e])for(r||(r=h),v=i[s][e].length,o=0;o<v;o++)u.cancelBubble||(h===u.target&&(u.eventPhase=t=2),c=i[s],c[e]&&c[e][o]&&c[e][o].call(h,u))}return r}return!l&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[s]?n.Events.Pseudo[s].add(this,h,c):this.for_each(function(n){var w=f.get_guid(n),k=f.get_guid(h)+(c||!1).toString(),b="{"+w+" / "+s+" / "+k+"}",l;c&&(c=p(s,w,h)),l=o[b],l||(l=function(f){var e=u[s][w];e.remainingHandlers--,f=y(n,f),i[s]&&t===1&&(r=v(n,f)),t=n===f.target?2:3,f.eventPhase=t,!c&&!f.cancelBubble&&h.call(n,f),(!r||f.cancelBubble||n==r&&e.remainingHandlers===0)&&(t=1,r=undefined,e.remainingHandlers=e.handlerCount),f.eventPhase=f.target=f.currentTarget=f.relatedTarget=f.which=f.preventDefault=f.stopPropagation=f.pageX=f.pageY=undefined},o[b]=l,e.attachEvent.call(n,"on"+s,l),a(s,w)),b=null,l=null}),this}return document.addEventListener?h:document.attachEvent?s:function(){}}(),n.ext.remove_event=function(){function r(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,i,r):this.for_each(function(n){e.removeEventListener.call(n,t,i,r)}),this}function t(t,r,s,h){function l(t,r,u){var o=i[t],f,e;o&&(f=o[r],f&&(e=n(f).index_of(u),e!==-1&&f.splice(e,1),f.length===0&&delete o[r]))}function c(n,t){var i=u[n]&&u[n][t];i&&(i.handlerCount>0&&i.handlerCount--,i.remainingHandlers=i.handlerCount)}return!h&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,r,s):this.for_each(function(n){var h=f.get_guid(n),a=f.get_guid(r)+(s||!1).toString(),u="{"+h+" / "+t+" / "+a+"}",i;s&&l(t,h,r),i=o[u],i&&(e.detachEvent.call(n,"on"+t,i),delete o[u],c(t,h)),u=null,i=null}),this}return document.addEventListener?r:document.attachEvent?t:function(){}}()}(),function(){var t=n.Helper;n.ext.add_class=function(i){var r=i.split(/\s+/);return this.for_each(function(i){n(r).for_each(function(n){t.has_class(i,[n])||(i.className===""?i.className=n:i.className+=" "+n)})}),this}}(),n.ext.remove_class=function(n){return this.swap_class(n,"$1")},n.ext.swap_class=function(t,i){i!=="$1"&&(i=" "+i+" ");var r=t.split(/\s+/);return this.for_each(function(t){var u=t.className;n(r).for_each(function(n){var t=new RegExp("(^| )"+n+"( |$)");u=u.replace(t,i)}),t.className=u.replace(/^\s+|\s+$/g,"")}),this},function(){var t=n.Helper;n.ext.has_class=function(n,i){var r=this[i||0];return r&&t.has_class(r,[n])||!1}}(),n.ext.get_html=function(n){var t=this[n||0];return t&&t.innerHTML||""},n.ext.set_html=function(n){return this.for_each(function(t){t.innerHTML=n}),this},n.ext.get_val=function(n){var t=this[n||0];return t&&t.value||""},n.ext.set_val=function(n){return this.for_each(function(t){typeof t.value!="undefined"&&(t.value=n)}),this},function(){var t=n.Helper.get_attr;n.ext.get_attr=function(n,i){var r=this[i||0];return r&&t(r,n)||""}}(),n.ext.set_attr=function(n,t){return this.for_each(function(i){i.setAttribute(n,t)}),this},function(){var r=n.Style.get_rendered_style,i=n.Style.get_opacity,t=n.Style.get_camelized_style_name;n.ext.get_style=function(n,u){var f=this[u||0];return f?n==="opacity"?i(f):r(f,t(n)):""}}(),function(){var i=n.Style.set_opacity,t=n.Style.get_camelized_style_name;n.ext.set_style=function(n){return this.for_each(function(r){var e,u,f;for(e in n){u=n[e],f=t(e);switch(f){case"height":case"maxHeight":case"minHeight":case"width":case"maxWidth":case"minWidth":case"top":case"right":case"bottom":case"left":case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":r.style[f]=typeof u=="number"&&u+"px"||u;break;case"opacity":i(r,u);break;default:r.style[f]=u}}}),this}}(),n.ext.get_native_prop=function(n,t){var i=this[t||0];return i?i[n]:""},n.ext.parent=function(t){var i=this[t||0];return n(i&&i.parentNode)},n.ext.element=function(n){return this[n||0]},n.ext.get_ancestor=function(t,i){var r=this[i||0],u=t;while(u-->0)if(r)r=r.parentNode;else break;return n(r)},n.ext.get_sibling=function(t,i){var f=this[i||0],r=f;if(t!==0){var o=t>0?"nextSibling":"previousSibling",e=Math.abs(t),u=0;while(u<e){r=r[o];if(!r)break;r.nodeType===1&&u++}}return n(r)},n.ext.for_each=function(){function t(n,t){return this.entities().forEach(n,t),this}function n(n,t){for(var r=this.entities(),u=r.length,i=0;i<u;i++)n.call(t,r[i],i,r);return this}return typeof Array.prototype.forEach!="undefined"?t:n}(),n.ext.iterate=function(t){for(var u=this.length,r,i=0;i<u;i++)r=n(this[i]),t.call(r,i);return t=null,this},n.ext.filter=function(t){var r=n(),i=this.length;while(i--)t(this[i])&&r.unshift(this[i]);return r},n.ext.map=function(){function i(t,i){return n(this.entities().map(t,i))}function t(t,i){var u=n(),r=this.length;while(r--)u.unshift(t.call(i,this[r]));return u}return typeof Array.prototype.map!="undefined"?i:t}(),function(){var t=n.Helper;n.ext.contains=function(n){return t.contains(this.entities(),n)}}(),function(){var t=n.Helper;n.ext.index_of=function(n){return t.index_of(this.entities(),n)}}(),n.ext.select=function(t){return n(t,this[0])},n.ext.has=function(t,i){var r=this[i||0];return n(t,r).length>0},function(){var t=n.Helper;n.ext.unique=function(){return n(t.unique(this.entities()))}}(),function(){var t=n.Style.get_rendered_style;n.ext.get_style_pos=function(n){var i=this[n||0];return{x:parseFloat(t(i,"left")),y:parseFloat(t(i,"top"))}}}(),function(){var t=n.Style.get_absolute_pos;n.ext.get_absolute_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){var t=n.Style.get_relative_pos;n.ext.get_relative_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){n.ext.get_scroll_pos=function(t){var r=this[t||0],i={x:0,y:0};return r===window?typeof window.pageYOffset!="undefined"?(i.x=window.pageXOffset,i.y=window.pageYOffset):n.Browser.is_in_quirks_mode||typeof document.documentElement.scrollTop=="undefined"?typeof document.body.scrollTop!="undefined"&&(i.x=document.body.scrollLeft,i.y=document.body.scrollTop):(i.x=document.documentElement.scrollLeft,i.y=document.documentElement.scrollTop):(i.x=r.scrollLeft,i.y=r.scrollTop),i}}(),n.ext.animate=function(t,i,r,u,f){function l(n,t,i){switch(n){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i;default:return i}}function c(t,i){var u=n(t).get_style(i)+"",r=parseFloat(u);return e.units[i]=u.replace(r,""),r}function a(n,i){var e=c(n,i),r=t[i]+"",u=r.match(/^[+\-*\/]/),f=u&&u[0]||"noOp";return r=Number(r.replace(f,"")),l(f,e,r)}var e={units:{},ops:{}},s={},o,h;for(o in t)e[o]=c,s[o]=a;return h=n.Effects.Storyboard.create(this,e,s,function(t,i){var f=n(t),r,u;for(r in i){if(r==="units")continue;u={},u[r]=i[r]+e.units[r],f.set_style(u)}},i,r,u,f),h.begin(),this},n.ext.bounce=function(t,i,r,u,f){function o(t){return n(t).get_style_pos().y}t===null&&(t=o);var e=n.Effects.Storyboard.create(this,{top:t},{top:i},function(n,t){n.style.top=Math.ceil(t.top)+"px"},r,u,f,n.Effects.Easing.Bounce.ease_out);return e.begin(),this},function(){function t(t,i,r,u,f){this.set_style({zoom:1}),t===null&&(t=function(t,i){return Number(n(t).get_style(i))});var o=n.Effects.Storyboard.create(this,{opacity:t},{opacity:i},function(t,i){n(t).set_style({opacity:i.opacity})},r,u,f,null);return o.begin(),this}n.ext.fade_to=t,n.ext.fade_in=function(n,i,r,u){return t.call(this,0,1,n,i,r,u)},n.ext.fade_out=function(n,i,r,u){return t.call(this,1,0,n,i,r,u)}}(),n.ext.slide=function(t,i,r,u,f,e){function s(t,i){i=i==="left"?"x":"y";var r=t.__pos;return r||(r=t.__pos=n(t).get_style_pos()),i==="y"&&(t.__pos=n.undefined),r[i]}t===null&&(t={x:s,y:s});var o=Math.round,c=n.Effects.Easing.Exponential.ease_in_out,h=n.Effects.Storyboard.create(this,{left:t.x,top:t.y},{left:i.x,top:i.y},function(n,t){n.style.top=o(t.top)+"px",n.style.left=o(t.left)+"px"},r,u,f,e||function(n){return c(n,4)});return h.begin(),this},n.ext.scroll_to=function(t,i,r,u){var o=n.Screen.get_scroll_pos(),e=n(this[0]).get_absolute_pos(),f=Math.round,h=n.Effects.Easing.Exponential.ease_out,s=n.Effects.Storyboard.create([window],{scrollX:o.x,scrollY:o.y},{scrollX:e.x,scrollY:e.y},function(n,t){n.scrollTo(f(t.scrollX),f(t.scrollY))},t,i,r,u||function(n){return h(n,4)});return s.begin(),this},n.ext.veil=function(t,i,r,u,f){function l(t,i){var r=parseInt(n(t).get_style(i),10);return t[c]=t[c]||{},t[c][i]=r}var e=n.Effects.Enums.Directions,c,s,o,h;return t=Math.floor(t)||e[t]||e.vertically,c="_$gimme$_veil",s={},o={},(t&e.vertically)===e.vertically&&(o.height=o.paddingTop=o.paddingBottom=l,s.height=s.paddingTop=s.paddingBottom=0),(t&e.horizontally)===e.horizontally&&(o.width=o.paddingLeft=o.paddingRight=l,s.width=s.paddingLeft=s.paddingRight=0),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i!=="none"}),o,s,function(n,i){var r=n.style;(t&e.vertically)===e.vertically&&(r.height=i.height+"px",r.paddingTop=i.paddingTop+"px",r.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(r.width=i.width+"px",r.paddingRight=i.paddingRight+"px",r.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.display="none"}})),h.begin(),this},n.ext.unveil=function(t,i,r,u,f){function c(t,i){var r=t._$gimme$_veil;return r||(r=r||function(){var i=t.cloneNode(!0),f,u,r;return i.style.cssText="position:absolute;top:0;left:0;visibility:hidden;margin:0;padding:0;border:0;height:;width:;",i.style.display="block",t.parentNode.appendChild(i),i=n(i),f=parseInt(n(t).get_style("height"),10)||parseInt(i.get_style("height"),10),u=parseInt(n(t).get_style("width"),10)||parseInt(i.get_style("width"),10),i[0].style.padding=t.style.padding,r={height:f,width:u,paddingTop:parseInt(i.get_style("paddingTop"),10),paddingBottom:parseInt(i.get_style("paddingBottom"),10),paddingRight:parseInt(i.get_style("paddingRight"),10),paddingLeft:parseInt(i.get_style("paddingLeft"),10)},t.parentNode.removeChild(i[0]),t.style.overflow="hidden",r}()),r[i]}var e=n.Effects.Enums.Directions,s,o,h;return t=Math.floor(t)||e[t]||e.vertically,e=n.Effects.Enums.Directions,t=Math.floor(t)||e[t]||e.vertically,s={},o={},(t&e.vertically)===e.vertically&&(o.height=o.paddingTop=o.paddingBottom=0,s.height=s.paddingTop=s.paddingBottom=c),(t&e.horizontally)===e.horizontally&&(o.width=o.paddingLeft=o.paddingRight=0,s.width=s.paddingLeft=s.paddingRight=c),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i==="none"||i===null}),o,s,function(n,i){(t&e.vertically)===e.vertically&&(n.style.height=i.height+"px",n.style.paddingTop=i.paddingTop+"px",n.style.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(n.style.width=i.width+"px",n.style.paddingRight=i.paddingRight+"px",n.style.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden",n.style.display="block"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.overflow=""}})),h.begin(),this},n.toString=function(){return"Gimme v2.7.0 (Edmund) :: Friday, September 14, 2012 3:02:22 PM"},n.Internals.parseJSON=function(n){var t=n.length-2;return n.substring(t)===".d"?(n=n.substring(0,t),jsonObj=JSON.parse(n).d):jsonObj=JSON.parse(n),jsonObj},n}(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},function(){window.Microsoft.Maps.Globals={disableTasks:!1,disableVenueMaps:!1,disableDirections:!1,disableSearch:!1,disableAnalytics:!1,zoomOriginWidth:256,minMercatorZoom:1,maxMercatorZoom:20,jsonTimeStamp:new Date(1).valueOf()}}(),window.Microsoft.Maps.initMapCode=function(){function i(n,t){this.x=n,this.y=t}function y(n,t,i,r){this.latitude=parseFloat(n),this.longitude=parseFloat(t),dt.isValid(r)&&(this.altitude=parseFloat(i),this.altitudeReference=r)}function ht(n,t,i){this.center=n,this.width=t,this.height=i}function su(t){function i(){var i=e.getWidth(),t=e.getHeight();(i!==f||t!==o)&&(f=i,o=t,n.invoke(e,"resize",{width:i,height:t}))}var e=this,l=t.onresize!==h,r,f,o,c=p(t),s=p(window);this.getWidth=function(){return t.offsetWidth},this.getHeight=function(){return t.offsetHeight},this.startMonitoring=function(){l?(c.add_event("resize",i),u.useOnResize&&(t.onresize=i)):(r||(r=window.setInterval(i,1e3)),s.add_event("resize",i))},this.stopMonitoring=function(){c.remove_event("resize",i),u.useOnResize&&t.onresize===i&&(t.onresize=null),r&&(window.clearInterval(r),_timeoutId=null),s.remove_event("resize",i)},this.poll=function(){f=null,o=null,i()}}function tr(r,f){function hr(){function w(){var i=e.getImageryId(),n="dark",t=p("~.InfoboxExtension",s);switch(i){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":y.add_class(n),t.add_class(n);break;default:y.remove_class(n),t.remove_class(n)}}var o,l,nt,i,r,h;f=f||{},s=k(),s.className="MicrosoftMap",u.allowFocus&&(a=k("button","position:fixed;width:1px;height:1px;left:0;top:0;padding:0;font-size:0;line-height:0;border:0;background:transparent;",s),a.tabIndex=-1,u.useXHR&&p(a).set_style({display:"none"})),ft=ur(),ii=ur(),dt.appendChild(s);if(t.versionNotSupported===!0){i=k("div","position:absolute; width:100%; top:50%; text-align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=yr.getString("L_VersionNotSupportedMessage_Text"),i.appendChild(r),e.getRootElement().appendChild(i);return}if(t.killSwitchEngaged===!0){i=k("img","position:absolute; height:100%; margin:auto"),i.src=t.killSwitchImageUrl,e.getRootElement().appendChild(i);return}st=p(document),bt=p(ft),y=p(s),f.theme&&(ut=f.theme,ut._attachToMap&&ut._attachToMap(e,f)),f.showHotRegions===!0&&(t.onDemandRoadUriFormat&&(t.roadUriFormat=t.onDemandRoadUriFormat),t.onDemandAerialWithLabelsUriFormat&&(t.aerialWithLabelsUriFormat=t.onDemandAerialWithLabelsUriFormat)),n.invoke(tr,"mapcreationstart",{map:e,options:f}),di=f.credentials,c.authenticate(f.credentials),typeof et!="undefined"&&et.authenticate(e.getCredentials),g=new su(s),n.addHandler(g,"resize",sr),ui(f.width,f.height),(t.ddCoreStylesDownloaded||ut)&&!u.useXHR||(fi.downloadStyles(t.cssPath+"mapcontrol.css"),t.ddCoreStylesDownloaded=!0),o=ru(f),o.mapTypeId=o.mapTypeId||pt.auto||pt.road,o.animate=!1,e.setView(o),oi&&e.focus(),y.add_event("mousedown",e.focus).add_event("touchstart",e.focus),b.dispatch(function(){if(c){var n={showDashboard:f.showDashboard,showMapTypeSelector:f.showMapTypeSelector,showDualMapTypeSelector:f.showDualMapTypeSelector,disableBirdseye:f.disableBirdseye,showBreadcrumb:f.showBreadcrumb,showScalebar:f.showScalebar,scalebarPosition:f.scalebarPosition||"bottomRight",showLogo:f.showLogo,logoPosition:f.logoPosition||"bottomLeft",clickable:f.enableClickableLogo,enableSearch:f.enableSearchLogo,showCopyright:f.showCopyright,copyrightPosition:f.copyrightPosition||"bottomRight",copyrightStacked:f.copyrightStacked||!1};c.showOverlays(n)}}),f.showHotRegions===!0&&(b.dispatch(function(){c&&c.showHotRegions(f.disableLabels)}),f.showVenueMapsExplorer===!0&&b.dispatch(function(){c&&c.showVenueMapsExplorer()})),t.disableAnalytics||f.disableAnalytics||(l=new pu(e),e.addComponent("analyticsProxy",l),!t.frontdoorLogUrl&&t.biciLoggingService&&e.getCredentials(function(n){l.enable({sessionKey:n})})),f.fixedMapPosition===!0&&(nr=!1),nt=n.addHandler(e,"imagerychanged",w),w(),u.useXHR&&t.message&&(i=k("div","position:absolute; width:100%; top:50%; text-Align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=t.message,i.appendChild(r),e.getRootElement().appendChild(i)),t.updateAvailable===!0;if(t&&t.allowOrdnanceSurvey&&t.logOSServiceUriFormat){function v(){e.getCredentials(function(n){fi.getObjectAsyncWithNoJsonso(t.logOSServiceUriFormat.replace(/{credentials}/,n),function(){})})}if(e.getImageryId()==="OrdnanceSurvey")b.dispatch(v);else{function d(){e.getImageryId()==="OrdnanceSurvey"&&(h&&(n.removeHandler(h),h=null),b.dispatch(v))}h=n.addHandler(e,"imagerychanged",d)}}}function or(t){var i=d.length;while(i--)d[i][1]=n.addHandler(t,d[i][0],function(){var t=d[i][0];return function(i){n.invoke(e,t,i)}}());p(s).add_event("mouseenter",function(t){n.invoke(e,"mouseover",new ai(e,ri.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),p(s).add_event("mouseleave",function(t){n.invoke(e,"mouseout",new ai(e,ri.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function rr(){var i,t=d.length;while(t--)i=d[t][1],i&&n.removeHandler(i),d[t][1]=null;p(s).remove_event("mouseenter",function(t){n.invoke(e,"mouseover",new ai(e,ri.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),p(s).remove_event("mouseleave",function(t){n.invoke(e,"mouseout",new ai(e,ri.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function ur(){return k("div","z-index:0;position:absolute;left:50%;top:50%;"+u.safariRenderHack,s)}function ui(n,t){n>0&&t>0?(g.stopMonitoring(),ni=!1,s.style.cssText=er.replace("{width}",n).replace("{height}",t),ei(n,t)):(s.style.cssText=fr,ni=!0,g.startMonitoring(),g.poll())}function ei(t,i){t=Math.round(Math.max(1,t)),i=Math.round(Math.max(1,i)),(t!==gt||i!==kt)&&(gt=t,kt=i,cr(t,i),n.invoke(e,"resize"))}function cr(n,t){setTimeout(function(){var i=p(s);t<100||n<240?i.add_class("miniscule"):(n>=240&&n<320?i.remove_class("medium large").add_class("verySmall"):n>=320&&n<600?i.remove_class("verySmall large").add_class("medium"):i.remove_class("verySmall medium").add_class("large"),i.remove_class("miniscule"))},1)}function sr(n){ni&&ei(n.width,n.height)}function w(){var t,n;ti&&(t=y.get_absolute_pos(),vt=t.x,lt=t.y,n=bt.get_absolute_pos(),tt=n.x,nt=n.y,ti=!1,nr&&b.dispatch(hi))}function hi(){ti=!0}function vi(n){for(var t in v)if(v.hasOwnProperty(t)&&v[t].getMode()===n)return v[t];return null}function lr(t){if(o!=t){var i=o,f=vi(i),u=vi(t),r="MapTypeId_";t.activating&&t.activating(e,{credentials:di}),i&&i.deactivating&&i.deactivating(),rr(),o=t,it=null,f&&y.remove_class(r+f.getMapTypeId()),i&&i.deactivated&&i.deactivated(),u&&y.add_class(r+u.getMapTypeId()),or(t),t.activated&&t.activated(),n.invoke(e,"modechanged"),n.invoke(e,"imagerychanged"),n.invoke(e,"copyrightchanged")}}function yt(n){var t,i;if(wi!==e)return!1;t=n.target;if(t){i=t.tagName;if(i==="INPUT"&&(t.type==="text"||t.type==="search")||i==="TEXTAREA"||i==="SELECT")return!1}return!0}function wt(t,i){if(n.hasHandler(e,t)){var r=new pr(t,i.keyCode,i.altKey,i.ctrlKey,i.shiftKey);r.originalEvent=i,n.invoke(e,t,r)}}function li(n){yt(n)&&wt("keydown",n)}function ci(n){yt(n)&&wt("keyup",n)}function yi(n){yt(n)&&wt("keypress",n)}var d;PRF.start("mapobj");var e=this,c=new eu(this),dt=r,s,ni=!0,oi=window.top==window.self,gt,kt,vt,lt,tt,nt,g,ct="z-index:0;overflow:hidden;background-color:";ct+=f&&f.backgroundColor?at.clone(f.backgroundColor).toHex()+";":"#F4F2EE;";var fr=ct+(p.Browser.is_in_quirks_mode?"position:absolute;top:0;left:0;width:100%;height:100%":"position:absolute;left:0;top:0;right:0;bottom:0"),er=ct+"position:relative;width:{width}px;height:{height}px",nr=!0,ti=!0,ft,ii,ot={min:t.minMercatorZoom,max:t.maxMercatorZoom},it=null,a,st,bt,y,o=null,di,v=[],ht=null,ut=null,l={width:null,height:null,disableUserInput:!1,disableKeyboardInput:!1,disableMouseInput:!1,disableTouchInput:!1,disableZooming:!1,disablePanning:!1,labelOverlay:rt.visible,useInertia:!0,inertiaIntensity:-1,tileBuffer:0,showBackground:null},pi=new gi,ki={};this.addComponent=function(t,i){ki[t]=i,n.invoke(e,"componentadded",{componentName:t,component:i})},this.getComponent=function(n){return ki[n]},this.getCredentials=function(n){c?c.getCredentials(n):typeof n=="function"&&n(null)},this.getWidth=function(){return gt},this.getHeight=function(){return kt},this.getPageX=function(){return w(),vt},this.getPageY=function(){return w(),lt},this.getViewportX=function(){return w(),tt},this.getViewportY=function(){return w(),nt},this.getTheme=function(){return ut},this.focus=function(){l.disableUserInput||l.disableKeyboardInput||(a&&(a.offsetWidth>0||a.offsetHeight>0)&&oi?a.focus():window.focus(),wi!==e&&(wi&&wi.blur(),a&&st.add_event("keydown",li).add_event("keypress",yi).add_event("keyup",ci),wi=e,n.invoke(e,"focus")))},this.blur=function(){if(a){try{a.blur()}catch(t){}st.remove_event("keydown",li).remove_event("keypress",yi).remove_event("keyup",ci)}wi===e&&(n.invoke(e,"blur"),wi=null)},this.getRootElement=function(){return s},this.getModeLayer=function(){return ft},this.getUserLayer=function(){return ii},this.updateMapPosition=hi,this.dispose=function(){if(e){n.invoke(e,"ondispose",null),c.dispose(),e.blur(),e.entities.clear(),o&&o.deactivating&&o.deactivating(),rr(),o&&o.deactivated&&o.deactivated(),o=null,v.length=0,g.stopMonitoring(),g=null,y.remove_event("mousedown",e.focus).remove_event("touchstart",e.focus),dt.removeChild(s),s=null,dt=null,ft=null,ii=null,st=null,bt=null,y=null,c=null;var t=bi.length;while(t--)bi[t]===e&&bi.splice(t,1);e=null}},this.setView=function(t){var i,u,r;e.setOptions(t),t.mapTypeId&&(i=v[t.mapTypeId],i!==ht&&(this.entities=pi,u=o,r=null,u&&(r=u.getCenter()),i.activating(),ht=i,lr(i.getMode()),i.activated(),n.invoke(e,"maptypechanged"),t.center||t.bounds||!r||u===o||(t.center=r,t.animate==null&&(t.animate=!1)))),o.setView(t)},this.setOptions=function(t){var i,r=!1;for(i in t)l[i]!==h&&t[i]!==h&&l[i]!==t[i]&&(l[i]=t[i],r=!0);r&&(l.width!==h&&l.height!==h&&ui(l.width,l.height),n.invoke(e,"optionschanged"))},this.getOptions=function(){return ru(l)},this.getCenter=function(){return o.getCenter()},this.getZoom=function(){return o.getZoom()},this.getZoomRange=function(){return it||(it={min:Math.max(t.minMercatorZoom,o.getInternalMinZoom(),ot.min),max:Math.min(t.maxMercatorZoom,o.getInternalMaxZoom(),ot.max)}),it},this.restrictZoom=function(n,i){if(n>i)throw"min zoom cannot be greater than max zoom";ot.min=n||t.minMercatorZoom,ot.max=i||t.maxMercatorZoom,it=null},this.getHeading=function(){return o.getHeading()},this.getBounds=function(){return o&&o.getBounds()},this.getMetersPerPixel=function(){return o.getMetersPerPixel()},this.getTargetCenter=function(){return o.getTargetCenter()},this.getTargetZoom=function(){return o.getTargetZoom()},this.getTargetHeading=function(){return o.getTargetHeading()},this.getTargetBounds=function(){return o.getTargetBounds()},this.getTargetMetersPerPixel=function(){return o.getTargetMetersPerPixel()},this.tryLocationToPixel=function(n,t,i){var r,f,u,e,s;if(!o.tryLocationToViewport)return null;r=o.tryLocationToViewport(n,i);if(r&&t){f=0,u=0;switch(t){case si.page:w(),f=tt,u=nt;break;case si.control:w(),f=tt-vt,u=nt-lt}if(f||u)if(ir(r)){s=r.length;while(s--)e=r[s],e&&(e.x+=f,e.y+=u)}else r.x+=f,r.y+=u}return r},this.tryPixelToLocation=function(n,t,r){var s,f,u,e;if(!o.tryViewportToLocation)return null;s=n;if(t){f=0,u=0;switch(t){case si.page:w(),f=tt,u=nt;break;case si.control:w(),f=tt-vt,u=nt-lt}if(f||u)if(ir(n)){e=n.length,s=new Array(e);while(e--)s[e]=new i(n[e].x-f,n[e].y-u)}else s=new i(n.x-f,n.y-u)}return o.tryViewportToLocation(s,r)},this.isDownloadingTiles=function(){return o&&o.isDownloadingTiles?o.isDownloadingTiles():!1},this.getTileDownloadMetrics=function(){return o&&o.getTileDownloadMetrics?o.getTileDownloadMetrics():0},this.getImageryId=function(){return o&&o.getImageryId?o.getImageryId():""},this.isMercator=function(){return o.isMercator?o.isMercator():!1},this.isRotationEnabled=function(){return o.isRotationEnabled()},this.getCopyrights=function(n){return o&&o.getCopyrights&&o.getCopyrights(n),[]},this.getMode=function(){return o.getPublicApi?o.getPublicApi():{}},this.setMapType=function(n){this.setView({mapTypeId:n})},this.getMapTypeId=function(){return ht?ht.getMapTypeId():""},this.registerMapType=function(n){var t=n.getMapTypeId();if(v[t])throw"InvalidOperation: already registered";v.push(n),v[t]=n},this.entities=pi,d=[["viewchangestart",null],["viewchange",null],["viewchangeend",null],["targetviewchanged",null],["imagerychanged",null],["copyrightchanged",null],["tiledownloadcomplete",null],["click",null],["dblclick",null],["rightclick",null],["mousedown",null],["mouseup",null],["mousemove",null],["mousewheel",null]],hr(),bi.push(e),PRF.end("MapObject instantiated","mapobj")}function li(n,t){var r=n,i=t;this.getMapTypeId=function(){return r},this.getMode=function(){return i},this.activating=function(){},this.activated=function(){}}function ai(n,t,i,r,u,f,e,o,s){var h=n;this.pageX=u,this.pageY=f,this.eventName=r,this.targetType=t,this.target=i,this.wheelDelta=e,this.isTouchEvent=o,this.originalEvent=s,this.isPrimary=s.which===1,this.isSecondary=s.which===3,this.getX=function(){return this.pageX-h.getViewportX()},this.getY=function(){return this.pageY-h.getViewportY()}}function pr(n,t,i,r,u){this.eventName=n,this.keyCode=t,this.altKey=i,this.ctrlKey=r,this.shiftKey=u,this.originalEvent={}}function at(n,t,i,r){this.a=n,this.r=t,this.g=i,this.b=r}function gi(t){function s(t){t.collection||(t.collection=r),n.invoke(r,"entitychanged",t)}function h(t){n.invoke(r,"entityadded",t)}function c(t){n.invoke(r,"entityremoved",t)}function e(t,i){var e=u.length;if(!t[f]){t[f]=[];while(e--)t[f].push(n.addHandler(t,u[e][0],u[e][1]))}n.invoke(r,"entityadded",{collection:r,entity:t,index:i})}function o(t){if(t){var i=u.length;while(i--)n.removeHandler(t[f][i]);delete t[f],n.invoke(r,"entityremoved",{collection:r,entity:t})}}var r=this,f="_ech"+yi.getNext(),u=[["entityadded",h],["entityremoved",c],["entitychanged",s]],i;this._eventsHandlers=u,i=[],this.get=function(n){return i[n]},this.getLength=function(){return i.length},this.push=function(n){i.push(n),e(n,i.length)},this.insert=function(n,t){i.splice(t,0,n),e(n,t)},this.pop=function(){var n=i.pop();return o(n),n},this.removeAt=function(n){var t=i[n];return i.splice(n,1),o(t),t},this.remove=function(n){var r=null,t=i.length;while(t--)if(i[t]===n){r=this.removeAt(t);break}return r},this.clear=function(){while(i.length>0)this.pop()},this.indexOf=function(n){var t=i.length;while(t--)if(i[t]===n)break;return t},this.setOptions(t)}function ou(n,t){this._location=n,this.setOptions(t,!1)}function g(n,t){g.baseConstructor.call(this,n,t),this.setOptions(t)}function er(n,i){this._location=n,i&&typeof i.useTransform3d=="boolean"&&(this._useTransform3d=i.useTransform3d),this._icon=t.pushpinImageUrl,this.setOptions(i)}function nr(n,t){this._locations=n,this.setOptions(t)}function di(n,t){this._locations=n,this.setOptions(t)}function sr(t){var u=this,a=!0,c=0,s=1,e={},l=ar.auto,f=!0,i=1e4,o,r;this.setOptions=function(t){if(t){var r=!1;typeof t.visible=="boolean"&&(a=t.visible,r=!0),typeof t.reproject=="boolean"&&(f=t.reproject,r=!0),vi(t.zIndex)&&(c=t.zIndex,r=!0),vi(t.opacity)&&(s=t.opacity,r=!0),t.animationDisplay&&(l=t.animationDisplay,r=!0),t.downloadTimeout!==h&&(i=t.downloadTimeout,typeof i=="number"&&i>0||(i=1e4),r=!0),r&&n.invoke(u,"entitychanged",{entity:u})}},o=typeof ut!="undefined"?ut:{mercator:{}};for(r in o)t[r]instanceof kr&&(e[r]=t[r]);this.getVisible=function(){return a},this.getZIndex=function(){return c},this.getOpacity=function(){return s},this.getAnimation=function(){return l},this.getReproject=function(){return f},this.getDownloadTimeout=function(){return i},this.getTileSource=function(n){return e[n]},this.setOptions(t)}function kr(n){var f=t.defaultTileSize,u=t.defaultTileSize,i,r;isFinite(n.width)&&(f=n.width),isFinite(n.height)&&(u=n.height),typeof n.uriConstructor=="string"?(i=n.uriConstructor,r=n.uriConstructor):(typeof n.uriConstructor=="function"&&(i=n.uriConstructor),typeof n.uriFormat=="string"&&(r=n.uriFormat)),this.getWidth=function(){return f},this.getHeight=function(){return u},this.getUriConstructor=function(){return i},this.getUriFormat=function(){return r}}function eu(n){this._map=n,this.dispose=function(){this._map=null}}function pu(t){function c(){f=n.addHandler(r,"ondispose",e),tt.load(h,{callback:function(){s.Analytics&&s.Analytics.AnalyticsManager&&r&&(o=!0,u=new s.Analytics.AnalyticsManager(r))}})}function i(n,t){u?u[n].apply(u,t):!o&&r&&tt.add(h,l,n,t)}function e(){i("dispose",arguments),u=r=null,n.removeHandler(f),f=null}var l=this,h="Microsoft.Maps.Analytics",r=t,f=null,u=null,o=!1;this.logClientAction=function(){i("logClientAction",arguments)},this.addPreProcessor=function(){i("addPreProcessor",arguments)},this.removePreProcessor=function(){i("removePreProcessor",arguments)},this.registerAction=function(){i("registerAction",arguments)},this.registerChildActions=function(){i("registerChildActions",arguments)},this.enable=function(){i("enable",arguments)},this.dispose=e,c()}function r(n,t,i){this.x=n,this.y=t,this.z=i}function ct(n,t){this.width=n,this.height=t}function vt(n,t,i,r){this.x=n,this.y=t,this.width=i,this.height=r}function yt(n,t,i,r,u,f){this.m11=n,this.m12=t,this.m21=i,this.m22=r,this.offsetX=u,this.offsetY=f}function e(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.m11=n,this.m12=t,this.m13=i,this.m14=r,this.m21=u,this.m22=f,this.m23=e,this.m24=o,this.m31=s,this.m32=h,this.m33=c,this.m34=l,this.offsetX=a,this.offsetY=v,this.offsetZ=y,this.m44=p}function ui(n,t,i,r){this.a=n,this.b=t,this.c=i,this.d=r}function ni(n,t){this.x=n,this.y=t}function it(n,t,i){this.levelOfDetail=n,this.x=t,this.y=i}function f(n,u,o,s,c,l,v,y,p,w){function k(){var c,o,w,v;if(!gt){ut=s===0&&et===-90&&l===0,ft=ut||st<=bt,lt=ft&&ut?f.simpleGround:ui.fromNormal(nt,rt.getUpVector(nt));var n=f.simpleWorldToFrustumNoZ,u=1/g,i=g*1e3;tt=rt.getNadirMatrix(nt),ut||(tt=e.multiply(tt,e.rotationZ(-vt),e.rotationX(-(et+90)),e.rotationZ(-ct)));if(ft)ut?(n.m22=n.m11=u,n.m33=u*-.001,n.offsetX=tt.offsetX*u,n.offsetY=tt.offsetY*u):n=e.multiply(tt,e.scaling(u,u,1/i));else{var y=Math.pow(2,kt)*g,h=1/st,p=h/y;i=Math.min(h*.99,i),c=h-i,o=h+i,n=e.multiply(tt,e.translation(wt),e.translation(0,0,h),new e(p,0,0,0,0,p,0,0,0,0,o/(o-c),1,0,0,c*o/(c-o),0),e.scaling(y/g,y/g,1)),w=n.transform(nt),n.multiplyBy(e.translation(r.multiply(w,-1)))}ut?ot=n.clone():(ht=n.invert().projectOnPlane(lt),ot=ht.invert()),ut?(d=ot.clone(),d.m11*=b,d.m22*=b,d.m33*=b,d.offsetX*=b,d.offsetY*=b,v=g/b,it=tt.clone(),it.m11*=v,it.m22*=v,it.m33*=i/b,it.offsetX*=-1,it.offsetY*=-1):(d=e.multiply(ot,e.scaling(b)),it=d.invert()),dt=rt.toLocation(nt),pt=f.widthToMercatorZoom(g,rt,nt),at=rt.unitsToMeters(nt,g)/t.zoomOriginWidth,yt=!ft||Math.abs(et+90)>bt||rt!==a,gt=!0}}var ni=this;var rt=n,nt=u,g=o,vt=s||0,et=c===h?-90:c,ct=l||0,st=v||0,kt=y||0,wt=p||new r(0,0,0),ut,ft,lt,tt,ot,ht,d,it,dt,pt,at,yt,b=w||t.zoomOriginWidth,gt=!1;this.getCrs=function(){return rt},this.getLookAt=function(){return nt},this.getWidth=function(){return g},this.getHeading=function(){return vt},this.getPitch=function(){return et},this.getRoll=function(){return ct},this.getDistanceInverse=function(){return st},this.getZoomDelta=function(){return kt},this.getPerspectiveOrigin=function(){return wt},this.getZoomOriginWidth=function(){return b},this.getGroundPlane=function(){return k(),this.getGroundPlane=function(){return lt},lt},this.getWorldToViewport=function(){return k(),this.getWorldToViewport=function(){return d},d},this.getViewportToWorld=function(){return k(),this.getViewportToWorld=function(){return it},it},this.getWorldToFrustum=function(){return k(),this.getWorldToFrustum=function(){return ot},ot},this.getFrustumToWorld=function(){return k(),this.getFrustumToWorld=function(){return ht},ht},this.getCenter=function(){return k(),this.getCenter=function(){return dt},dt},this.getMercatorZoom=function(){return k(),this.getMercatorZoom=function(){return pt},pt},this.getMetersPerPixel=function(){return k(),this.getMetersPerPixel=function(){return at},at},this.getNeedsElevation=function(){return k(),this.getNeedsElevation=function(){return yt},yt},this.getAlignedCamera=function(n,t,r,u){var s,h;k();var v=g/Math.pow(2,n),o,l=null,c=0,a=null;return t?(o=t,ft||(a=e.multiply(tt,e.translation(wt)),l=a.transform(o),c=n+kt)):o=nt,s=vt,u&&(s=s+u),c=0,h=new f(rt,o,v,s,et,ct,st,c,l,b),r&&(o=h.getViewportToWorld().transform(new i(-r.x,-r.y)),ft||(l=a.transform(o)),h=new f(rt,o,v,s,et,ct,st,c,l,b)),h}}function ci(n){var u=this,e=n,f=2,i=v+"count",t=[{}],r;t[0][i]=0,this.get=function(n,i){var r,e=t.length,f=!0;while(e--){r=t[e][n];if(r!==h)return i&&!f&&u.insert(n,r),r;f=!1}},this.insert=function(n,o){var v,s,l,c,a;v=!1,s=t[t.length-1];if(s[n]===h)if(s[i]<e)s[i]++;else{s={},s[i]=0,t.push(s);if(t.length>f){l=t.shift();if(r)for(c in l)c!==i&&l.hasOwnProperty(c)&&(a=l[c],a!==u.get(c)&&r(a))}}else v=!0;return s[n]=o,v},this.useDisposer=function(n){r=n}}function wt(n,t,i,r,u){this.nativeCamera=n,this.maxLocalZoom=i,this.minLocalZoom=0,this.tilePyramid=t,this.imageryId=r,this.copyrightProvider=u,this.needsElevation=n.getNeedsElevation()||t&&t.projectingCamera&&t.projectingCamera.getNeedsElevation()}function lt(){function ou(){var n=v.getOptions();return!(n.disablePanning||n.disableMouseInput||n.disableUserInput)}function su(){n.invoke(s,"copyrightchanged")}function er(n,i){var c;if(i&&f.areEqual(e,n))return;ii&&(n=et.adjustCameraElevation(n)),e=n,ut=n,c=!1,pi<1/t.maxFPS&&(i=!1);if(i){ut=f.snapSmallDifferences(et.adjustCameraElevation(l),e),f.areEqual(ut,e)&&(i=!1);if(i){var r=new ct(o.width*1.2,o.height*1.2),h=vt.union(nt.getMercatorFootprint(ut,r)),u=vt.union(nt.getMercatorFootprint(e,r));vt.intersect(h,u)||(i=!1)}}i?(ft=new Date(new Date-(s.usingCssAnimation()?0:vu)),it(),i!=!0&&(ni=i)):(ft=new Date(0),g=null,si())}function ui(t,i,u,o,h,c,l){var y,k,b,ft=v.getZoomRange(),tt=i,w=f.widthToMercatorZoom(o,t,i),ot,a,nt,ht,g,p,ut,rt;w=Math.max(w,ft.min),w=Math.min(w,ft.max),ot=2,ii=!1;while(ot--){k=t.toLocation(tt),a=null,nt=st.length;while(nt--){a=st[nt].getScene(d,k.latitude,k.longitude,w,h,gi),a&&a.needsElevation&&(ht=et.isElevationAvailableAtLatLon(k.latitude,k.longitude,w),ii=!0,ht||(a=null));if(a)break}a=a||dr,a=oi?d:a;if(b&&y===a)break;y=a,g=y.nativeCamera,p=w-f.widthToMercatorZoom(g.getWidth(),g.getCrs(),g.getLookAt()),kr&&(p=l?Math.floor(p):Math.round(p)),p=Math.min(p,y.maxLocalZoom),p=Math.max(p,y.minLocalZoom),b=y.nativeCamera.getAlignedCamera(p,i,u);if(r.areAlmostEqual(tt,b.getLookAt()))break;tt=b.getLookAt()}ki(ii);if(c&&f.areEqual(e,b)&&y===d)return;ut=y.imageryId!==d.imageryId,rt=y!==d,d=y,er(b,c),it(),rt&&(n.invoke(s,"scenechanged"),su()),ut&&n.invoke(s,"imagerychanged")}function yt(){var n=et.adjustCameraElevation(e);ui(n.getCrs(),n.getLookAt(),null,n.getWidth(),kt!=null?kt:n.getHeading(),!0)}function si(){var nt,h,t,p;b.cancelDispatch(si);if(!li||fi)return;fi=!0;var c=!1,y=!0,v=!0,i,a;ot.processPendingUserInput(),ct.areEqual(nu,o)||(i=!0,a=!0),nu=o,rr&&(i=!0,a=!0,v=!1,rr=!1),ft&&(nt=l,h=sr(),e.getMercatorZoom()>ut.getMercatorZoom()?h<pu&&(y=!1):h<au&&(y=!1),h>1?(t=e.getLookAt(),pt&&(t=e.getCrs().wrap(t)),t.y<0?t.y=0:t.y>1&&(t.y=1),r.areAlmostEqual(e.getLookAt(),t)||(v=!1,e=e.getAlignedCamera(0,t)),l=e,ut=e,ft=null):(l=yr(h),c=!0),f.areAligned(nt,e)||(v=!1),i=!0),w.allowTileGridSwitch=y;var tt=!fr&&i,u=fr&&!i,k=new Date;u&&k-eu<=fu&&(u=!1,c=!0),fr=i||c,i&&(eu=k,c=!0),f.areEqual(br,e)||(a=!0),(a||u)&&((u||!w.canCssAnimate())&&(g=null),!s.usingCssAnimation()&&ei&&(ur(),ei=!1),w.enableOrDisableCssAnimation(g,u),at.enableOrDisableCssAnimation(g)),br=e,w.render(o,l,d.tilePyramid,e),p=tt?0:u?2:1,at.update(o,l,e,v,p),a&&n.invoke(s,"targetviewchanged"),tt&&n.invoke(s,"viewchangestart"),i&&n.invoke(s,"viewchange",{linear:v}),u&&(n.invoke(s,"viewchangeend"),su()),fi=!1,c&&it()}function sr(){var n=0,t;return s.usingCssAnimation()?n=g.getStartTime()<ft?0:g.getElapsedTimeAsPercentage():(t=new Date,n=ni>0?Math.min(1,(t-ft)/ni):(t-ft)/1e3/pi),n}function yr(n){var i=l,t=0;return s.usingCssAnimation()?t=g.getProgress(n):ni>0?(n<1||(ni=0),t=1-Math.pow(1-n,4)):t=n<=.5?Math.pow(n*2,2)*.5:Math.pow((1-n)*2,2)*-.5+1,t<0||t>1||(i=f.lerp(ut,e,t)),i}function pr(){if(v){var t=v.getWidth(),n=v.getHeight();(o.width!==t||o.height!==n)&&(o=new ct(v.getWidth(),v.getHeight()),it())}}function it(){b.dispatch(si)}function vr(n){n&&w.suspendGettingNewTiles(),oi=!0}function ur(){w.allowGettingNewTiles(),oi&&(oi=!1,yt(),it())}function cr(n){var u=n.getViewportToWorld(),r=n.getCrs(),t=ar(r.toLocation(u.transform(new i(-o.width/2,-o.height/2))),r.toLocation(u.transform(new i(o.width/2,-o.height/2))),r.toLocation(u.transform(new i(o.width/2,o.height/2))),r.toLocation(u.transform(new i(-o.width/2,o.height/2))));return t.center=new y(t.center.latitude,t.center.longitude),t}function ar(){var o=arguments,r,u,t,i,s,e,n,f=o.length;while(f--)n=o[f],isFinite(n.latitude)&&isFinite(n.longitude)&&(r=r===h?n.latitude:Math.max(r,n.latitude),u=u===h?n.latitude:Math.min(u,n.latitude),i=i===h?n.longitude:Math.max(i,n.longitude),t=t===h?n.longitude:Math.min(t,n.longitude),isFinite(n.altitude)&&dt.isValid(n.altitudeReference)&&(e=n.altitude,s=n.altitudeReference));return ht.fromEdges(r,t,u,i,e,s)}function yu(n){return f.areEqual(n.nativeCamera,wt.nativeMercatorCamera)}function lr(){var t,n;tt=v.getOptions(),ot.enableOrDisableUserInput(!0,tt),t=.9,tt.inertiaIntensity!==h&&tt.inertiaIntensity!==-1&&(t=tt.inertiaIntensity),ot.enableOrDisableInertialScrolling(tt.useInertia,t),n=tt.labelOverlay,n!==gi&&rt.isValid(n)&&(gi=n,yt()),tt.showBackground!==h&&w.showBackground(tt.showBackground),w.setBufferSize(tt.tileBuffer)}function ki(t){t?ti||(ti=n.addThrottledHandler(s,"targetviewchanged",wr,500),b.dispatch(wr)):(hr(),n.removeHandler(ti),ti=null)}function wr(){ti&&(hr(),ci=et.downloadElevationData(e,o),ci&&(wi=n.addHandler(ci,"downloaded",cu)))}function hr(){n.removeHandler(wi),wi=null,et.cancelDownload(ci)}function cu(n){rr=!n.cacheHit,yt(),it()}var s=this,li=!1,lu="cm"+yi.getNext(),v=null,lt=null,nr=null,di=null,ot=null,dr=wt.createMercatorScene(null,"Mercator",null),d=dr,l=d.nativeCamera,e=l,ut,kt,oi,ei,wu=k(null,u.safariRenderHack),st=[],hi=[],gi=rt.visible,ft,ni=0,tr=!1,g=null,o=new ct(800,600),nu,w=new iu,fi;n.addHandler(w,"tiledownloadcomplete",function(){n.invoke(s,"tiledownloadcomplete")});var tu,at=new or,ru=!1,gr=!1,fr=!1,br,rr=!1,bi,tt,pt=!0,kr=!0,ti,ci,wi,ii,ri,ai={Grab:"url("+t.cursorPath+"grab.cur)"+u.cursorHotspot+", move",Grabbing:"url("+t.cursorPath+"grabbing.cur)"+u.cursorHotspot+", move",SEResize:"se-resize"},vu=1e3/30,pi=.3,au=.1,pu=.4,eu=new Date(0),fu=200;this.activating=function(t){v=t,bi=n.addHandler(t,"resize",pr),pr()},this.activated=function(){lt=v.getModeLayer(),nr=v.getRootElement(),di=p(nr),lt.appendChild(w.getRootElement()),tu=k("div","position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack,lt),at.activate(v,s,w,tu,lu+"_er"),ot=new uu(s,v,new hu(s,v),di,at,!0),lr(),n.removeHandler(ri),ri=n.addHandler(v,"optionschanged",lr),ki(d.needsElevation),li=!0,it()},this.deactivating=function(){n.removeHandler(ri),ri=null,ki(!1),n.removeHandler(bi),bi=null,ot.enableOrDisableUserInput(!1,tt),er(e,!1),at.deactivate(),lt.removeChild(w.getRootElement()),w.disposeTiles(),ot=null,di=null,nr=null,lt=null,v=null,li=!1},this.getInternalMaxZoom=function(){return t.maxMercatorZoom},this.getInternalMinZoom=function(){return t.minMercatorZoom},this.setView=function(n){var p=e.getCrs(),w,t,tt=null,i=n.bounds,rt=!1,it;if(i instanceof ht){if(n.center){t=n.center;var r=i.getNorthwest(),ut=new y(t.latitude*2-r.latitude,t.longitude*2-r.longitude,r.altitude,r.altitudeReference),v=i.getSoutheast(),ft=new y(t.latitude*2-v.latitude,t.longitude*2-v.longitude,v.altitude,v.altitudeReference);i=ar(r,v,ut,ft)}else t=p===a?nt.getMercatorCenter(i):i.center.clone();it=vi(n.padding)?new ct(Math.max(1,o.width-n.padding),Math.max(1,o.height-n.padding)):o,w=nt.locationRectToMercatorZoom(it,i),rt=!0}else n.center&&(t=n.center,tt=n.centerOffset),vi(n.zoom)&&(w=n.zoom);var l=!1,k=e.getLookAt(),g=e.getWidth(),b=e.getHeading(),d=!0;t&&(k=p.fromLocation(et.toEllipsoid(t)),l=!0),vi(w)&&(g=f.mercatorZoomToWidth(w,p,k),l=!0),vi(n.heading)?(b=c.normalizeDegrees(n.heading),kt=b,l=!0):kt=null,n.animate===!1&&(d=n.animate,l=!0),n.suspend!==h&&(n.suspend?vr(!0):ur()),n.useCssAnimations!==h&&(tr=u.allowCssAnimations&&n.useCssAnimations),l&&(d&&s.requestCssAnimation(),ui(p,k,tt,g,b,d,rt))},this.setWrapping=function(n){pt=n},this.getCenter=function(){var n=l.getCenter();return new y(n.latitude,n.longitude)},this.getZoom=function(){return l.getMercatorZoom()},this.getHeading=function(){return l.getHeading()},this.getBounds=function(){return cr(l)},this.getMetersPerPixel=function(){return l.getMetersPerPixel()},this.getTargetCenter=function(){var n=e.getCenter();return new y(n.latitude,n.longitude)},this.getTargetZoom=function(){return e.getMercatorZoom()},this.getTargetHeading=function(){return e.getHeading()},this.getTargetBounds=function(){return cr(e)},this.getTargetMetersPerPixel=function(){return e.getMetersPerPixel()},this.tryLocationToViewport=function(n,t){return this.internalTryLocationToViewport(l,n,t&&t.referenceLocation)},this.tryViewportToLocation=function(n,t){return this.internalTryViewportToLocation(l,n,!0,!t||t.normalizeLongitude!==!1)},this.internalTryLocationToViewport=function(n,t,i){var u,f,o=n.getCrs(),e=n.getWorldToViewport(),v=n.getDistanceInverse()<bt,a=!n.getNeedsElevation(),s=n.getLookAt();if(t.latitude!==h)return u=o.fromLocation(et.toEllipsoid(t,a)),pt&&(u=o.wrap(u,s)),f=e.transform(u),v||f.z>=-1&&f.z<=1?f:null;var c=t.length,p=new Array(c),y=null;if(!n.getPerspectiveOrigin().isZero()){var b=n.getViewportToWorld(),k=new r(0,n.getZoomOriginWidth()*6,0),l=b.transform(k),w=l.x*e.m14+l.y*e.m24+l.z*e.m34+e.m44;y=w}i&&(u=o.fromLocation(et.toEllipsoid(i,a)),pt&&(s=i=o.wrap(u,s)));while(c--)u=o.fromLocation(et.toEllipsoid(t[c],a)),pt&&(u=o.wrap(u,s)),s=i||u,f=e.transform(u,y),p[c]=v||f.z>=-1&&f.z<=1?f.toPoint():null;return p},this.internalTryViewportToLocation=function(n,t,i,u){var s=n.getCrs(),h=n.getViewportToWorld(),e,f,o,c;if(ir(t)){o=t.length,c=new Array(o);while(o--)e=h.transform(t[o]),i&&(e=et.rayToGround(s,e,h.transform(new r(t[o].x,t[o].y,1)))),f=s.toLocation(e),f=new y(f.latitude,u!==!1?y.normalizeLongitude(f.longitude):f.longitude),c[o]=s.toLocation(e);return c}return e=h.transform(t),i&&(e=et.rayToGround(s,e,h.transform(new r(t.x,t.y,1)))),f=s.toLocation(e),f=new y(f.latitude,u!==!1?y.normalizeLongitude(f.longitude):f.longitude)},this.isDownloadingTiles=function(){return w.isDownloadingTiles()},this.getTileDownloadMetrics=function(){return w.getTileDownloadMetrics()},this.getImageryId=function(){return d.imageryId?d.imageryId:""},this.isRotationEnabled=function(){return d.imageryId==="EnhancedBirdseye"||d.imageryId==="NativeBirdseye"},this.isMercator=function(){return yu(d)},this.getCopyrights=function(n){return n&&d.copyrightProvider?d.copyrightProvider.getCopyrights(s.getBounds(),l.getMercatorZoom(),l.getHeading(),n):n&&n([]),[]},this.setSceneContributors=function(t){var i=hi.length;while(i--)n.removeHandler(hi[i]);hi.length=0,i=t.length,st.length=i;while(i--)st[i]=t[i],hi.push(n.addHandler(st[i],"newsceneavailable",yt));st.sort(function(n,t){return n.priority-t.priority}),it(),yt()},fi=!1,this.ensureUpdateDispatched=function(n){n?si():it()},this.getTargetCamera=function(){return e},this.getCurrentCamera=function(){return l},this.getCameraAnimationDuration=function(){return pi},this.setAlignedCamera=function(n,t,i,r,u,f,e){kt=null,ui(n,t,i,r,u,f,e)},this.setCamera=function(n,t){er(n,t)},this.allowSceneChanges=function(){ur()},this.suspendSceneChanges=function(n){vr(n)},this.requestCssAnimation=function(n){return tr&&(ei=n,g=n?gt.Flicker:gt.Transformer,g=g.duplicate(),g.isFlick=n),g},this.canUseCssAnimations=function(){return tr},this.usingCssAnimation=function(){return g!=null},this.haltCssAnimation=function(){if(s.usingCssAnimation()){var t=sr(),n=yr(t);ei=!1,ui(n.getCrs(),n.getLookAt(),null,n.getWidth(),n.getHeading(),!1)}},this.getCursors=function(){var n="default";return{Grab:ou()?ai.Grab:n,Grabbing:ou()?ai.Grabbing:n,SEResize:ai.SEResize}},this.getPublicApi=function(){return{tryPixelToMercatorPoint:function(n){return s.getTargetCamera().getViewportToWorld().transform(n)},setViewChangeEndDelay:function(n){var n=parseInt(n);n<0||(fu=n)},canReprojectTileLayers:function(){return u.animateOverlayLayers},enableOrDisableZoomLevelSnap:function(n){kr=n===!0,ot.setTouchZoomThreshold(n===!0?.1:0)},setPartialZoomBias:function(n){w&&w.setPartialZoomBias(Math.min(.5,Math.max(-.5,n)))},setOptions:function(t){var i=!1;t&&(typeof t.shouldClipPolygons=="boolean"&&(gr=t.shouldClipPolygons,i=!0),typeof t.drawShapesInSingleLayer=="boolean"&&(ru=t.drawShapesInSingleLayer,i=!0),i&&n.invoke(v,"modeoptionschanged"))},setDrawShapesInSingleLayer:function(n){this.setOptions({drawShapesInSingleLayer:n})},getDrawShapesInSingleLayer:function(){return ru},getShouldClipPolygons:function(){return gr}}}}function ot(n,t,i,r){function l(n){return((o*n+f)*n+u)*n}function h(n){return((a*n+s)*n+e)*n}function c(n){return(3*o*n+2*f)*n+u}function v(n,t){for(var f,u,i=n,r=0;r<9;r++){f=l(i)-n,u=c(i);if(Math.abs(f)<t||Math.abs(u)<1e-6)break;i=i-f/u}return i}var y=this;this.cssText="cubic-bezier("+n+","+t+","+i+","+r+")";var u=3*n,e=3*t,f=3*(i-n)-u,s=3*(r-t)-e,o=1-u-f,a=1-e-s;this.getProgress=function(n,t){return h(v(n,t))}}function wu(n,t,i,r){this.animationSequence=n,this.node=t,this.isComplete=i,this.nodeHasPendingAnimations=r}function gr(n,t){this.url=n,this.timeout=t}function kt(n,t,i,r,u,f,e,o,s,h,l){var v=c.ceilLog2(Math.max(n,t)),a;this.getWidth=function(){return n},this.getHeight=function(){return t},this.getTileWidth=function(){return i},this.getTileHeight=function(){return r},this.getTileOverlap=function(){return u},this.getTileBorder=function(){return f},this.getOffsetX=function(){return e},this.getOffsetY=function(){return o},this.getMaxLevelOfDetail=function(){return v},this.getUrl=s,this.getReplacementTileId=h,a=l?l:5e3,this.getDownloadTimeout=function(){return a}}function rr(r,o,s){function bi(){if(d&&d.length){var t=d.length;while(t--)n.removeHandler(d[t]),pi.removeDownloadBasket(d[t]);d=null}}function ki(){var yr=Math.round((h.x+y.x)/2),pr=Math.round((h.y+y.y)/2),ct=[],ti=k(),yi,i,vt,e,b,sr,pt,oi,ur,r,f,s,wi,o,or,ai,vi,hr,ki,vr;for(bt=0,gt=0,rt=[],kt=[],wt={},bi(),d=[],pt=0,oi=0,r=h.y;r<=y.y;r++){pt=0,ur=!1;var ar=ot&&ot.y<=r&&ht&&ht.y>=r,dr=r>=yt.y&&r<=at.y,kr=r>=ut.y&&r<=et.y;for(f=h.x;f<=y.x;f++){yi=new it(h.levelOfDetail,f,r),i=null;var br=ot&&ot.x<=f&&ht&&ht.x>=f,nu=f>=yt.x&&f<=at.x,wr=f>=ut.x&&f<=et.x,li=!1,lr=!1;!hi||br&&ar||wr&&kr||(lr=!0),e=c.getUrl(yi,dt),e&&!lr&&(b=pi.getState(e),b!=st.failed||ui?(s=rr,wi=0,f===0&&(s-=nt,s+=tt,wi=-tt),f===fr&&(s-=nt,s+=tt),o=nr,or=0,r===0&&(o-=nt,o+=tt,or=-tt),r===er&&(o-=nt,o+=tt),i=k("img"),vt="width:"+s+"px;height:"+o+"px;border:0px;",ii.requireFlowLayout?(pt&&(vt+="margin-left:"+pt*g+"px;"),oi&&(vt+="margin-top:"+oi*p+"px;")):(ai=(f-h.x)*g+wi,vi=(r-h.y)*p+or,i[v+"leftOffset"]=ai,i[v+"topOffset"]=vi,vt+="position:absolute;",vt+=u.useTransform3d?w.Attributes.transform+":translate3d("+ai+"px,"+vi+"px,0px);":"left:"+ai+"px;top:"+vi+"px"),i.style.cssText=vt,i[v+"tileId"]=yi,i[v+"tileUrl"]=e,i[v+"tileHeight"]=o,i[v+"tileWidth"]=s,i.width=s,i.height=o,i.border=0,ui&&b==st.failed&&(i=di(i),li=i!=!1,i&&(e=i[v+"tileUrl"],b=pi.getState(e))),i&&(b===st.ready||b===st.cacheExpired&&(br&&ar||li)?(hr=wr&&!nu&&kr&&!dr,!hr||hi||li?i.src=e:(i.style.visibility="hidden",kt.push(i))):(i.style.visibility="hidden",rt.push(i)),b!=st.ready&&(sr=new gr(e,ir),sr.priority=(yr-f)*(yr-f)+(pr-r)*(pr-r),ct.push(sr)),ci.push(i))):a.isOverlay||gt++,bt++),i||li?(pt=0,ur=!0,i&&(li?tr(i,ti):ti.appendChild(i))):pt++}ur?(oi=0,ii.requireFlowLayout&&k("br",null,ti)):oi++}if(u.useImageDisposer){ki=lt.length;while(ki--)lt[ki].src=t.spacerImageUrl}lt.length=0,vr=lt,lt=ci,ci=vr,(u.useTransform3d||u.useTransform2d)&&(ri=this.hideWhileAnimating?ii.setExactTransformOrHide(ft,ni,a.opacity):ii.setTransformAndOpacity(ft,ni,a.opacity,{explicitOpacity:!0})),ti.style.cssText=ri,l.parentNode&&l.parentNode.replaceChild(ti,l),l=ti,fi(),si&&ct.length&&(ct.basketId=a,ct.sort(ku),cr+=ct.length,d.push(n.addHandler(ct,"hasnewtiles",gi)),pi.setDownloadBasket(ct,dt)),ei()}function ei(){kt.length&&b.dispatch(wi),n.invoke(a,"tilesrendered")}function wi(){var t,n;b.cancelDispatch(wi);if(a.allowTileRender){t=Math.min(kt.length,lr);while(t--)n=kt.shift(),n.style.visibility="visible",n.src=n[v+"tileUrl"]}ei()}function gi(){var r;if(si){var u=rt.length,f=!0,t=[];while(u--&&f){var e=!0,i=rt[u],o=i[v+"tileUrl"],s=pi.getState(o);switch(s){case st.ready:kt.push(i);break;case st.failed:ii.requireFlowLayout?f=!1:(l.removeChild(i),ar(i,t));break;default:e=!1}e&&rt.splice(u,1)}f?(ei(),t.length&&(r=n.addHandler(t,"hasnewtiles",gi),d.push(r),t.basketId=r,pi.setDownloadBasket(t,dt))):ki()}}function ar(n,t){if(!ui){gt++;return}var i=di(n);i&&(i.style.visibility="hidden",rt.push(i),lt.push(i),t.push(new gr(i[v+"tileUrl"],ir)),tr(i,l))}function di(n){var e=n[v+"tileId"],b=e.toString(),y=wt[b]?wt[b]:1,i=c.getReplacementTileId(n[v+"tileId"]),p=c.getUrl(i,dt),t=!1,r;if(p){r=i.toString();if(wt[r])t=null;else{var f=Math.pow(2,e.levelOfDetail-i.levelOfDetail),w=n[v+"tileWidth"],a=n[v+"tileHeight"],o=w*f,s=a*f,l=(i.x*f-e.x)*w+n[v+"leftOffset"],h=(i.y*f-e.y)*a+n[v+"topOffset"];t=k("img"),t[v+"leftOffset"]=l,t[v+"topOffset"]=h,t[v+"tileHeight"]=s,t[v+"tileWidth"]=o,t[v+"tileId"]=i,t[v+"tileUrl"]=p,t[v+"lod"]=i.levelOfDetail,t.style.cssText="position:absolute;left:"+l+"px;top:"+h+"px;width:"+o+"px;height:"+s+"px;border:0px;"+u.safariRenderHack,t.width=o,t.height=s,t.border=0,wt[r]=0}wt[r]+=y}else gt+=y;return t}function tr(n,t){var i=t.firstChild,u=n[v+"tileId"],r;while(i){r=i[v+"lod"];if(!r||r>=u.levelOfDetail){t.insertBefore(n,i);break}i=i.nextSibling}i||t.appendChild(n)}var a=this,ti,fi;var l=k(),h,y,ut,et,yt,at,ot,ht,hi=!1,oi=0,sr,ni,ri="",cr=0,bt=0,gt=0,ui=!1,si=!0,c=r,g,p,nt,tt,rr,nr,pt,ai,li,ur,fr,er,vi,yi,ft=e.identity(),or,hr,lt=[],ci=[],rt=[],kt=[],wt={},d,lr=3,dt,ir=c.getDownloadTimeout();this.levelOfDetail=o,this.opacity=1,this.isOverlay=!1,this.hideWhileAnimating=!1,this.allowTileRender=!0,g=c.getTileWidth(),p=c.getTileHeight(),nt=c.getTileOverlap(),tt=c.getTileBorder(),rr=g+2*nt,nr=p+2*nt,ti=Math.pow(2,c.getMaxLevelOfDetail()-o),pt=Math.ceil(c.getWidth()/ti),ai=Math.ceil(c.getHeight()/ti),pt=Math.ceil(pt),fr=Math.ceil(pt/g)-1,er=Math.ceil(ai/p)-1,li=e.multiply(c.projectingCamera.getWorldToFrustum(),e.scaling(pt),e.translation(pt/2+c.getOffsetX()/ti,ai/2+c.getOffsetY()/ti,0)),ur=li.invert(),s&&(dt=!0),this.populate=function(n,t,r,u){var s,c,k,b;if(f.areEqual(n,or)&&ct.areEqual(t,hr)&&oi==r)return;or=n,hr=t;var a=e.multiply(n.getViewportToWorld(),li),v=Math.ceil(t.width/2),w=Math.ceil(t.height/2),l=vt.union(a.transform(new i(-v,-w)),a.transform(new i(v,-w)),a.transform(new i(v,w)),a.transform(new i(-v,w)));s=new it(o,Math.floor(l.x/g),Math.floor(l.y/p)),c=new it(o,Math.floor(l.getRight()/g),Math.floor(l.getBottom()/p)),(!yt||!at||r>oi||yt.x>s.x||yt.y>s.y||at.x<c.x||at.y<c.y)&&(vi=null,hi=u,oi=r,yt=s,at=c,ot=ut,ht=et,ut=s.clone(),ut.x-=r,ut.y-=r,et=c.clone(),et.x+=r,et.y+=r,h=ut.clone(),y=et.clone(),u&&(h.x=Math.min(ot.x,h.x),h.y=Math.min(ot.y,h.y),y.x=Math.max(ht.x,y.x),y.y=Math.max(ht.y,y.y)),sr=e.multiply(e.translation(h.x*g,h.y*p,0),ur),k=y.x-h.x+1,b=y.y-h.y+1,ni=new ct(k*g,b*p),ki())},this.render=function(n,t){var i,r,o;f.areEqual(n,vi)&&yi===a.opacity||(ft=e.multiply(sr.projectOnPlane(n.getGroundPlane()),n.getWorldToViewport()),t&&(ft.offsetX+=t,ft.offsetY+=t),i={explicitOpacity:!this.hideWhiteAnimating},r=this.hideWhileAnimating?ii.setExactTransformOrHide:ii.setTransformAndOpacity,u.useTransform3d||u.useTransform2d?(i.includeCommonCss=!1,i.returnStyleObject=!0,o=r(ft,ni,a.opacity,i),l.style[w.Properties.transform]=o[w.Properties.transform],a.opacity!=yi&&(l.style.opacity=a.opacity)):(ri=r(ft,ni,a.opacity,i),l.style.cssText=ri),fi()),yi=a.opacity,vi=n},this.getRootElement=function(){return l},this.getTilePyramid=function(){return c},this.getDownloadProgress=function(){return bt>0&&rt?1-rt.length/bt:1},this.getTileDownloadMetrics=function(){return cr},this.getNoImageTileRatio=function(){return bt>0?gt/bt:0},this.enableOrDisableScaledTiles=function(n){ui=n&&!ii.requireFlowLayout&&!tt&&!nt&&typeof c.getReplacementTileId=="function"},this.stopDownloading=function(){si=!1,pi.removeDownloadBasket(a)},this.dispose=function(){a.stopDownloading(),bi(),l&&l.parentNode&&l.parentNode.removeChild(l)},fi=function(){},u.useFilterReflowWorkaround&&ii.usingIEFilters&&(fi=function(){l.offsetWidth})}function iu(){function st(n,t,i){return n&&n.getTilePyramid()===t&&n.levelOfDetail===i}function s(t){if(t){if(d!=null){var i=t.getRootElement();d.removeAnimations(i)}n.removeHandler(t.rendererHandler),t.dispose()}}function fi(){s(r),r=null,s(h),h=null,e=o.none}function tt(){var st,t,f,lt,dt,k;b.cancelDispatch(tt);var c,gt=!1,ni=!1,ct=!1,ui=e>o.none,ti=!1,w=e===o.readyForTarget?a:it;g?ft&&(ot||(st=hi(),gt=st.keepGoing,ct=st.gridsAdded,ti=st.shouldSwapTileGrids),ei&&si()):(s(i),i=null,s(h),h=null,s(nt),nt=null,s(y),y=null,s(v),v=null),e<o.started&&(i&&(i.getDownloadProgress()<1&&(ni=!0),i.render(w)),h&&h.render(w),nt&&nt.render(w),r&&ui&&(r.render(w),bt(r)),y&&y.render(w,1),v&&v.render(w,1)),e===o.readyForTarget&&(r&&d.addToGroup(r.getRootElement()),i&&d.addToGroup(i.getRootElement()),y&&d.addToGroup(y.getRootElement()),v&&d.addToGroup(y.getRootElement()),i&&r&&rt.addToGroup(r.mercatorZoom>i.mercatorZoom?r.getRootElement():i.getRootElement())),ti&&(ii(r),kt(),i.mercatorZoom>h.mercatorZoom?(p(i.getRootElement()).set_style({opacity:1}),i.opacity=1):(p(h.getRootElement()).set_style({opacity:0}),h.opacity=0),rt.applyAllAnimations()),c=l.length;while(c--)t=l[c],t.havePendingDownloads=!1,f=t.tileGrid,lt=rr.getBestLevelOfDetail(a,t.tilePyramid,ht),k=t.tilePyramid.projectingCamera,dt=a.getHeading()!==k.getHeading()||a.getPitch()!==k.getPitch()||a.getRoll()!==k.getRoll()||a.getDistanceInverse()!==k.getDistanceInverse(),f&&(f.levelOfDetail!==lt||dt&&!u.animateOverlayLayers)&&(!t.tempDisplayGrid&&u.animateOverlayLayers?(t.tempDisplayGrid=f,t.swapping=null):f.dispose(),f=null),ft&&(!dt||u.animateOverlayLayers)&&e<o.readyForTarget&&(f||(f=yt(t.tilePyramid,lt),f.isOverlay=!0,f.hideWhileAnimating=t.animation==="s"?!1:t.animation==="h"?!0:u.animateOverlayLayers?!1:!0,f.opacity=t.opacity,ct=!0),f.populate(a,ut,et)),(f||t.tempDisplayGrid)&&(t.tempDisplayGrid?t.swapping&&f?((t.swapping!=f||ct||at)&&vt(f,c),t.tempDisplayGrid.dispose(),t.tempDisplayGrid=null,t.swapping=null):(f&&e===o.allowed&&vt(f,c),ri(f,t.tempDisplayGrid,.85)&&(e===o.none&&vt(f,c),t.swapping=f,gt=!0)):(ct||at)&&vt(f,c)),f&&(e<o.started&&f.render(w),e===o.readyForTarget&&d.addToGroup(f.getRootElement()),e>o.allowed&&(t.tempDisplayGrid?bt(f):ii(f)),f.getDownloadProgress()<1&&(t.havePendingDownloads=!0)),t.tempDisplayGrid&&(e<o.started&&t.tempDisplayGrid.render(w),e===o.readyForTarget&&d.addToGroup(t.tempDisplayGrid.getRootElement())),t.tileGrid=f;at=!1,!ni&&pt&&n.invoke(wt,"tiledownloadcomplete"),pt=ni,c=l.length;while(c--)t=l[c],!t.havePendingDownloads&&t.hadPendingDownloadsLastUpdate&&t.tileLayer&&n.invoke(t.tileLayer,"tiledownloadcomplete"),t.hadPendingDownloadsLastUpdate=t.havePendingDownloads;gt&&b.dispatch(tt,10),nt&&a.getWidth()/it.getWidth()>.95&&(s(nt),nt=null)}function hi(){var u=!1,y=!1,p=!1,b=f.areAligned(a,it)&&a.getWidth()===it.getWidth(),l=rr.getBestLevelOfDetail(a,g,ht),n=e>o.none,v;return st(i,g,l)?e<o.readyForTarget&&(s(r),r=null,v=b&&!n,i.populate(v?it:a,ut,et,n),h&&!n&&(y=oi())):(e<o.readyForTarget&&(st(r,g,l)||(s(r),r=yt(g,l),r.enableOrDisableScaledTiles(!0),r.mercatorZoom=g.projectingCamera.getMercatorZoom()+c.log2(g.projectingCamera.getWidth()/a.getWidth())),r.populate(a,ut,et)),i==null?(i=r,r=null,w.appendChild(i.getRootElement()),u=!0):r!=null&&(s(h),h=null,i.opacity=1,s(nt),nt=null,e===o.allowed&&(dt(),u=!0),wt.allowTileGridSwitch&&(!lt||r.getDownloadProgress()>.7)&&(!n||e>o.allowed)&&(r.getNoImageTileRatio()>.5?(s(r),r=null,ot=!0):n?p=!0:lt&&ti>1/t.maxFPS?(dt(),kt(),u=!0):(w.insertBefore(r.getRootElement(),i.getRootElement()),s(i),i=r,r=null,u=!0),h&&h.stopDownloading(),_lastTileGridBlendOn=new Date))),{keepGoing:y,gridsAdded:u,shouldSwapTileGrids:p}}function si(){var i=e>o.none,n=ci[rr.getBestLevelOfDetail(a,g,ht)],t=new ct(ut.width*ui,ut.height*ui);st(y,g,n)?e<o.readyForTarget&&y.populate(a,t,0):(v||(v=yt(g,n,!0),v.populate(a,t,0),w.childNodes[0]?w.insertBefore(v.getRootElement(),w.childNodes[0]):w.appendChild(v.getRootElement())),y?ri(v,y,.9)&&(s(y),y=v,v=null,st(y,g,n)||b.dispatch(tt)):(y=v,v=null))}function oi(){var t=!1,r=(_lastTileGridBlendOn?new Date-_lastTileGridBlendOn:0)/1e3,n=r/ti;return i.mercatorZoom>h.mercatorZoom?(i.opacity+=n,h.opacity=1,i.opacity<1&&n<.5?t=!0:(i.opacity=1,s(h),h=null)):(h.opacity-=n,i.opacity=1,h.opacity>0&&n<.5?t=!0:(s(h),h=null)),_lastTileGridBlendOn=new Date,t}function dt(){if(!r||!i)return;r.mercatorZoom>i.mercatorZoom?(i.getRootElement().nextSibling==null?w.appendChild(r.getRootElement()):w.insertBefore(r.getRootElement(),i.getRootElement().nextSibling),r.opacity=0):(w.insertBefore(r.getRootElement(),i.getRootElement()),r.opacity=1)}function kt(){h=i,i=r,r=null}function yt(t,i,r){var u=new rr(t,i,r);return u.rendererHandler=n.addHandler(u,"tilesrendered",li),u}function li(){b.dispatch(tt,10)}function bt(n){if(n){var t=n.getRootElement();t.style.left="-10000px",t.style.top="-10000px"}}function ii(n){if(n){var t=n.getRootElement();t.style.left="0px",t.style.top="0px"}}function vt(n,t){if(l[t].tempDisplayGrid){w.insertBefore(n.getRootElement(),l[t].tempDisplayGrid.getRootElement());return}var i=t+1;while(i<l.length){if(l[i].tempDisplayGrid){w.insertBefore(n.getRootElement(),l[i].tempDisplayGrid.getRootElement());break}else if(l[i].tileGrid){w.insertBefore(n.getRootElement(),l[i].tileGrid.getRootElement());break}i++}i<l.length||w.appendChild(n.getRootElement())}function ni(){at=!0,l.sort(function(n,t){return n.zIndex-t.zIndex})}function ri(n,t,i){return n&&n.getDownloadProgress()>i&&(n.mercatorZoom<=t.mercatorZoom||a.getWidth()/it.getWidth()>.9)}var wt=this,ti=.5,lt=!0,i=null,h=null,r=null,y=null,v=null,ci=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11,11,11,14,14,14,17,17,17,20,20,20,23,23,23,23],ei=u.animateOverlayLayers,ui=u.isIOSBrowser?2:4,ai,w=k();w.style.cssText="position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack;var g,a,it,ut,l=[],at=!0,pt=!1,ft=!0,et=0,ot=!1,nt,ht=0,e=o.none,d=null,rt=null;this.allowTileGridSwitch=!0,this.render=function(n,t,i,r,u){r!=a&&(ot=!1),i!==g&&(pt=!0,ot=!1),lt=u!=null?u:lt,ut=n,g=i,it=t,a=r,tt(),e>o.none&&e<o.started&&(e==o.readyForTarget&&d.applyAllAnimations(),e++)},this.getBaseTilePyramid=function(){return g},this.enableOrDisableCssAnimation=function(t,i){var u=t!=null,r;if(!u&&e===o.none)return;d||(d=new vr,rt=new vr,rt.manageAnimations([gt.TileFader.duplicate()]),r=function(n){n.hasPendingAnimations()?e=o.pendingCompletion:fi()},n.addHandler(d,"animationscomplete",function(){r(rt)}),n.addHandler(rt,"animationscomplete",function(){r(d)})),e>o.none&&(d.removeAllAnimations(),(!i||u)&&(rt.removeAllAnimations(),fi())),u&&wt.canCssAnimate()&&(d.manageAnimations([t]),e=t.isFlick?o.readyForTarget:o.allowed)},this.canCssAnimate=function(){return i&&g?!0:!1},this.addOverlay=function(n,t){var i=yi.getNext();return l.push({id:i,tilePyramid:n,zIndex:t.getZIndex(),opacity:t.getOpacity(),animation:t.getAnimation(),tileLayer:t,havePendingDownloads:!1,hadPendingDownloadsLastUpdate:!0}),ni(),b.dispatch(tt,10),i},this.removeOverlay=function(n){var i,t=l.length;while(t--)if(l[t].id===n){i=l[t].tileGrid,i&&i.dispose(),l[t].tempDisplayGrid&&(l[t].tempDisplayGrid.dispose(),l[t].tempDisplayGrid=null),l.splice(t,1),b.dispatch(tt,10);break}},this.updateOverlay=function(n,t,i){var r,u;_overlaysUpdated=!0,r=l.length;while(r--)if(l[r].id===n){u=l[r],u.opacity=i,u.zIndex!==t&&(u.zIndex=t,ni()),l[r].tempDisplayGrid&&(l[r].tempDisplayGrid.dispose(),l[r].tempDisplayGrid=null),b.dispatch(tt,10);break}},this.suspendGettingNewTiles=function(){ft=!1,s(r),r=null,s(h),h=null,s(nt),nt=null,i&&(i.opacity=1,i.allowTileRender=!1)},this.allowGettingNewTiles=function(){i&&(i.allowTileRender=!0),ft||(ft=!0,b.dispatch(tt,10))},this.disposeTiles=function(){b.cancelDispatch(tt),s(r),r=null,s(h),h=null,s(nt),nt=null,s(i),i=null,s(y),y=null,s(v),v=null;var t,n,u=l.length;while(u--)t=l[u],n=t.tileGrid,n&&(n.dispose(),t.tileGrid=null)},this.showBackground=function(n){n!==null&&(ei=n,n||(s(y),y=null,s(v),v=null))},this.setBufferSize=function(n){n=Math.max(0,Math.min(4,n)),n!=et&&(et=n,b.dispatch(tt))},this.getRootElement=function(){return w},this.setPartialZoomBias=function(n){ht=n},this.isDownloadingTiles=function(){return r&&r.getDownloadProgress()<1||i&&i.getDownloadProgress()<1},this.getTileDownloadMetrics=function(){var n=0;return n+=i?i.getTileDownloadMetrics():0,n+=r?r.getTileDownloadMetrics():0}}function or(){function li(n){et(n.collection,n.entity,!0,!1,y.last)}function ci(n){nt(n.entity,!0,!1),yt(n.entity)}function vi(n){et(n.collection,n.entity,!0,!1,y.last)}function pi(){et(null,h,!1,!0,y.last)}function f(t,u,e,o){var s,h,c;t||(t=si.getEntityForTarget(e.target)),t&&(s=t.entity,s.trueEntity&&f({entity:s.trueEntity,type:t.type},u,e,o),n.hasHandler(s,u)&&(o&&e.touches&&e.touches[0]&&(h=new i(e.touches[0].pageX,e.touches[0].pageY)),h||(h=p.Screen.get_mouse_pos(e)),c=new ai(r,t.type,s,u,h.x,h.y,0,o,e),n.invoke(s,u,c)))}function et(n,i,f,v,p){var vi,wi,nr,ni,ci,ai,si,dt,g,ri,bi,vt,pi,tr,gt,ki,ir,d,di,ht,ft,pt,ot;if(c){vi=!1,wi=r.getTheme(),wi&&(nr=i[it]=i[it]||{},ni=wi._preRenderEntity(i,nr,{updateEntity:f,themeReferenceKey:it}),ni&&ni!==i&&(ni.trueEntity=i,i=ni)),ci=lt.getEntityRenderer(r,i);if(ci)ai={entityCollection:n,rootDom:h[t].shape,rootOffsetLeft:h[t].offsetLeft,rootOffsetTop:h[t].offsetTop,parentDom:n[t].shape,parentOffsetLeft:n[t].offsetLeft,parentOffsetTop:n[t].offsetTop,parentVisible:fi(n),parentRemoved:!1,update:f,linear:v,animationStart:p===y.first,animationEnd:p===y.last,currentBounds:b,actualBounds:ui,viewportSize:c,customRenderer:l},ci.shouldDraw(i,ai)?(si=ci.update(i,ai),si&&ti(si,{entity:i,type:si.type})):nt(i,!0,f);else if(i instanceof gi){d=i[t],d?(dt=d.root,g=d.shape):(dt=k(null,u.safariRenderHack),g=k(null,u.safariRenderHack+";position:absolute;"),dt.appendChild(g),d={root:dt,shape:g,offsetTop:0,offsetLeft:0},i[t]=d,vi=!0,f=!0),f&&(ri="position:absolute;pointer-events:none;",i.getVisible()||(ri+="display:none;"),hi(n,i),bi=i.getZIndex(),typeof bi=="number"&&(ri+="z-index:"+bi+";"),dt.style.cssText=ri+u.safariRenderHack);var yt,oi=d.lookAt,li=!1,ei=!1;for(v&&oi?(vt=s==o.readyForTarget?bt.getWorldToViewport().transform(oi):st.getWorldToViewport().transform(oi),(!wt||!d.harmony)&&(Math.abs(vt.x)>1e4||Math.abs(vt.y)>1e4)?(li=!0,ei=!0,v=!1):s<o.started&&(pi=e.translation(vt.x,vt.y,0),u.useTransform3d&&!u.isIOS3?(tr=ii.setTransformAndOpacity(pi,null,1,{excludeCommonCss:!0,returnStyleObject:!0}),g.style[w.Properties.transform]=tr[w.Properties.transform]):(yt=ii.setTransformAndOpacity(pi,null,1,{excludeCommonCss:!u.isIOS3}),u.isIOS3||(yt="position:absolute;"+yt),g.style.cssText=yt),d.offsetLeft=vt.x,d.offsetTop=vt.y)):li=!0,li&&s<o.started&&(yt="position:absolute;",d.lookAt=st.getLookAt(),d.offsetLeft=0,d.offsetTop=0,g.style.cssText=yt),v&&oi&&s==o.readyForTarget&&rt.addToGroup(g),g.harmony&&!ct.areEqual(d.previousSize,c)&&(gt=g.harmony,gt.style.width=c.width+"px",gt.style.height=c.height+"px",gt.style.left=-(c.width/2)+"px",gt.style.top=-(c.height/2)+"px",d.previousSize=c),vi&&n[t].root.appendChild(dt),ei&&g.harmony&&g.harmony.style&&(g.harmony.style.display="none"),ki=i.getLength(),ht=0;ht<ki;ht++)et(i,i.get(ht),f,v&&!ei,p);ei&&setTimeout(function(){g&&g.harmony&&g.harmony.style&&(g.harmony.style.display="block")},1)}else if(i instanceof er)ir=i.getVisible()&&(l||b.contains(i.getLocation())||i[t]&&i[t].dragging),ir?yi(n,i,f,v):nt(i,!0,f);else if(i instanceof sr)if(n.getVisible()){d=i[t],d||(d={},i[t]=d);if(f||!d.added||a.getBaseTilePyramid()!==at){d.added=!1,at=a.getBaseTilePyramid(),di=at?at.projectingCamera:ut.mercator,ht=tt.length;while(ht--)ot=tt[ht][0],d[ot]&&(a.removeOverlay(d[ot]),d[ot]=null),i.getVisible()&&ut[ot]===di&&(ft=i.getTileSource(ot),ft&&(pt=kt.createQuadKeyTilePyramid(ft.getWidth(),ft.getHeight(),ft.getUriConstructor(),tt[ht][1],null,i.getDownloadTimeout()),pt.projectingCamera=ut[ot],d[ot]=a.addOverlay(pt,i),d.added=!0));!d.added&&i.getVisible()&&i.getReproject()&&(ft=i.getTileSource("mercator"),ft&&(pt=kt.createQuadKeyTilePyramid(ft.getWidth(),ft.getHeight(),ft.getUriConstructor(),tt[0][1],null,i.getDownloadTimeout()),pt.projectingCamera=ut.mercator,d[ot]=a.addOverlay(pt,i)),d.added=!0)}}else nt(i,!0,f)}}function yi(n,i,r,f){var c,h,ht,w,g,y,it,ct,a,tt,at,nt,ut,ot,et,d,b,ft;if(!n[t])return;h=i[t],h?(r=h.updateEntity||r,h.updateEntity=!1):(c=k("a",u.safariRenderHack),c.href="#",c[v]={entity:i,type:ri.pushpin},h={dom:c,dragAttached:!1,offsetTop:0,offsetLeft:0},i[t]=h,r=!0),c=h.dom,c.onclick==null&&(c.onclick=function(){return!1}),r&&(ht=i.getHtmlContent(),ht?(c.innerHTML=ht,h.isHtmlContent=!0,h.icon=h.text=null):(h.isHtmlContent&&(c.innerHTML="",h.isHtmlContent=!1),w=h.icon,g=i.getIcon(),!w&&g&&(w=k("img",u.safariRenderHack,c),h.icon=w,w[v]={entity:i,type:ri.pushpin},w.src=g),w&&w.src!==g&&(w.src=g||""),y=h.text,it=i.getText(),!y&&it&&(y=k(null,u.safariRenderHack,c),y.appendChild(document.createTextNode("")),h.text=y,y[v]={entity:i,type:ri.pushpin}),y&&(it?(y.style.cssText="position:absolute;text-align:center;width:100%;font:bold 10pt Arial,Helvetica,Sans-Serif;color:#fff;left:"+i.getTextOffset().x+"px;top:"+i.getTextOffset().y+"px;",y.replaceChild(document.createTextNode(it),y.firstChild)):(c.removeChild(y),h.text=null)))),ct=i.getHtmlContent(),a="";if(!l&&s<o.started){a=ct?"position:absolute;cursor:inherit;":"position:absolute;cursor:inherit;overflow:hidden;pointer-events:all;"+u.safariRenderHack;if(!f||!h.isDrawn){tt=s===o.readyForTarget?gt.internalTryLocationToViewport(bt,i.getLocation()):gt.internalTryLocationToViewport(st,i.getLocation());if(tt){var pt=i.getAnchor(),lt=tt.x-pt.x-n[t].offsetLeft,yt=tt.y-pt.y-n[t].offsetTop;u.useTransform3d&&i.getUseTransform3d()?(at=e.translation(lt,yt,0),nt={excludeCommonCss:!0},r?a+=ii.setTransformAndOpacity(at,null,1,nt):(nt.returnStyleObject=!0,ut=ii.setTransformAndOpacity(at,null,1,nt),h.displayHidden&&(ut.display=""),p(c).set_style(ut))):r?(a+="left:"+lt+"px;",a+="top:"+yt+"px;"):(c.style.left=lt+"px",c.style.top=yt+"px",h.displayHidden&&(c.style.display="")),h.displayHidden=!1}else r?a+="display:none;":c.style.display="none",h.displayHidden=!0;h.displayHidden=!0}}r&&(c.id=i.getId(),ot=i.getTypeName()||"",h.className!=ot&&(h.className=c.className=ot,p(c).add_class("MapPushpinBase")),et=i.getZIndex(),typeof et=="number"&&(a+="z-index:"+et+";"),d=i.getWidth(),b=i.getHeight(),ct?(d&&(a+="width:"+d+"px;"),b&&(a+="height:"+b+"px;")):(a+="width:"+(d?d+"px;":"auto;"),a+="height:"+(b?b+"px;":"auto;"),a+="line-height:0px;"),c.style.cssText=a),f||s!==o.readyForTarget||rt.addToGroup(c),(r||!h.isDrawn)&&(ft=i.getDraggable(),ft!=h.dragAttached&&vt(i,ft)),l?h.isDrawn?r&&l.updateEntity(i):(l.addEntity(i,c),h.isDrawn=!0):h.isDrawn||(n[t].shape.appendChild(c),h.isDrawn=!0)}function nt(n,i,u){var p,s,e,y,f,o,h,c,b,w;if(n){p=r.getTheme(),p&&(s=n[it]=n[it]||{},s.proxyEntity&&(n=s.proxyEntity),p._unhookFromEntity(n,s));if(n[t]){e=n[t];if(n instanceof gi){f=e.root,y=!1,i&&f&&f.parentNode&&(g?(g.push(f),y=!0):f.parentNode.removeChild(f)),o=n.getLength();while(o--)nt(n.get(o),y,u)}else if(n instanceof er)vt(n,!1),ni(n),f=e.dom,f&&(f[v]=null,f.onclick=null,i&&f.parentNode&&f.parentNode.removeChild(f)),e.updateEntity=e.updateEntity||u,e.isDrawn=!1,l&&l.removeEntity(n);else if(n instanceof sr){e.added=!1,o=tt.length;while(o--)h=tt[o][0],e[h]&&a.removeOverlay(e[h])}}else c=lt.getEntityRenderer(r,n),c&&(b={parentRemoved:!i,update:u,customRenderer:l},w=c.remove(n,b),ti(w,null))}}function ti(n,t){if(n&&n.doms){var r=n.doms,i=r.length;while(i--)r[i][v]=t}}function yt(n){var u,i;if(n instanceof gi){u=n.getLength();while(u--)yt(n.get(u))}else n instanceof er?(vt(n,!1),ni(n)):(i=lt.getEntityRenderer(r,n),i&&i.dispose(n));delete n[t]}function hi(n,i){n&&n[t]&&i&&i[t]&&(i[t].parentVisible=n[t].parentVisible&&n.getVisible())}function fi(n){return n&&n[t]?n[t].parentVisible&&n.getVisible():null}function vt(i,r){var u=i[t];u&&(u.dragAttached=r,r?u.dragStartHandler=n.addHandler(i,"mousedown",ei):u.dragStartHandler&&(n.removeHandler(u.dragStartHandler),delete u.dragStartHandler))}function ei(u){var s=u.target,f=s.trueEntity||s,e=s[t],o,c,h;if(e&&(u.isTouchEvent||u.originalEvent.which===1)){e.dragging=!0,o=r.tryLocationToPixel(f.getLocation());if(o){c=o.x-u.getX(),h=o.y-u.getY(),n.invoke(f,"dragstart",{entity:f});function a(t){t.handled=!0,t.originalEvent.preventDefault();var u=r.tryPixelToLocation(new i(t.getX()+c,t.getY()+h));u&&f.setLocation(u),n.invoke(f,"drag",{entity:f})}function l(){ni(s),n.invoke(f,"dragend",{entity:f})}e.dragAttached&&!e.dragEndHandler&&(e.dragMoveHandler=n.addHandler(r,"mousemove",a),e.dragEndHandler=n.addHandler(r,"mouseup",l))}}}function ni(i){var r=i[t];r&&(r.dragging=!1,r.dragMoveHandler&&(n.removeHandler(r.dragMoveHandler),delete r.dragMoveHandler),r.dragEndHandler&&(n.removeHandler(r.dragEndHandler),delete r.dragEndHandler))}or.ensureVmlNamespace();var si=this,r,gt,dt,l,h,a,ht,v,t,it,c,st,b,ui,bt,wt,ot,g,at,s=o.none,rt=new vr,y={first:0,middle:1,last:2},d=[["entityadded",li],["entityremoved",ci],["entitychanged",vi]],pt,tt=[["mercator",ft.horizontal],["enhancedBirdseyeNorthUp",ft.horizontal],["enhancedBirdseyeEastUp",ft.vertical],["enhancedBirdseyeSouthUp",ft.horizontal],["enhancedBirdseyeWestUp",ft.vertical]];this.activate=function(i,f,e,o,s,c){r=i,gt=f,dt=r.getRootElement(),h=r.entities,a=e,l=c,wt=oi.isClipped(),ht=s,v=ht+"_der",t=ht+"_etr",it=ht+"_thr",h[t]={root:o,shape:k(null,u.safariRenderHack+";position:absolute;",o),offsetTop:0,offsetLeft:0,parentVisible:!0};var y=d.length;while(y--)d[y][2]=n.addHandler(h,d[y][0],d[y][1]);pt=n.addHandler(lt,"newEntityRenderer",pi)},this.deactivate=function(){c=null;var t=d.length;while(t--)n.removeHandler(d[t][2]),d[t][2]=null;n.removeHandler(pt),pt=null,nt(h,!0,!1),yt(h),r=null,dt=null,h=null,a=null},this.enableOrDisableCssAnimation=function(n){if(!u.allowCssAnimations)return;var i=n!=null;rt.removeAllAnimations(),s=o.none,i&&(rt.manageAnimations([n]),s=n.isFlick?o.readyForTarget:o.allowed)},this.onMouseDown=function(n){f(null,"mousedown",n)},this.onTouchStart=function(n){g||(g=[]),f(null,"mousedown",n,!0)},this.onMouseUp=function(n){f(this.getEntityForTarget(n.captureTarget),"mouseup",n)},this.onTouchEnd=function(n){var i,r,t;f(this.getEntityForTarget(n.captureTarget),"mouseup",n,!0);if(g){i=g,g=null,r=i.length;while(r--)t=i[r],t&&t.parentNode&&t.parentNode.removeChild(t)}},this.onMouseOver=function(n){f(null,"mouseover",n)},this.onMouseOut=function(n){f(null,"mouseout",n)},this.onMouseClick=function(n){f(null,"click",n)},this.onMouseRightClick=function(n){f(null,"rightclick",n)},this.onMouseDoubleClick=function(n){f(null,"dblclick",n)},this.onTap=function(n){f(null,"click",n,!0)},this.onDoubleTap=function(n){f(null,"dblclick",n,!0)},this.onTapAndHold=function(n){f(null,"rightclick",n,!0)},this.getEntityForTarget=function(n){while(n&&!n[v]&&n!==dt)n=n.parentNode;return n=n&&n[v]||null},this.update=function(n,t,i,u,f){c=n,st=t,bt=i,f!=y.last&&u&&b||(b=r.getBounds(),ui=b.clone(),b.width*=3,b.height*=3),ot=f==y.last&&wt?!1:ot&&u,et(null,h,!1,ot,f),f==y.last&&(ot=!0),s>o.none&&s<o.started&&(s==o.readyForTarget&&rt.applyAllAnimations(),s++)}}function bu(t){function y(){a=f.getMode().getShouldClipPolygons(),r=f.getMode().getDrawShapesInSingleLayer()}function g(){e&&(n.removeHandler(e),e=null,n.removeHandler(s),s=null)}function d(n){return r?n.rootDom:n.parentDom}function tt(n,t){var u=null,i=n[o],f,r;return i&&(f=i.harmony,f&&(r=i.path,r&&(u=r.nativeShape,f.removePath(r),i.path=null)),i.updateEntity=i.updateEntity||t.update,i.isDrawn=!1),oi.isEventsSupported()&&u?{doms:[u]}:null}function h(n){var t=n[o];return t||(t={},n[o]=t),t}function nt(n){return n instanceof nr||n instanceof di&&a}function p(n,t){for(var s=n.x,o=n.x+n.width,l=n.y,c=n.y+n.height,e=[],i=[],a=t.length,f=null,r,h,u=0;u<a;u++)r=t[u],r?(h=r.x>=s&&r.y>=l&&r.x<=o&&r.y<=c,h?(!i.length&&u&&t[u-1]&&i.push(t[u-1]),i.push(r),f=null):(i.length&&(i.push(r),e.push(i),i=[]),f&&b(s,o,l,c,f,r)&&(i.push(f),i.push(r),e.push(i),i=[]),f=r)):(e.push(i),i=[]);return i.length&&e.push(i),e}function b(n,t,i,r,u,f){if(f.x-u.x==0)return u.x>=n&&u.x<=t;if(f.y-u.y==0)return u.y>=i&&u.y<=r;var o=(f.y-u.y)/(f.x-u.x),s=u.y-o*u.x,e=o*n+s;if(e>=i&&e<=r)return!0;e=o*t+s;if(e>=i&&e<=r)return!0;return o=(f.x-u.x)/(f.y-u.y),s=u.x-o*u.y,e=o*i+s,e>=n&&e<=t?!0:!1}function l(n,t,r){var h=n.x1,s=n.y1,l=n.x2,c=n.y2,f=t.x,u=t.y,o=r.x,e=r.y,v=((h*c-s*l)*(f-o)-(h-l)*(f*e-u*o))/((h-l)*(u-e)-(s-c)*(f-o)),a=((h*c-s*l)*(u-e)-(s-c)*(f*e-u*o))/((h-l)*(u-e)-(s-c)*(f-o));return new i(v,a)}function w(n,t){for(var e=n.x,a=n.x+n.width,s=n.y,v=n.y+n.height,p=[{x1:e,y1:s,x2:a,y2:s,isInside:function(n,t){return t>this.y1}},{x1:a,y1:s,x2:a,y2:v,isInside:function(n){return n<this.x2}},{x1:a,y1:v,x2:e,y2:v,isInside:function(n,t){return t<this.y2}},{x1:e,y1:v,x2:e,y2:s,isInside:function(n){return n>this.x1}}],u=t,f,o,y,i,h,r,c=0;c<p.length;c++)for(f=p[c],o=u,u=[],y=o.length,i=o[y-1],h=0;h<y;h++)r=o[h],f.isInside(r.x,r.y)?(f.isInside(i.x,i.y)||u.push(l(f,i,r)),u.push(r)):f.isInside(i.x,i.y)&&u.push(l(f,i,r)),i=r;return[u]}var f=t,c="cm"+yi.getNext(),o=c+"_etr",v=!0,a,r,s,e;y(),s=n.addHandler(f,"modeoptionschanged",y),e=n.addHandler(f,"ondispose",g),this.shouldDraw=function(n,t){var f,o,i,e;return t.parentVisible!==null&&(v=t.parentVisible),f=n.getVisible()&&(t.linear||t.animationEnd||u.animateShapes)&&(!r||v),f&&(o=h(n),i=o.boundingRect,(t.update||!i)&&(e=n.getLocations(),o.boundingRect=i=e?ht.fromLocations(e):null),f=i&&t.currentBounds.intersects(i)),f},this.update=function(n,t){var o=t.viewportSize,yt=t.currentBounds,i=h(n),y,a,s,e,ut,lt,at,v,l,ft,b,ht,st,it,et,ot,g,tt,rt;t.update=i.updateEntity||t.update,i.updateEntity=!1,y=i.harmony,a=d(t),!y&&a&&(s=a.harmony,s||(s=k("div","position:absolute;width:"+o.width+"px;height:"+o.height+"px;left:"+-(o.width/2)+"px;top:"+-(o.height/2)+"px;"+u.safariRenderHack),a.harmony=s,a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s)),y=oi.getContext(s),s.className="MicrosoftMapDrawing",i.harmony=y),e=i.path,ut=!1,e&&ct.areEqual(i.previousSize,o)||(y.setSize(o.width,o.height),i.previousSize=o,ut=!0),e||(e=y.createPath(),e.id=c+"path"+yi.getNext(),i.path=e,t.update=!0),t.update&&(lt=n.getStrokeColor(),e.strokeStyle=lt.toHex(),e.strokeOpacity=lt.getOpacity(),e.lineWidth=n.getStrokeThickness(),e.dashArray=n.getStrokeDashArray(),n instanceof di?(at=n.getFillColor(),e.fillStyle=at.toHex(),e.fillOpacity=at.getOpacity()):e.fillStyle="none");if(!t.linear||!i.points||ut){ft=null,b=i.boundingRect,b&&b.width>180&&(ft={referenceLocation:b.center}),i.points=f.tryLocationToPixel(n.getLocations(),null,ft),i.offsetLeft=r?t.rootOffsetLeft:t.parentOffsetLeft,i.offsetTop=r?t.rootOffsetTop:t.parentOffsetTop,ht=nt(n)&&(b.width>yt.width||b.height>yt.height),i.doClipping=ht;if(!ht){l=i.points,st=l.length,v=l.length;while(v--)l[v]||(st=!1,v=0);st||(i.points=[])}}if(!t.linear||t.animationEnd||t.update||ut){l=i.points;if(i.doClipping){var wt=o.width*3,pt=o.height*3,kt=r?t.rootOffsetLeft:t.parentOffsetLeft,dt=r?t.rootOffsetTop:t.parentOffsetTop,bt=new vt(-kt-wt/2,dt-pt/2,wt,pt);it=n instanceof nr?p(bt,l):w(bt,l)}else it=[l];e.beginPath(),et=i.offsetLeft-o.width/2,ot=i.offsetTop-o.height/2,v=it.length;while(v--){g=it[v];if(g&&g.length)for(tt=g[0],e.moveTo(tt.x-et,tt.y-ot),rt=1;rt<g.length;rt++)tt=g[rt],e.lineTo(tt.x-et,tt.y-ot)}e.data||e.moveTo(0,0),e.stroke(),i.isDrawn||(y.renderPath(e),i.isDrawn=!0)}return oi.isEventsSupported()&&n.getShouldFireEvents()?{doms:[e.nativeShape],type:n instanceof nr?ri.polyline:ri.polygon}:null},this.remove=tt,this.dispose=function(n){delete n[o]}}function tu(n,t,i,r,u){function e(n){var u=[],i=n?n.split(";"):[],r=i.length,t;while(r--)t=ht.fromString(i[r]),t&&u.push(t);return u}this.priority=u;var f=e(r);this.getScene=function(r,u,e,o){if(o>=t&&o<i){if(!f||!f.length)return n;var c=new y(u,e),h=f.length;while(h--)if(f[h].contains(c))return n}return null}}function ei(n,t){var i=n;this.getCopyrights=function(n,r,u,f){t(function(t){t?dr.getCopyrights(i,n,r,u,t,f):f([ti.defaultCopyright.text])})}}function uu(r,e,o,s,h,c,l){function ot(n){n.stopPropagation(),n.preventDefault()}function fi(n,t){var r,i;r=n.length;if(t&&!n.isWired){while(r--)i=n[r],s.add_event(i[0],i[1],!1);n.isWired=!0}else if(!t&&n.isWired){while(r--)i=n[r],s.remove_event(i[0],i[1],!1);n.isWired=!1}}function ht(){return y!=null&&(y.x!=0||y.y!=0)}function vi(){dt&&ht()&&(y.x*=dt,y.y*=dt,Math.abs(y.x)<5&&Math.abs(y.y)<5&&(y.x=0,y.y=0))}function yi(n,t,i){if(n&&t&&i){var u=i.x-t.x,r=i.y-t.y;u!=0||r!=0?(ct+=n,y?(y.x=.3*y.x+.7*u*1e3/ct,y.y=.3*y.y+.7*r*1e3/ct):y=new ni(u*1e3/ct,r*1e3/ct),ct=0):ct+=n}}function di(n){var t=p.Screen.get_mouse_pos(n);return new i(t.x-e.getViewportX(),t.y-e.getViewportY())}function st(){return new i(0,0)}function d(t,u,f,o){var y=!1,c,w,s,l,v;return n.hasHandler(r,u)&&(o||(f.touches&&f.touches[0]?c=new i(f.touches[0].pageX,f.touches[0].pageY):a&&a[0]&&(c=a[0])),c||(c=p.Screen.get_mouse_pos(f)),w=f.wheelDelta?f.wheelDelta:0,h&&(t&&(s=h.getEntityForTarget(t)),s||(s=h.getEntityForTarget(f.target)),s&&(l=s.type,s=s.entity)),l||(s=e,l=ri.map),v=new ai(e,l,s,u,c.x,c.y,w,!o,f),u==="click"&&(v.mouseMoved=ei&&g&&i.distance(ei,g)>5),n.invoke(r,u,v),y=v.handled),y}function br(n){if(!n.handled){var t=!1;if(n.ctrlKey)switch(n.keyCode){case 37:o.rotate(90);break;case 39:o.rotate(-90)}else switch(n.keyCode){case 37:v.x>-1&&(v.x=-1),t=!0;break;case 39:v.x<1&&(v.x=1),t=!0;break;case 38:v.y>-1&&(v.y=-1),t=!0;break;case 40:v.y<1&&(v.y=1),t=!0;break;case 109:case 189:at=-1;break;case 107:case 187:case 61:at=1}r.ensureUpdateDispatched(),t&&(n.handled=!0,ot(n.originalEvent))}}function kr(n){if(!n.handled){switch(n.keyCode){case 37:case 39:v.x=0;break;case 38:case 40:v.y=0;break;case 109:case 189:case 107:case 187:case 61:at=0}r.ensureUpdateDispatched()}}function si(){v.x=0,v.y=0,at=0}function ki(n){if(!d(null,"dblclick",n,!0)&&!et){if(h)h.onMouseDoubleClick(n);var t=ft?st():di(n);o.zoomCenter(.5,t)}ot(n)}function wr(n){if(!d(null,"click",n,!0)&&h){h.onMouseClick(n);if(u.emulateDblClick){var t=p.Screen.get_mouse_pos(n);new Date-hi<bi&&t.x===kt.x&&t.y===kt.y?(kt={x:0,y:0},hi=new Date(0),ki(n)):(kt=t,hi=new Date)}}}function tu(n){if(!d(null,"rightclick",n,!0)&&h)h.onMouseRightClick(n)}function nu(n){if(!d(null,"mousewheel",n,!0)&&!et){nt.clearInertialScrolling();if(n.wheelDelta){var t=ft?st():di(n);o.zoomPoint(n.wheelDelta,t)}ot(n)}}function dr(n){if(!d(null,"mousedown",n,!0)){si(),r.suspendSceneChanges(!1),r.haltCssAnimation(),o.startUserInput();if(h)h.onMouseDown(n);wt=!et&&c&&(n.shiftKey===!0||n.which===2),g=p.Screen.get_mouse_pos(n),nt.clearInertialScrolling(),ei=tt=g,p.Events.capture_mouse(this,!1),ui=!0,wt?s.set_style({cursor:r.getCursors().SEResize}):s.set_style({cursor:r.getCursors().Grabbing})}ot(n);try{document.focus()}catch(t){}}function gr(n){d(null,"mousemove",n,!0)||tt&&(g=p.Screen.get_mouse_pos(n),r.ensureUpdateDispatched(),ir=new Date,ot(n))}function yr(n){ui&&gi(n)}function gi(n){var l,a;if(!d(n.captureTarget,"mouseup",n,!0)){r.canUseCssAnimations()&&ht()||r.allowSceneChanges(),yt===!0&&(l=new Date,a=l-ir,a<ur?it=g:nt.clearInertialScrolling()),r.ensureUpdateDispatched();if(h)h.onMouseUp(n);if(wt&&tt)if(i.distance(tt,g)>10){var f=e.getViewportX(),u=e.getViewportY(),t=vt.union(new i(tt.x-f,tt.y-u),new i(g.x-f,g.y-u)),y=Math.max(t.width/e.getWidth(),t.height/e.getHeight()),v=ft?st():t.getCenter();o.zoomCenter(y,v)}}c&&(ut.style.display="none",ut.parentNode&&ut.parentNode.removeChild(ut)),s.set_style({cursor:r.getCursors().Grab}),tt=null,ui=!1,p.Events.release_mouse()}function sr(n){if(!d(null,"mouseover",n,!0)&&h)h.onMouseOver(n)}function or(n){if(!d(null,"mouseout",n,!0)&&h)h.onMouseOut(n)}function ci(n){var r=e.getViewportX(),t=e.getViewportY();return n.length>1?new i((n[0].x+n[1].x)/2-r,(n[0].y+n[1].y)/2-t):n.length?new i(n[0].x-r,n[0].y-t):new i(0,0)}function ar(n){n.preventManipulation&&n.preventManipulation(),n.currentTarget&&n.currentTarget.msSetPointerCapture&&n.currentTarget.msSetPointerCapture(n.pointerId),n.preventMouseEvent&&n.preventMouseEvent(),si(),li();if(!d(null,"mousedown",n,!1)){r.suspendSceneChanges(!0),r.haltCssAnimation(),o.startUserInput();if(h)h.onTouchStart(n);nt.clearInertialScrolling();var t=Math.min(2,n.touches.length);lt===0&&t===2&&(lt=r.getCurrentCamera().getMercatorZoom()),b.length===0&&t===1&&(w=new i(n.touches[0].pageX,n.touches[0].pageY),w.target=n.target,w.start=new Date,ti=setTimeout(hr,pr));while(t--)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY),b[t]=a[t],rt[t]=a[t];fr=r.getCurrentCamera().getHeading()}ot(n)}function vr(n){(n.touches.length>1||w&&(Math.abs(n.touches[0].pageX-w.x)>20||Math.abs(n.touches[0].pageY-w.y)>20))&&(oi(),li());if(n.touches.length>1||!d(null,"mousemove",n,!1)){var t=b.length;if(t){t=n.touches.length;while(t--)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY)}}r.ensureUpdateDispatched(),nr=new Date,ot(n)}function pi(n){var l,g,k,p,u,s,c,t,v,y;n.currentTarget.msReleasePointerCapture&&n.currentTarget.msReleasePointerCapture(n.pointerId),li();if(!d(null,"mouseup",n,!1)){if(h)h.onTouchEnd(n);w&&(lr(),gt&&new Date-gt.start<bi?(l=new i(w.x-e.getViewportX(),w.y-e.getViewportY()),cr(),oi()):(gt=w,w=null)),b.length===1&&yt===!0&&(g=new Date,k=g-nr,k<ur?it=a[0]:nt.clearInertialScrolling()),b.length=0,n.touches.length&&(nt.clearInertialScrolling(),a[0]=b[0]=new i(n.touches[0].pageX,n.touches[0].pageY)),r.canUseCssAnimations()&&ht()?r.ensureUpdateDispatched():r.allowSceneChanges();if(l&&!et)u=ft?st():l,o.zoomCenter(.5,u,null,!0);else{if(rt.length>1&&r.isRotationEnabled()){var tt=new ni(rt[1].x-rt[0].x,rt[1].y-rt[0].y),ut=new ni(a[1].x-a[0].x,a[1].y-a[0].y),ot=Math.atan2(ut.y,ut.x)-Math.atan2(tt.y,tt.x);Math.abs(ot)>.7&&(lt=0),rt.length=0}lt!==0&&ii>0&&(u=ft?st():ci(a),s=r.getCurrentCamera().getMercatorZoom(),c=s-lt,lt=0,t=Math.abs(c),t-=Math.floor(t),t>=ii&&t<.5&&(v=c>0?Math.ceil(s):Math.floor(s),y=f.mercatorZoomToWidth(v,r.getCurrentCamera().getCrs(),p)/f.mercatorZoomToWidth(s,r.getCurrentCamera().getCrs(),p),o.zoomCenter(y,u,u)))}ht()||o.endUserInput()}}function li(){ti&&(clearInterval(ti),ti=null)}function oi(){gt=null,w=null}function lr(){if(!d(null,"click",w,!1)&&h)h.onTap(w)}function cr(){if(!d(null,"dblclick",w,!1)&&h)h.onDoubleTap(w)}function hr(){if(w){if(!d(null,"rightclick",w,!1)&&h)h.onTapAndHold(w);oi()}}var nt=this,ut;l=l||{},c&&(ut=k("div","display:none;z-index:0;position:absolute;border:1px dashed #000;background:#ccc"),p(ut).set_style({opacity:".5"}));var wi=.15,bi=500,pr=1e3,gt,w,ti,ii=l.touchZoomThreshold!=null?l.touchZoomThreshold:.1,iu=[],ui=!1,yt=!0,dt=.9,y=null,pt=null,it=null,kt={x:0,y:0},hi=new Date(0),ir=new Date(0),nr=new Date(0),ur=100,ct=0,ft=!1,et=!1,er=[["dblclick",ki],["click",wr],["mousewheel",nu],["mousedown",dr],["mousemove",gr],["mouseup",gi],["losecapture",yr],["contextmenu",tu],["mouseover",sr],["mouseout",or]],tr=[["touchstart",ar],["touchmove",vr],["touchend",pi],["touchcancel",pi]],bt=[["keydown",br,null],["keyup",kr,null],["blur",si,null]],ru=null,uu=.003*u.scrollAdjustment,fu=0,v=new i(0,0),at=0,rr=new Date(0),g,tt,ei,wt,a=[],rt=[],fr,b=[],lt=0;nt.enableOrDisableInertialScrolling=function(n,t){n?(yt=!0,typeof t=="number"&&(dt=Math.min(Math.max(t,.01),.99))):yt=!1},nt.enableOrDisableUserInput=function(t,i){if(i){t=t&&!i.disableUserInput,fi(er,t&&!i.disableMouseInput),t&&!i.disableTouchInput?(s.set_style({"-ms-touch-action":"none"}),fi(tr,!0)):(s.set_style({"-ms-touch-action":""}),fi(tr,!1)),t=t&&!i.disableKeyboardInput;var u,f;u=bt.length;if(t)while(u--)f=bt[u],f[2]||(f[2]=n.addHandler(e,f[0],f[1]));else while(u--)n.removeHandler(bt[u][2]),bt[u][2]=null;ft=i.disablePanning?!0:!1,et=i.disableZooming?!0:!1,s.set_style({cursor:r.getCursors().Grab})}},nt.setTouchZoomThreshold=function(n){ii=Math.min(n,.49)},nt.clearInertialScrolling=function(){it=null,y=null},nt.processPendingUserInput=function(){var h=new Date,l=pt?h-pt:null,p,ri,ui,w,c,u,d,ot,bt,k,lt;pt=h,ri=r.getCurrentCamera().getWidth(),ui=r.getCurrentCamera().getLookAt(),at&&!et&&(nt.clearInertialScrolling(),p=at<0?2:.5),(v.x||v.y)&&!ft&&(nt.clearInertialScrolling(),w=v.x*wi*e.getWidth(),c=v.y*wi*e.getHeight(),Math.abs(v.x)>.9&&Math.abs(v.x)<3&&(v.x=v.x*1.01),Math.abs(v.y)>.9&&Math.abs(v.y)<3&&(v.y=v.y*1.01)),(p||w||c)&&(h=new Date,(pt-rr)/1e3>r.getCameraAnimationDuration()/3&&(p&&o.zoom(p),(w||c)&&o.doDragXY(w,c),rr=h));if(tt)if(wt&&!et){var ti=e.getPageX(),gt=e.getPageY(),f=vt.union(new i(tt.x-ti,tt.y-gt),new i(g.x-ti,g.y-gt));ut.style.left=f.x+"px",ut.style.top=f.y+"px",ut.style.width=f.width+"px",ut.style.height=f.height+"px",ut.style.display="block",s.element().appendChild(ut)}else ft||(o.doDrag(tt,g),yt===!0&&yi(l,tt,g),tt=g);else if(b.length>0){u=b.length;if(a.length>=u){switch(u){case 1:ft||(o.doDrag(b[0],a[0]),yt===!0&&yi(l,b[0],a[0]));break;case 2:d=ft?st():ci(b),ot=ft?st():ci(a);if(!a[0]||!a[1]||!b[0]||!b[1])return;bt=1,et||(bt=i.distance(b[0],b[1])/i.distance(a[0],a[1])),k=0;if(rt.length>1&&r.isRotationEnabled()){var dt=new ni(rt[1].x-rt[0].x,rt[1].y-rt[0].y),kt=new ni(a[1].x-a[0].x,a[1].y-a[0].y),fi=Math.atan2(kt.y,kt.x)-Math.atan2(dt.y,dt.x);k=fr-r.getCurrentCamera().getHeading()-fi*180/Math.PI}o.setCamera(bt,d,ot,k)}while(u--)b[u]=a[u]}}else if(ht()){lt=r.requestCssAnimation(!0);if(lt){var n=new i(it.x,it.y),ct=1/t.maxFPS,ii=0;while(ht())n.x+=y.x*ct,n.y+=y.y*ct,ii+=ct,vi();lt.setDuration(ii),r.suspendSceneChanges(!0),o.doDrag(it,n,!0),it=n}else{if(it){var n=new i(it.x+y.x*l/1e3,it.y+y.y*l/1e3),d=new i(Math.round(it.x),Math.round(it.y)),ot=new i(Math.round(n.x),Math.round(n.y));o.doDrag(d,ot),it=n}vi(),ht()?r.ensureUpdateDispatched():o.endUserInput()}}else o.endUserInput()}}function hu(n,t){var e=null,o=.003*u.scrollAdjustment,r=0;this.doDrag=function(r,u,f){if(r&&u&&!i.areEqual(r,u)){var o=t.getViewportX(),e=t.getViewportY(),c=new i(r.x-o,r.y-e),h=new i(u.x-o,u.y-e),s=n.getCurrentCamera().getViewportToWorld().transform(c);n.setAlignedCamera(n.getCurrentCamera().getCrs(),s,h,n.getCurrentCamera().getWidth(),n.getCurrentCamera().getHeading(),f)}},this.doDragXY=function(t,r){var f=n.getCurrentCamera().getWidth(),u=n.getCurrentCamera().getViewportToWorld().transform(new i(t,r));n.setAlignedCamera(n.getCurrentCamera().getCrs(),u,null,f,n.getCurrentCamera().getHeading(),!0)},this.zoom=function(t){var i=n.getCurrentCamera().getWidth()*t,r=n.getCurrentCamera().getLookAt();i!==n.getTargetCamera().getWidth()&&n.setAlignedCamera(n.getCurrentCamera().getCrs(),r,null,i,n.getCurrentCamera().getHeading(),!0)},this.zoomCenter=function(t,i,r,u){var o=n.getTargetCamera(),h=o.getWidth()*t,c=o.getViewportToWorld().transform(i),e,s;u&&(e=f.widthToMercatorZoom(h,o.getCrs(),o.getLookAt()),e!=Math.floor(e)&&(s=e-o.getMercatorZoom()>0?Math.floor(e):Math.ceil(e),e=s+Math.round(e-s),h=f.mercatorZoomToWidth(e,o.getCrs(),o.getLookAt()))),n.requestCssAnimation(),n.setAlignedCamera(o.getCrs(),c,r,h,o.getHeading(),!0)},this.zoomPoint=function(t,i){var y=new Date,h=y-e,l,s,c,u,v,a;e=y,l=n.getCurrentCamera().getViewportToWorld().transform(i),s=o*t*(t>0?1:.75),h>200?(h=200,r=s/h):r=(r+s/h)/2,r=Math.min(.009,r),r=Math.max(-.006,r),c=n.getCurrentCamera().getMercatorZoom(),u=c+r*(r>0?400:250),u=s>0?Math.min(n.getInternalMaxZoom(),Math.ceil(u)):Math.max(n.getInternalMinZoom(),Math.floor(u)),v=f.mercatorZoomToWidth(u,n.getCurrentCamera().getCrs(),l),a=(u-c)/r*1.5,n.setAlignedCamera(n.getCurrentCamera().getCrs(),l,i,v,n.getCurrentCamera().getHeading(),a)},this.rotate=function(t){n.setAlignedCamera(n.getTargetCamera().getCrs(),n.getTargetCamera().getLookAt(),null,n.getTargetCamera().getWidth(),n.getTargetCamera().getHeading()+t,!0)},this.setCamera=function(t,i,r,u){var e=n.getCurrentCamera().getViewportToWorld().transform(i),f=c.log2(1/t);n.setCamera(n.getCurrentCamera().getAlignedCamera(f,e,r,u),!1)},this.startUserInput=function(){},this.endUserInput=function(){}}function au(i){function ft(n,t,i,r,u,f){var rt,l,b,w,tt;if(r>=it){rt=et.toEllipsoid(new y(t,i)),l=a.wrap(a.fromLocation(rt));if(p(n,l,r,u,f))return n;var st=1<<g,ft=d.mercatorXYToTileId(l,g),v=d.tileIdToCacheKey(ft),ut=Math.round(c.normalizeDegrees(u)/s)*s%360,h=e.get(v)||[],nt=h.length,k;while(nt--){k=h[nt];if(p(k,l,r,u,f))return k}b="h"+ut.toFixed(),h[b]||(h[b]=!0,e.insert(v,h),w=d.tileIdToLocation(ft),tt=o.replace("{centerpoint}",w.latitude.toFixed(6)+","+w.longitude.toFixed(6)).replace("{heading}",ut.toFixed(0)),fi.getObjectAsync(tt,ot,v))}return null}function ot(t,i){var f=i.userData,r,u;i.success&&t&&t.statusCode===200&&t.resourceSets&&t.resourceSets.length&&(r=t.resourceSets[0],r.resources&&r.resources.length&&(u=e.get(f)||[],nt(r.resources[0],u),e.insert(f,u),n.invoke(h,"newsceneavailable")))}function nt(n,i){var it;if(n.bes&&n.bes.bec&&n.bes.bei){var s=n.bes,kt=s.s.toString(),o=s.bei,e=s.bec,w=k.get(kt);if(!w){w=[];var ot=2*Math.ceil(o.piw/(2*u)),ht=2*Math.ceil(o.pih/(2*u)),st=ot*u,d=new r(e.qcx,e.qcy,e.qcz),pt=new r(e.qdx,e.qdy,e.qdz),ti=new r(e.qex,e.qey,e.qez),g=fr.toLocation(d),ii=et.getAltitudeAtLatLon(g.latitude,g.longitude),bt=fr.fromLocation(new y(g.latitude,g.longitude,ii,dt.ellipsoid)),ri=ui.fromNormal(bt,fr.getUpVector(bt)),ni=ri.intersectWithLine(d,r.add(d,pt)),gt=r.subtract(ni,d).getLength(),yt=st/o.piw*(e.ox/(2*e.ol)),si=2*Math.atan(yt),oi=2*gt*yt,fi=f.fromDirectionVector(fr,ni,oi,pt,ti,1/gt),nt=fi.convertCoordinateReferenceSystem(a),lt=(o.piw-b)/st,ct=(o.pih-b)/st,at=new vt(-lt/2-e.opx,-ct/2-e.opy,lt,ct),h,p,ft;p=v(ut.replace("{quadkey}",s.q).replace("{runtimeindex}",s.ri),ot,ht,s.l,e.opx*o.piw,e.opy*o.pih),p.projectingCamera=nt,ft=nt.getAlignedCamera(c.log2(p.getWidth()/t.zoomOriginWidth)-1),h=new wt(ft,p,1,"NativeBirdseye",new ei("Birdseye",l)),h.nativeBirdseyeFrustumRect=at,h.labelOverlay=rt.hidden,w.push(h),p=v(tt.replace("{quadkey}",s.q).replace("{runtimeindex}",s.ri),ot,ht,s.l,e.opx*o.piw,e.opy*o.pih),p.projectingCamera=nt,h=new wt(ft,p,1,"NativeBirdseye",new ei("BirdseyeWithLabels",l)),h.nativeBirdseyeFrustumRect=at,h.labelOverlay=rt.visible,w.push(h)}k.insert(kt,w),it=w.length;while(it--)i.push(w[it])}}function p(n,t,i,r,u){if(n&&n.nativeBirdseyeFrustumRect&&n.labelOverlay===u&&c.distanceDegrees(r,n.nativeCamera.getHeading())<s&&i>=n.nativeCamera.getMercatorZoom()-.5){var f=n.tilePyramid.projectingCamera.getWorldToFrustum().transform(t);if(n.nativeBirdseyeFrustumRect.contains(f))return!0}return!1}function v(n,t,i,r,f,e){var s=Math.ceil(t/2),h=Math.ceil(i/2),o=new kt(t*u,i*u,u,u,0,0,f,e,function(u){var e,f,c;switch(u.levelOfDetail){case o.getMaxLevelOfDetail()-1:f=s,c=h,e=r-1;break;case o.getMaxLevelOfDetail():f=t,c=i,e=r}if(e)if(u.x>=0&&u.x<f&&u.y>=0&&u.y<c)return n.replace("{subdomain}",(u.y&1)*2+(u.x&1)).replace("{level}",e).replace("{index}",f*u.y+u.x);return null});return o}var h=this,l=i.credentialsProvider,ut=i.urlFormat,tt=i.urlWithLabelsFormat,it=17.1,e=new ci(100),g=19,k=new ci(100),s=45,b=400,u=256,o=t.nativeBirdseyeMetadataUrl.replace("{zoom}","20"),w;this.priority=40,this.getScene=function(){return w||(w=!0,l(function(t){o=o.replace("{credentials}",t),h.getScene=ft,n.invoke(h,"newsceneavailable")})),null}}var s=window.Microsoft.Maps,p=s.Gimme,t=s.Globals,yr,h,l,v,u,b,hi,dt,pt,rt,si,n,cr,bi,wi,fi,ri,ur,hr,ar,fu,tt,c,nt,a,fr,ut,d,et,w,o,gt,ft,oi,lu,dr,cu;Microsoft.Maps.Resources=new function(n){n=n||{},n.strings={},this.init=function(t){var i;for(i in t)n.strings[i]={value:t[i]}},this.getString=function(){function f(n){i.languages=[t.locale];var r="";try{r=e.getValue(n,i).valueAsString}catch(u){}return r}function u(t){return n.strings[t]&&n.strings[t].value||""}if(window.Windows&&Windows.ApplicationModel){var r=Windows.ApplicationModel.Resources.Core,e=r.ResourceManager.current.mainResourceMap.getSubtree("/Bing.Maps.Javascript/Resources"),i=new r.ResourceContext;return f}return u}()}(this),yr=s.Resources,l={},s.InternalNamespaceForDelay=l,v="mm$",typeof PRF=="undefined"&&(PRF={add:function(){},start:function(){},end:function(){}}),l.PRF=PRF,PRF.start("mapcore");var ki=new function(){function f(n,t){var i=!1;return o(n)&&(e(n,t),i=!0),i}function o(n){return localStorage&&localStorage.getItem(n+".keys")&&!localStorage.getItem(n+".invalid")?!0:!1}function i(n,t){var r,i,u;if(!localStorage.getItem(n+".keys")||typeof t!="function")return;for(r=localStorage.getItem(n+".keys").split(";"),i=0,i=r.length;i>0;i--)u=r[i-1],t(u)}function e(n,t){i(n,function(i){t[i]=u(n,i)})}function h(r){localStorage.setItem(r+".invalid","true"),i(r,function(i){localStorage.removeItem(n(r,i)),localStorage.removeItem(t(r,i))}),localStorage.removeItem(r+".keys"),localStorage.removeItem(r+".invalid")}function s(n,t){var u,i;h(),u="";for(i in t)r(n,i,t[i]),u+=i+";";localStorage.setItem(n+".keys",u.substring(0,u.length-1))}function r(i,r,u){var f=typeof u;localStorage.setItem(t(i,r),f),localStorage.setItem(n(i,r),u)}function u(i,r){var f=localStorage.getItem(t(i,r)),u=localStorage.getItem(n(i,r));switch(f){case"number":return Number(u);case"boolean":return u==="true";case"string":case null:return u}}function n(n,t){return n+"."+t}function t(n,t){return n+"."+t+".type"}this.GlobalsId="globals",this.culture="en-US",this.homeRegion="US",this.UpdateCulture=function(n,t){n!==""&&(this.culture=n),t!==""&&(this.homeRegion=t),this.GlobalsId="globals"+this.culture.toLowerCase()+this.homeRegion.toLowerCase()},this.tryLoadConfigIntoObject=function(n,t){return typeof n!="string"||n===""||!t||!localStorage?!1:f(n,t)},this.writeConfig=function(n,t){if(typeof n!="string"||n===""||!t)return;localStorage&&s(n,t)}},nu=new function(){function i(){r||(r=!0,PRF.end("Module initialized",t,{module:"Map Core"}),tt.done(t))}var u=this,n=Microsoft.Maps.Globals,r=!1,t="Microsoft.Maps.Map";this.tryCachedGlobals=function(r,f){var o=!1,s=typeof f.culture=="string"?f.culture:"",h=typeof f.homeRegion=="string"?f.homeRegion:"",e;return ki.UpdateCulture(s,h),ki.tryLoadConfigIntoObject(ki.GlobalsId,n)&&(o=!0,e=tt.getRegistration(t).scriptUrls,e&&e.length>0&&fi.getObjectAsync(e[0],u.parse),i()),o},this.parse=function(t){var u,r;if(!t||typeof t.ishttpsenabled=="undefined"&&typeof t.killSwitchEngaged=="undefined")return;if(t.jsonTimeStamp&&n.jsonTimeStamp&&t.jsonTimeStamp==n.jsonTimeStamp)return;u=!n.version,t.clientVersion="7.0.20121025103423.49",t.cssPath="///Bing.Maps.JavaScript/css/",t.imagePath="///Bing.Maps.JavaScript/images/",t.jsPath="///Bing.Maps.JavaScript/js/",t.pushpinImageUrl="///Bing.Maps.JavaScript/images/poi_search.png",t.cursorPath="///Bing.Maps.JavaScript/cursors/",t.logServiceUrl&&(t.logServiceUriFormat=t.logServiceUriFormat.replace(t.version,t.clientVersion)),t.bingThemeIconUrlFormat="///Bing.Maps.JavaScript/images/BingTheme/pins/pin_{iconStyle}{imageryStyle}{state}.png",t.killSwitchImageUrl="///Bing.Maps.JavaScript/images/rr.png",t.directionsImagePath="///Bing.Maps.JavaScript/images/Directions/",t.protocol=t.ishttpsenabled?"https://":"http://",t.jsonTimeStamp=(new Date).valueOf();for(r in t)typeof t[r]=="string"&&(t[r]=t[r].replace(/{urischeme}/g,t.protocol).replace(/{version}/g,t.version).replace(/{culture}/g,t.locale).replace(/{generation}/g,t.tilegeneration)),u&&(n[r]=t[r]);ki.writeConfig(ki.GlobalsId,t),u&&(n.protocol=t.protocol,i())}},yi=new function(){var n=1e3;this.getNext=function(){return n++}};l.IdGenerator=yi;var ti=new function(){this.isValidNumber=function(n){return typeof n=="number"&&isFinite(n)},this.cloneObject=function(n){var i={},t;for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},this.createElement=function(n,t,i){var r=document.createElement(n||"div");return t&&(r.style.cssText=t),i&&i.appendChild(r),r},this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=function(n){n.stopPropagation()},this.prioritySort=function(n,t){return n.priority-t.priority},this.isArray=function(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},this.extend=function(n,t){function i(){}i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n.baseConstructor=t,n.superClass=t.prototype},this.restrictLongitude=function(n,t){while(t-n>180&&t>n)t-=360;while(n-t>180&&t<n)t+=360;return t};var n=function(){function t(n,t,i){return Object.defineProperty(n,t,i)}function n(n,t,i){return n[t]=i.get(),n}try{return Object.defineProperty({},"test",{}),t}catch(i){return n}}();this.defineGetter=n,this.defaultCopyright=n({},"text",{get:function(){return yr.getString("L_microsoftcopyright_text").replace(/{year}/,(new Date).getFullYear())}})},bt=1e-11,vi=ti.isValidNumber,ru=ti.cloneObject,k=ti.createElement,gu=ti.ignoreEvent,du=ti.stopPropagation,ku=ti.prioritySort,ir=ti.isArray,yu=ti.extend,vu=ti.restrictLongitude;l.Common=ti,u=new function(){var n=navigator.userAgent,f=n.indexOf("MSIE"),s=n.indexOf("Firefox"),v=n.indexOf("Chrome"),nt=s!==-1,g=v!==-1,i=f!==-1,e=parseInt(n.substring(f+5)),d=i&&e===6,tt=i&&e===9,p=i&&e===10,rt=g&&parseInt(n.substring(v+7))>=11,w=nt&&parseInt(n.substring(s+8))>=4,ut=document.documentMode,it=n.indexOf("Gecko"),l=it!==-1,c=n.indexOf("Trident/"),o=parseInt(n.substring(c+8)),y=c>0,h=n.indexOf("BlackBerry")!==-1,u=n.indexOf("AppleWebKit")!==-1,t=navigator.vendor==="Apple Computer, Inc."&&!h,a=t&&n.indexOf("iPhone OS 3_")!==-1,k=u&&n.indexOf("Android")!==-1,b=typeof WinJS!="undefined"&&p,r;this.isWebkit=u,this.cursorHotspot=u?" 10 9":"",this.allowCssAnimations=t,this.useTransform2d=y&&o>=6&&typeof document.createElement("div").style.msTransform!="undefined",this.useTransform3d=t,this.useTransform3dForTranslate=t,this.useImageDisposer=t,this.isIOSBrowser=n.indexOf("iPhone")!==-1,this.safariRenderHack=t?"-webkit-transform:translate3d(0px,0px,0px);":"",this.isIE6=d,this.isIE9=tt,this.isIE10=p,this.useXHR=b,this.isIOS3=a,r=y&&o>=5,this.useFilterReflowWorkaround=r,this.cssZoomAffectsTopLeft=function(){var n=function(){var n=document.createElement("div"),t,i;return n.style.cssText="position:absolute;top:-1000px;left:-1000px;width:100px;zoom:2;",t=document.createElement("div"),t.style.cssText="position:relative;width:10px;left:50%;",n.appendChild(t),document.body.appendChild(n),i=t.offsetLeft,n.parentNode.removeChild(n),i!==50}();return this.cssZoomAffectsTopLeft=function(){return n},n},this.animateOverlayLayers=r||rt||w||t,this.animateShapes=this.animateOverlayLayers&&!a,this.canRenderOpacityAndRotationOnSemiTransparentPngs=!(i&&!r),this.scrollAdjustment=1,this.useOnResize=r,this.autoSizesElementsTooSmall=l||u,this.opacityGlitchAtBrowserEdges=l,this.isIE8OrEarlier=i&&parseInt(n.substring(f+5))<9,this.isIE7OrEarlier=i&&parseInt(n.substring(f+5))<8,this.emulateDblClick=h,this.isShapeEventsSupported=function(){return typeof oi!="undefined"&&oi.isEventsSupported?oi.isEventsSupported():!0},this.allowFocus=!k},l.Quirks=u,b=new function(){function o(){r=null,n.length&&u();var i=n;n=t,t=i,t.sort(e);while(t.length)t.shift()()}function e(n,t){return n[i]-t[i]}function u(){r||(r=f(o))}var f=p.Effects.Animation.requestAnimationFrame,r,n=[],t=[],i=v+"dispatchOrder";this.dispatch=function(t,r){t[i]=r||0;var f=n.length;while(f--)if(n[f]===t)return;n.push(t),u()},this.cancelDispatch=function(i){var r;r=n.length;while(r--)n[r]===i&&n.splice(r,1);r=t.length;while(r--)t[r]===i&&t.splice(r,1)}},l.Dispatcher=b,i.prototype={clone:function(){return new i(this.x,this.y)},toString:function(){return"[Point "+this.x+","+this.y+"]"}},i.clone=function(n){return new i(n.x,n.y)},i.add=function(n,t){return new i(n.x+t.x,n.y+t.y)},i.distance=function(n,t){var r=n.x-t.x,i=n.y-t.y;return Math.sqrt(r*r+i*i)},i.subtract=function(n,t){return new i(n.x-t.x,n.y-t.y)},i.multiply=function(n,t){return new i(n.x*t,n.y*t)},i.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y},s.Point=i,hi={fromTileId:function(n,t){var e=1,i;t&&(e=0);var r="",f=n.x,u=n.y;for(i=0;i<n.levelOfDetail;i++)r=((f&1)+2*(u&1)).toString()+r,f>>=1,u>>=1;return r},toTileId:function(n){var i=0,t=0,u=0,r;if(n!=null&&n.length>0)for(u=n.length,r=0;r<n.length;r++)switch(n.charAt(r)){case"0":i=i*2+0,t=t*2+0;break;case"1":i=i*2+1,t=t*2+0;break;case"2":i=i*2+0,t=t*2+1;break;case"3":i=i*2+1,t=t*2+1}return new it(u,i,t)},wrapX:function(n){var t=1<<n.levelOfDetail;return new it(n.levelOfDetail,(n.x%t+t)%t,n.y)},wrapY:function(n){var t=1<<n.levelOfDetail;return new it(n.levelOfDetail,n.x,(n.y%t+t)%t)},isInBounds:function(n){if(n.x<0||n.y<0)return!1;var t=1<<n.levelOfDetail;return n.x>=t||n.y>=t?!1:!0}},s.QuadKey=hi,dt={ground:0,ellipsoid:1,isValid:function(n){return n===dt.ground||n===dt.ellipsoid}},s.AltitudeReference=dt,y.prototype={clone:function(){return new y(this.latitude,this.longitude,this.altitude,this.altitudeReference)},toString:function(){return"[Location "+this.latitude+","+this.longitude+(this.altitude!==h&&this.altitudeReference!==h?","+this.altitude+","+this.altitudeReference:"")+"]"}},y.normalizeLongitude=function(n){return n<-180||n>180?n-Math.floor((n+180)/360)*360:n},y.areEqual=function(n,t){return n&&t&&n.latitude===t.latitude&&n.longitude===t.longitude&&n.altitude===t.altitude&&n.altitudeReference===t.altitudeReference},s.Location=y,ht.prototype={getNorthwest:function(){return new y(this.getNorth(),this.getWest(),this.center.altitude,this.center.altitudeReference)},getSoutheast:function(){return new y(this.getSouth(),this.getEast(),this.center.altitude,this.center.altitudeReference)},getNorth:function(){return this.center.latitude+this.height/2},getSouth:function(){return this.center.latitude-this.height/2},getWest:function(){return this.width>=360?-180:y.normalizeLongitude(this.center.longitude-this.width/2)},getEast:function(){return this.width>=360?180:y.normalizeLongitude(this.center.longitude+this.width/2)},toString:function(){return"[LocationRect "+this.center.toString()+" "+this.width+","+this.height+"]"},clone:function(){return new ht(this.center.clone(),this.width,this.height)},contains:function(n){var i=Math.abs(this.center.latitude-n.latitude),t=Math.abs(this.center.longitude-n.longitude);return t>180&&(t=360-t),i<=this.height/2&&t<=this.width/2},intersects:function(n){var i=Math.abs(this.center.latitude-n.center.latitude),t=Math.abs(this.center.longitude-n.center.longitude);return t>180&&(t=360-t),i<=this.height/2+n.height/2&&t<=this.width/2+n.width/2}},ht.fromEdges=function(n,t,i,r,u,f){return Math.abs(r-t)>360&&(t=-180,r=180),t=y.normalizeLongitude(t),r=y.normalizeLongitude(r),t>r&&(r+=360),new ht(new y((i+n)/2,(t+r)/2,u,f),r-t,n-i)},ht.fromCorners=function(n,t){return ht.fromEdges(n.latitude,n.longitude,t.latitude,t.longitude,n.altitude,n.altitudeReference)},ht.fromLocations=function(){var i=ir(arguments[0])?arguments[0]:arguments,e,f,r,u,s,c,t,l=i&&i.length?i[0].longitude:0,n,o=i.length;while(o--)n=i[o],isFinite(n.latitude)&&isFinite(n.longitude)&&(e=e===h?n.latitude:Math.max(e,n.latitude),f=f===h?n.latitude:Math.min(f,n.latitude),t=vu(l,n.longitude),u=u===h?t:Math.max(u,t),r=r===h?t:Math.min(r,t),isFinite(n.altitude)&&dt.isValid(n.altitudeReference)&&(c=n.altitude,s=n.altitudeReference));return ht.fromEdges(e,r,f,u,c,s)},ht.fromString=function(n){var f=null,t=n.split(","),e,u,i,r;return t&&t.length==4&&(e=parseFloat(t[0]),u=parseFloat(t[1]),i=parseFloat(t[2]),r=parseFloat(t[3]),f=ht.fromEdges(e,u,i,r)),f},s.LocationRect=ht,pt={road:"r",aerial:"a",birdseye:"be"},s.MapTypeId=pt,rt={visible:0,hidden:1,isValid:function(n){return n===rt.hidden||n===rt.visible}},s.LabelOverlay=rt,si={viewport:0,page:1,control:2,isValid:function(n){return n===si.viewport||n===si.page||n===si.control}},s.PixelReference=si,n=new function(){var t=this,n=v+"events";this.addHandler=function(t,i,r){var f=null,u;return t&&typeof i=="string"&&typeof r=="function"&&(t[n]=t[n]||{},u=t[n][i]||[],t[n][i]=u,f={target:t,eventName:i,handler:r},u.push(f)),f},this.addThrottledHandler=function(n,i,r,u){var f=t.addHandler(n,i,r);return f.throttleInterval=u,f},this.removeHandler=function(i){var e,f,r,u;if(i){e=i.target,f=i.eventName;if(t.hasHandler(e,f)){r=e[n][f],u=r.length;while(u--)i===r[u]&&(i.willBeInvokedBy&&window.clearInterval(i.willBeInvokedBy),r.splice(u,1))}}},this.hasHandler=function(t,i){return t&&t[n]&&t[n][i]&&t[n][i].length},this.invoke=function(i,r,u){var e;if(t.hasHandler(i,r)){var o=new Date,s=i[n][r],c=s.length,f;u=u||{},u.eventName===h&&(u.eventName=r);while(c--)f=s[c],f.handler&&(f.throttleInterval?f.willBeInvokedBy?f.willBeInvokedWithArgs=u:(e=f.throttleInterval-(o-(f.lastInvokedAt||new Date(0))),e>0?(f.willBeInvokedWithArgs=u,f.willBeInvokedBy=window.setTimeout(function(){var n=f;return function(){var t=n.willBeInvokedWithArgs;delete n.willBeInvokedBy,delete n.willBeInvokedWithArgs,n.lastInvokedAt=new Date,n.handler&&n.handler(t)}}(),e)):(f.lastInvokedAt=o,f.handler(u))):f.handler(u))}}},s.Events=n,l.ElementSizeHelper=su,cr={singleByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<2;i++)t="0"+t;return t},twoByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<4;i++)t="0"+t;return t},encodeHtml:function(n){var t,u,i,r;if(n==null)return"";for(u=n.length,i=new Array(u),r=0;r<u;r++)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t==32||t>47&&t<58||t==46||t==44||t==45||t==95?i.push(String.fromCharCode(t)):i.push("&#"+t+";");return i.join("")},encodeUrl:function(n){var t,u,i,r;if(!n)return"";for(u=n.length,i=new Array(u),r=0;r<u;++r)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||t==46||t==45||t==95?i.push(String.fromCharCode(t)):t>127?(i.push("%u"),i.push(cr.twoByteHex(t))):(i.push("%"),i.push(cr.singleByteHex(t)));return i.join("")}},l.IOSec=cr,bi=[],tr.getAllInstances=function(){return bi},tr.getVersion=function(){return t.version},s.Map=tr,l.MapType=li,fi=new function(){function o(i,r,u){b.dispatch(function(){i&&!r&&(r=t);if(r){var e=n[r];e&&(delete n[r],e.timeoutId&&window.clearTimeout(e.timeoutId),e.callback(i,{requestId:r,success:u===200?!0:!1,userData:e.userData,httpStatus:u}),f(e.elScript))}})}function u(t){if(t){var i=n[t];i&&(delete n[t],i.callback(null,{requestId:t,success:!1,userData:i.userData}),f(i.elScript))}}function l(n,t){function i(n,i){o(n,t,i)}Microsoft.Maps.Gimme.Ajax.request_json(n,i)}function i(n,t){l(n,t)}function c(n,t,i){var u,r;return u=s(),u?(r=document.createElement("link"),r.rel=t?"alternate stylesheet":"stylesheet",i&&(r.media=i),r.type="text/css",r.rev="stylesheet",r.href=n,u.appendChild(r),r):void 0}function s(){if(!r){var n=document.getElementsByTagName("head");n.length>0&&(r=n[0])}return r}function h(n,t,i){function r(n){t(n,i)}Microsoft.Maps.Gimme.Ajax.request_json(n,r)}function f(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))}var v=this,e=5e3,r,a=1,t,n={};window.microsoftMapsNetworkCallback=o,this.downloadScript=function(n){return i(n)},this.downloadStyles=function(n,t,i){c(n,t,i)},this.getObjectAsync=function(t,r,f,o,s){var h=s;return h||(h="r"+ ++a,t=t.replace("{jsono}",h)),typeof o=="number"&&o>0||(o=e),n[h]={callback:r,userData:f,elScript:i(t,h),timeoutId:window.setTimeout(function(){u(h)},o)},h},this.getObjectAsyncWithNoJsonso=function(r,f,o,s){t="_logCallbackRequest",typeof s=="number"&&s>0||(s=e),n[t]={callback:f,userData:o,elScript:i(r,t),timeoutId:window.setTimeout(function(){u(t)},s)}},this.isRequestCompleted=function(t){return n[t]?!1:!0},this.abortRequest=function(t){n[t]&&delete n[t]},this.getObjectAsyncCacheFriendly=function(n,t,i){h(n,t,i)}},l.Network=fi,ri={map:"map",pushpin:"pushpin",polyline:"polyline",polygon:"polygon",infobox:"infobox"},ai.prototype={handled:!1,toString:function(){return"[MouseEventArgs]"}},l.MouseEventArgs=ai,l.EventTargetType=ri,pr.prototype={handled:!1,toString:function(){return"[KeyEventArgs]"}},l.KeyEventArgs=pr,at.prototype={clone:function(){return new at(this.a,this.r,this.g,this.b)},getOpacity:function(){return isFinite(this.a)?this.a/255:1},toHex:function(){var i=this.r,t=this.g,n=this.b;return"#"+(i<16?"0":"")+Number(i).toString(16)+(t<16?"0":"")+Number(t).toString(16)+(n<16?"0":"")+Number(n).toString(16)},toString:function(){return"[Color "+this.toHex()+"]"}},at.clone=function(n){return new at(n.a,n.r,n.g,n.b)},at.fromHex=function(n){var i=null,t=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return t&&t.length==4&&(i=new at(255,parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16))),i},s.Color=at,gi.prototype={_visible:!0,_zIndex:null,setOptions:function(t,i){var r=!1;return t&&(typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.zIndex!="undefined"&&(this._zIndex=t.zIndex,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},toString:function(){return"[EntityCollection]"}},s.EntityCollection=gi,ur={standard:"Infobox",mini:"MiniInfobox2",expanded:"Infobox2"},s.InfoboxType=ur,ou.prototype={_width:256,_height:126,_showCloseButton:!0,_offset:new i(0,0),_htmlContent:null,_id:null,_typeName:ur.standard,_visible:!0,_zIndex:null,_options:null,_calculatedSize:null,_clip:!0,_shouldFireEvents:!0,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setCalculatedSize:function(n){this._calculatedSize=n},measure:function(){return this._calculatedSize||{width:0,height:0}},setOptions:function(t,r){if(t){var u=!1;this._options=t,(t.width>0||t.width===null||t.width==="auto")&&(this._width=t.width===null?"auto":t.width,u=!0),(t.height>0||t.height===null)&&(this._height=t.height,u=!0),typeof t.showCloseButton=="boolean"&&(this._showCloseButton=t.showCloseButton,u=!0),t.offset&&(this._offset=i.clone(t.offset),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),typeof t.clip=="boolean"&&(this._clip=t.clip,u=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,u=!0)}return u&&(r===null||!r)&&n.invoke(this,"entitychanged",{entity:this}),u},getWidth:function(){return this._width},getHeight:function(){return this._height},getShowCloseButton:function(){return this._showCloseButton},getOffset:function(){return this._offset},getOptions:function(){return this._options},getShouldFireEvents:function(){return this._shouldFireEvents},setHtmlContent:function(t){var i=this._htmlContent!=t;this._htmlContent=t,this._showPointer=!1,i&&n.invoke(this,"entitychanged",{entity:this})},getHtmlContent:function(){return this._htmlContent},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getClip:function(){return this._clip},toString:function(){return"[InfoboxBase]"}},yu(g,ou),s.Infobox=g,g.prototype._title=null,g.prototype._titleAction=null,g.prototype._description=null,g.prototype._titleClickHandler=null,g.prototype._showPointer=!0,g.prototype._actions=[],g.prototype._pushpin=null,g.prototype._polygon=null,g.prototype.setOptions=function(t,i){if(t){var r=g.superClass.setOptions.call(this,t,!1);(typeof t.title=="string"||t.title===null)&&(this._title=t.title,r=!0),(typeof t.description=="string"||t.description&&t.description.innerHTML)&&(this._description=t.description,r=!0),typeof t.showPointer=="boolean"&&(this._showPointer=t.showPointer,r=!0),(typeof t.actions=="object"||t.actions===null)&&(this._actions=t.actions||[],r=!0),(typeof t.titleAction=="object"||t.titleAction===null)&&(this._titleAction=t.titleAction,r=!0),(typeof t.titleClickHandler=="function"||t.titleClickHandler===null)&&(this._titleClickHandler=t.titleClickHandler,r=!0),t.pushpin&&t.pushpin instanceof s.Pushpin&&(this._pushpin=t.pushpin,this._pushpin.getInfobox()!=this&&this._pushpin.setOptions({infobox:this}),r=!0),t.polygon&&t.polygon instanceof s.Polygon&&(this._polygon=t.polygon,this._polygon.getInfobox()!=this&&this._polygon.setOptions({infobox:this}),r=!0),(this._typeName===ur.mini||typeof this._htmlContent=="string")&&(this._showPointer=!1),r&&(i===null||!i)&&n.invoke(this,"entitychanged",{entity:this})}},g.prototype.getActions=function(){return this._actions},g.prototype.getTitle=function(){return this._title},g.prototype.getTitleAction=function(){return this._titleAction},g.prototype.getTitleClickHandler=function(){return this._titleClickHandler},g.prototype.getDescription=function(){return this._description},g.prototype.getShowPointer=function(){return this._showPointer},g.prototype.getPushpin=function(){return this._pushpin},g.prototype.getPolygon=function(){return this._polygon},g.prototype.getAnchor=function(){var n,t=this._calculatedSize&&this._calculatedSize.height||0,r;return this._showPointer?this._typeName!==ur.standard?(n=10,new i(20+n/2,t)):(n=28,r=38,new i(20+n/2,this.getHeight()+r)):t!==0?new i(0,t):new i(0,this.getHeight()||0)},g.prototype.getOptions=function(){return g.superClass.getOptions.call(this)},g.prototype.toString=function(){return"[Infobox]"},hr={highlighted:2,selected:1,none:0},er.prototype={_width:25,_height:39,_draggable:!1,_anchor:null,_calculatedAnchor:new i(13,39),_htmlContent:null,_text:null,_textOffset:new i(0,5),_id:null,_typeName:null,_visible:!0,_zIndex:null,_useTransform3d:!0,_infobox:null,_state:hr.none,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setOptions:function(t,r){var u=!1;return t&&(typeof t.icon=="string"&&(this._icon=t.icon,u=!0),t.width!==h&&(this._width=t.width>0?t.width:0,u=!0),t.height!==h&&(this._height=t.height>0?t.height:0,u=!0),typeof t.draggable=="boolean"&&(this._draggable=t.draggable,u=!0),t.anchor&&(this._anchor=i.clone(t.anchor),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.text=="string"&&(this._text=t.text,u=!0),t.textOffset&&(this._textOffset=i.clone(t.textOffset),u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),t.infobox&&t.infobox instanceof g&&(this._infobox=t.infobox,this._infobox.getPushpin()!=this&&this._infobox.setOptions({pushpin:this}),u=!0),typeof t.state=="number"&&(this._state=t.state,u=!0),u&&!r&&(this._calculatedAnchor=this._anchor?this._anchor:new i(Math.ceil(this._width/2),this._height),n.invoke(this,"entitychanged",{entity:this}))),u},getIcon:function(){return this._icon},getWidth:function(){return this._width},getHeight:function(){return this._height},getDraggable:function(){return this._draggable},getAnchor:function(){return this._calculatedAnchor},getHtmlContent:function(){return this._htmlContent},getText:function(){return this._text},getTextOffset:function(){return this._textOffset},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getUseTransform3d:function(){return this._useTransform3d},getInfobox:function(){return this._infobox},getState:function(){return this._state},toString:function(){return"[Pushpin]"}},s.EntityState=hr,s.Pushpin=er,nr.prototype={_strokeColor:new at(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_visible:!0,_id:null,_shouldFireEvents:!0,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=at.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getVisible:function(){return this._visible},getId:function(){return this._id},getShouldFireEvents:function(){return this._shouldFireEvents},toString:function(){return"[Polyline]"}},s.Polyline=nr,di.prototype={_strokeColor:new at(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_fillColor:new at(255,0,0,255),_visible:!0,_infobox:null,_shouldFireEvents:!0,_state:hr.none,_id:null,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=at.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),t.fillColor&&(this._fillColor=at.clone(t.fillColor),r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),t.infobox&&t.infobox instanceof s.Infobox&&(this._infobox=t.infobox,this._infobox.getPolygon()!=this&&this._infobox.setOptions({polygon:this}),r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),typeof t.state=="number"&&(this._state=t.state,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getFillColor:function(){return this._fillColor},getVisible:function(){return this._visible},getInfobox:function(){return this._infobox},getShouldFireEvents:function(){return this._shouldFireEvents},getState:function(){return this._state},toString:function(){return"[Polygon]"}},s.Polygon=di,ar={show:"s",hide:"h",auto:"a"},sr.prototype={toString:function(){return"[TileLayer]"}},s.AnimationVisibility=ar,s.TileLayer=sr,kr.prototype={toString:function(){return"[TileSource]"}},s.TileSource=kr,s.Globals.disableGeoLocation||(fu=function(n){function w(n,i,r){if(t&&r===t&&n&&n.coords){var u=new y(n.coords.latitude,n.coords.longitude,n.coords.altitude);(!i||i&&i.showAccuracyCircle!=!1)&&f.addAccuracyCircle(u,n.coords.accuracy,a,{displayOnMap:!0}),(!i||i&&i.updateMapView!=!1)&&l(n),i&&i.successCallback&&i.successCallback({center:u,position:n})}t=0}function h(n,i,r){t&&r===t&&i.errorCallback&&i.errorCallback({internalError:n,errorCode:n.code}),t=0}function l(t){if(t)if(t.coords.accuracy<300)n.setView({center:new y(t.coords.latitude,t.coords.longitude,t.coords.altitude),zoom:16});else{var o=e(t.coords.latitude,t.coords.longitude,0,t.coords.accuracy),u=(o.latitude-t.coords.latitude)*2,i=n.getHeight(),r=n.getWidth(),f=i>r?i:r;n.setView({bounds:new ht(new y(t.coords.latitude,t.coords.longitude,t.coords.altitude),u,u),padding:f/3})}}function e(n,t,u,f){var a=c,k=a.degreesToRadians(u),p=(1-r)*Math.tan(a.degreesToRadians(n)),it=Math.cos(k),et=Math.sin(k),v=1/Math.sqrt(1+p*p),rt=v*et,ht=rt*rt,tt=1-ht,ut=Math.atan2(p,Math.cos(k)),l=tt*((o*o-i*i)/(i*i)),st=1+l/16384*(4096+l*(-768+l*(320-175*l))),ft=l/1024*(256+l*(-128+l*(74-47*l))),e=f/(i*st),ct=2*Math.PI,s=Math.sin(e),nt=2*ut+e,h=Math.cos(nt),d;while(Math.abs(e-ct)>1e-12){nt=2*ut+e,h=Math.cos(nt),d=h*h,s=Math.sin(e);var wt=Math.cos(e)*(-1+2*d),pt=ft/6*h*(-3+4*s*s)*(-3+4*d),kt=ft*s*(h+ft/4*(wt-pt));ct=e,e=f/(i*st)+kt}h=Math.cos(2*ut+e),s=Math.sin(e);var w=Math.cos(e),b=p*v,ot=b*s-v*w*it,bt=Math.atan2(b*w+v*s*it,(1-r)*Math.sqrt(ht+ot*ot)),yt=Math.atan2(s*et,v*w-b*s*it),g=r/16*tt*(4+r*(4-3*tt)),vt=e+g*s*(h+g*w*(-1+2*h*h)),at=yt-(1-g)*r*rt*vt,lt=(a.degreesToRadians(t)+at+3*Math.PI)%(2*Math.PI)-Math.PI;return new y(a.radiansToDegrees(bt),a.radiansToDegrees(lt))}var u=null,a=128,p=new at(150,0,163,239),v=new at(25,0,163,239),t=0,s=navigator&&navigator.geolocation,f=this,o=nt.earthRadiusInMeters,i=nt.earthMinorAxisRadiusInMeters,r=nt.flatteningOfEllipsoidWGS84;this.getCurrentPosition=function(n){f.removeAccuracyCircle();if(s&&t===0)t=Math.random(),navigator.geolocation.getCurrentPosition(function(i){w(i,n,t)},function(i){h(i,n,t)},n);else if(n&&n.errorCallback){var i=s?4:5;n.errorCallback({internalError:null,errorCode:i})}},this.cancelCurrentRequest=function(){t=0},this.addAccuracyCircle=function(t,i,r,o){var c=null,s,d,l,w,a;if(t&&r&&i&&t instanceof y&&vi(r)&&vi(i)){var h=[],b=t.latitude,k=t.longitude;for(s=0;s<r;s++)d=s/r*360,l=e(b,k,d,i),h.push(l);w=e(b,k,0,i),h.push(w),a=o.polygonOptions||{fillColor:v,strokeColor:p},c=new di(h,a),o&&o.displayOnMap!=!1&&(f.removeAccuracyCircle(),u=c,n.entities.push(u))}return c},this.removeAccuracyCircle=function(){u&&(n.entities.remove(u),u=null)}},s.GeoLocationProvider=fu),l.DelayMap=eu,tt=new function(){function i(t,r,u){var e,o,s,f;e=t[r];if(e){o=e.length;while(o--)s=e[o],f=n[s],f&&(f[u]=[],i(f,r,u))}}function f(t,u){var f=n[t],v,o,y,a,e,h,c;if(f){v=f.downloadScript,f.downloadScript=!1,i(f,"suppliesCssFor","styleUrls"),i(f,"suppliesJsFor","scriptUrls");if(f.loaded)r(t,u);else{if(u)for(f.queue.push(u),e=0;e<f.scriptUrls.length;e++)for(o in u)typeof u[o]=="string"&&(y=new RegExp(o+"=[^&]+"),f.scriptUrls[e]=f.scriptUrls[e].replace(y,o+"="+u[o]));if(v&&f.loadOverrideCallback(t,u)!==!0){for(s.InternalNamespaceForDelay=l,a=f.scriptUrls,e=0;e<a.length;e++)h=a[e],h&&(f.jsonDownloadCallback?fi.getObjectAsync(h,f.jsonDownloadCallback):fi.downloadScript(h));for(c=f.styleUrls,e=0;e<c.length;e++)c[e]&&fi.downloadStyles(c[e])}}}}function u(n,t){var i=n.length;while(i--)n[i].indexOf("/")==-1&&(n[i]=t+n[i])}function r(n,t){typeof t.callback=="function"?t.callback(n):t.obj&&t.obj[t.name].apply(t.obj,t.args)}var n={};this.register=function(i,r,f,e){var o=f?f:{},s=n[i]={key:i,downloadScript:!0,loaded:!1,queue:[],scriptUrls:(o.extraScripts||[]).concat(r),styleUrls:o.styleUrls?o.styleUrls:[],jsonDownloadCallback:typeof o.jsonDownloadCallback=="function"?o.jsonDownloadCallback:null,loadOverrideCallback:typeof o.loadOverrideCallback=="function"?o.loadOverrideCallback:function(){return!1},suppliesCssFor:o.suppliesCssFor,suppliesJsFor:o.suppliesJsFor};e!==!1&&(u(s.scriptUrls,t.jsPath),u(s.styleUrls,t.cssPath))},this.add=function(n,t,i,r){f(n,t?{obj:t,name:i,args:r}:null)},this.load=function(n,t){PRF.start(n),f(n,t||{})},this.getRegistration=function(t){return n[t]},this.done=function(t){var f=n[t],e,i,h,u,o;if(f){for(f.loaded=!0,e=f.queue,i=0;i<e.length;i++)h=e[i],r(t,h);u=0;for(o in n)n.hasOwnProperty(o)&&++u;u===0&&delete s.InternalNamespaceForDelay}}},s.loadModule=tt.load,s.registerModule=function(n,t,i){tt.register(n,t,i,!1)},s.moduleLoaded=tt.done,l.Dynamic=tt,s.Globals.disableDirections===!1&&tt.register("Microsoft.Maps.Directions","veapiDirections.js",{styleUrls:["mapDirections.css"]}),s.Globals.disableStreetside===!1&&tt.register("Microsoft.Maps.Streetside","veapistreetside.js",{styleUrls:["mapstreetside.css"]}),s.Globals.disableVenueMaps===!1&&tt.register("Microsoft.Maps.VenueMaps","veapiVenueMaps.js",{styleUrls:["venuemaps.css"]}),s.Globals.disableMicroPOI===!1&&tt.register("Microsoft.Maps.MicroPOI","veapiMicroPOI.js",{styleUrls:["veapiMicroPOI.css"]}),s.Globals.disableAnalytics===!1&&tt.register("Microsoft.Maps.Analytics","veapiAnalytics.js"),s.Globals.disableSearch===!1&&tt.register("Microsoft.Maps.Search","veapiSearch.js"),s.Globals.disableTasks===!1&&tt.register("Microsoft.Maps.Tasks","veapiTasks.js");if(s.Globals.jsonTimeStamp){var br="en-us",wr="US",lr="http://ecn.dev.virtualearth.net/mapcontrol/mapconfiguration.ashx?name=wwa&v=7.0.1wwa&culture={culture}&homeRegion={homeRegion}";u.useXHR&&(br=Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.languages[0],wr=Windows.System.UserProfile.GlobalizationPreferences.homeGeographicRegion),ki.UpdateCulture(br,wr),lr=lr.replace("{culture}",br).replace("{homeRegion}",wr),tt.register("Microsoft.Maps.Map",lr,{jsonDownloadCallback:nu.parse,loadOverrideCallback:nu.tryCachedGlobals})}tt.register("Microsoft.Maps.Traffic","veapiTraffic.js",{styleUrls:["traffic.css"]}),tt.register("Microsoft.Maps.Overlays.Style","veapiOverlayStyleV2.js",{styleUrls:["veapiOverlayStyleV2.css"],version:"v2"}),tt.register("Microsoft.Maps.Themes.BingTheme","veapiBingTheme.js",{styleUrls:["veapiBingTheme.css"],suppliesCssFor:["Microsoft.Maps.Overlays"]}),tt.register("Microsoft.Maps.AdvancedShapes","veapiAdvancedShapes.js"),c={LOGE2:Math.log(2),ILOGE2:1/Math.log(2),degreesPerRadian:180/Math.PI,radiansPerDegree:Math.PI/180,log2:function(n){return Math.log(n)/c.LOGE2},ceilLog2:function(n){return Math.ceil(Math.log(n)*c.ILOGE2)},lerpDouble:function(n,t,i){return n+i*(t-n)},normalizeDegrees:function(n){return(n%360+360)%360},distanceDegrees:function(n,t){var i=c.normalizeDegrees(n-t);return Math.min(i,360-i)},lerpAngle:function(n,t,i){var r=c.normalizeDegrees(n-t);return r>180&&(r=r-360),t+(1-i)*r},degreesToRadians:function(n){return n*c.radiansPerDegree},radiansToDegrees:function(n){return n*c.degreesPerRadian}},l.VectorMath=c,r.prototype={normalize:function(){var t=this.getLength(),n;return t===0?point:(n=1/t,new r(this.x*n,this.y*n,this.z*n))},isZero:function(){return this.x===0&&this.y===0&&this.z===0},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},toPoint:function(){return new i(this.x,this.y)},clone:function(){return new r(this.x,this.y,this.z)},toString:function(){return"[Point3D "+this.x+","+this.y+","+this.z+"]"}},r.add=function(n,t){return new r(n.x+t.x,n.y+t.y,n.z+t.z)},r.subtract=function(n,t){return new r(n.x-t.x,n.y-t.y,n.z-t.z)},r.multiply=function(n,t){return new r(t*n.x,t*n.y,t*n.z)},r.dot=function(n,t){return n.x*t.x+n.y*t.y+n.z*t.z},r.cross=function(n,t){return new r(n.y*t.z-n.z*t.y,n.z*t.x-n.x*t.z,n.x*t.y-n.y*t.x)},r.distanceSquared=function(n,t){var u=n.x-t.x,r=n.y-t.y,i=n.z-t.z;return u*u+r*r+i*i},r.lerp=function(n,t,i){return new r(n.x+(t.x-n.x)*i,n.y+(t.y-n.y)*i,n.z+(t.z-n.z)*i)},r.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y&&n.z===t.z},r.areAlmostEqual=function(n,t){return n&&t&&Math.abs(n.x-t.x)<bt&&Math.abs(n.y-t.y)<bt&&Math.abs(n.z-t.z)<bt},l.Point3D=r,ct.prototype={clone:function(){return new ct(this.width,this.height)},toString:function(){return"[Size "+this.width+","+this.height+"]"}},ct.clone=function(n){return new ct(n.width,n.height)},ct.areEqual=function(n,t){return n&&t&&n.width===t.width&&n.height===t.height},l.Size=ct,vt.prototype={getRight:function(){return this.x+this.width},getBottom:function(){return this.y+this.height},getCenter:function(){return new i(this.x+this.width/2,this.y+this.height/2)},contains:function(n){return n.x>=this.x&&n.y>=this.y&&n.x<=this.getRight()&&n.y<=this.getBottom()},clone:function(){return new vt(this.x,this.y,this.width,this.height)},toString:function(){return"[Rect "+this.x+","+this.y+" "+this.width+","+this.height+"]"}},vt.union=function(){var u=ir(arguments[0])?arguments[0]:arguments,t=u[0],r=t.x,i=t.y,e=t.x+(t.width?t.width:0),f=t.y+(t.height?t.height:0),o=u.length,n;while(o--)n=u[o],r=Math.min(r,n.x),i=Math.min(i,n.y),e=Math.max(e,n.x+(n.width?n.width:0)),f=Math.max(f,n.y+(n.height?n.height:0));return new vt(r,i,e-r,f-i)},vt.intersect=function(n,t){return!(n.getRight()<t.x||t.getRight()<n.x||n.getBottom()<t.y||t.getBottom()<n.y)},vt.areEqual=function(n,t){return},l.Rect=vt,yt.prototype={transform:function(n){return new i(n.x*this.m11+n.y*this.m21+this.offsetX,n.x*this.m12+n.y*this.m22+this.offsetY)},invert:function(){var n=this.m11*this.m22-this.m12*this.m21;if(n===0)throw"matrix cannot be inverted";return new yt(this.m22/n,-1*this.m12/n,-1*this.m21/n,this.m11/n,(this.offsetY*this.m21-this.offsetX*this.m22)/n,(this.offsetX*this.m12-this.offsetY*this.m11)/n)},clone:function(){return new yt(this.m11,this.m12,this.m21,this.m22,this.offsetX,this.offsetY)},toString:function(){return"[Matrix "+this.m11+", "+this.m12+", "+this.m21+", "+this.m22+", "+this.offsetX+", "+this.offsetY+"]"}},yt.multiply=function(n,t){return new yt(n.m11*t.m11+n.m12*t.m21,n.m11*t.m12+n.m12*t.m22,n.m21*t.m11+n.m22*t.m21,n.m21*t.m12+n.m22*t.m22,n.offsetX*t.m11+n.offsetY*t.m21+t.offsetX,n.offsetX*t.m12+n.offsetY*t.m22+t.offsetY)},yt.unitToPoints=function(n,t,i){return new yt(t.x-n.x,t.y-n.y,i.x-n.x,i.y-n.y,n.x,n.y)},yt.conversion=function(n,t,i,r,u,f){var o=yt.unitToPoints(n,t,i).invert(),e=yt.unitToPoints(r,u,f);return yt.multiply(o,e)},l.Matrix=yt,e.prototype={multiplyBy:function(n){var l=this.m11,a=this.m12,h=this.m13,c=this.m14,p=this.m21,w=this.m22,v=this.m23,y=this.m24,r=this.m31,u=this.m32,t=this.m33,i=this.m34,o=this.offsetX,s=this.offsetY,f=this.offsetZ,e=this.m44;this.m11=l*n.m11+a*n.m21+h*n.m31+c*n.offsetX,this.m12=l*n.m12+a*n.m22+h*n.m32+c*n.offsetY,this.m13=l*n.m13+a*n.m23+h*n.m33+c*n.offsetZ,this.m14=l*n.m14+a*n.m24+h*n.m34+c*n.m44,this.m21=p*n.m11+w*n.m21+v*n.m31+y*n.offsetX,this.m22=p*n.m12+w*n.m22+v*n.m32+y*n.offsetY,this.m23=p*n.m13+w*n.m23+v*n.m33+y*n.offsetZ,this.m24=p*n.m14+w*n.m24+v*n.m34+y*n.m44,this.m31=r*n.m11+u*n.m21+t*n.m31+i*n.offsetX,this.m32=r*n.m12+u*n.m22+t*n.m32+i*n.offsetY,this.m33=r*n.m13+u*n.m23+t*n.m33+i*n.offsetZ,this.m34=r*n.m14+u*n.m24+t*n.m34+i*n.m44,this.offsetX=o*n.m11+s*n.m21+f*n.m31+e*n.offsetX,this.offsetY=o*n.m12+s*n.m22+f*n.m32+e*n.offsetY,this.offsetZ=o*n.m13+s*n.m23+f*n.m33+e*n.offsetZ,this.m44=o*n.m14+s*n.m24+f*n.m34+e*n.m44},transform:function(n,t){var u=n.x*this.m11+n.y*this.m21+this.offsetX,e=n.x*this.m12+n.y*this.m22+this.offsetY,f=n.x*this.m13+n.y*this.m23+this.offsetZ,i;return n.z&&(u+=n.z*this.m31,e+=n.z*this.m32,f+=n.z*this.m33),(this.m14!==0||this.m24!==0||this.m34!==0||this.m44!==1)&&(i=n.x*this.m14+n.y*this.m24+(n.z?n.z:0)*this.m34+this.m44,t&&(i=Math.max(t,i)),u/=i,e/=i,f/=i),new r(u,e,f)},invert:function(){var c=this.m11,p=this.m12,w=this.m13,v=this.m14,h=this.m21,a=this.m22,b=this.m23,y=this.m24,l=this.m31,g=this.m32,d=this.m33,k=this.m34,s=this.offsetX,it=this.offsetY,tt=this.offsetZ,nt=this.m44,r=w*y-b*v,i=w*k-d*v,t=w*nt-tt*v,o=b*k-d*y,f=b*nt-tt*y,u=d*nt-tt*k,et=a*i-g*r-p*o,ut=p*f-a*t+it*r,ot=g*t-it*i-p*u,ft=a*u-g*f+it*o,rt=s*et+l*ut+h*ot+c*ft;if(rt===0||!isFinite(rt))throw"InvalidOperation: Matrix3D.invert";var wt=c*o-h*i+l*r,lt=h*t-s*r-c*f,pt=c*u-l*t+s*i,yt=l*f-s*o-h*u;r=c*a-h*p,i=c*g-l*p,t=c*it-s*p,o=h*g-l*a,f=h*it-s*a,u=l*it-s*g;var dt=w*o-b*i+d*r,kt=b*t-tt*r-w*f,bt=w*u-d*t+tt*i,ct=d*f-tt*o-b*u,ht=y*i-k*r-v*o,st=v*f-y*t+nt*r,vt=k*t-nt*i-v*u,at=y*u-k*f+nt*o,n=1/rt;return new e(ft*n,ot*n,ut*n,et*n,yt*n,pt*n,lt*n,wt*n,at*n,vt*n,st*n,ht*n,ct*n,bt*n,kt*n,dt*n)},projectOnPlane:function(n){var t=this,o=n.a*t.m11+n.b*t.m12+n.c*t.m13-n.d*t.m14,f=n.a*t.m21+n.b*t.m22+n.c*t.m23-n.d*t.m24,r=n.a*t.m31+n.b*t.m32+n.c*t.m33-n.d*t.m34,s=n.a*t.offsetX+n.b*t.offsetY+n.c*t.offsetZ-n.d*t.m44,i,u;if(r===0)throw"InvalidOperation: Matrix3D.projectOnPlane";return i=-1/r,u=new e(1,0,o*i,0,0,1,f*i,0,0,0,1,0,0,0,s*i,1),e.multiply(u,this)},clone:function(){return new e(this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.offsetX,this.offsetY,this.offsetZ,this.m44)},toString:function(){return"[Matrix3D "+this.m11+","+this.m12+","+this.m13+","+this.m14+", "+this.m21+","+this.m22+","+this.m23+","+this.m24+", "+this.m31+","+this.m32+","+this.m33+","+this.m34+", "+this.offsetX+","+this.offsetY+","+this.offsetZ+","+this.m44+"]"}},e.multiply=function(){for(var u=arguments.length,r=arguments[0].clone(),i=1;i<u;i++)r.multiplyBy(arguments[i]);return r},e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},e.translation=function(n){var t=arguments.length==3;return new e(1,0,0,0,0,1,0,0,0,0,1,0,t?arguments[0]:n.x,t?arguments[1]:n.y,t?arguments[2]:n.z,1)},e.scaling=function(n,t,i){var r=new e(n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1);return arguments.length==3&&(r.m22=t,r.m33=i),r},e.rotationX=function(n){var r=n*c.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(1,0,0,0,0,t,i,0,0,-i,t,0,0,0,0,1)},e.rotationY=function(n){var r=n*c.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(t,0,-i,0,0,1,0,0,i,0,t,0,0,0,0,1)},e.rotationZ=function(n){var r=n*c.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(t,i,0,0,-i,t,0,0,0,0,1,0,0,0,0,1)},l.Matrix3D=e,ui.prototype={intersectWithLine:function(n,t){var i=r.subtract(t,n),f=this.d-this.a*n.x-this.b*n.y-this.c*n.z,u=this.a*i.x+this.b*i.y+this.c*i.z;if(u===0)throw"InvalidOperation: Plane3D.intersectWithLine";return r.add(n,r.multiply(i,f/u))},clone:function(){return new ui(this.a,this.b,this.c,this.d)},toString:function(){return"[Plane3D]"}},ui.fromPoints=function(n,t,i){var f=r.subtract(i,t),e=r.subtract(t,n),u=r.cross(f,e);return u=u.normalize(),ui.fromNormal(n,u)},ui.fromNormal=function(n,t){return new ui(t.x,t.y,t.z,r.dot(t,n))},ui.areEqual=function(n,t){return n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d},l.Plane3D=ui,ni.prototype={dot:function(n){return this.x*n.x+this.y*n.y},perp:function(){return new ni(this.y,-this.x)},normalize:function(){var t,n;return t=this.length(),t<MathHelper.zeroTolerance?new ni(0,0):(n=1/t,new ni(this.x*n,this.y*n))},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},add:function(n){return new ni(this.x+n.x,this.y+n.y)},subtract:function(n){return new ni(this.x-n.x,this.y-n.y)},multiplyScalar:function(n){return new ni(this.x*n,this.y*n)},equals:function(n){return this.x===n.x&&this.y===n.y},toString:function(){return"["+this.x+", "+this.y+"]"}},l.Vector2=ni,nt={earthRadiusInMeters:6378137,earthCircumferenceInMeters:12756274*Math.PI,northUpHeading:0,eastUpHeading:90,southUpHeading:180,westUpHeading:270,enhancedBirdseyePitch:-c.degreesPerRadian*Math.asin(180/256),earthMinorAxisRadiusInMeters:6356752.3142,flatteningOfEllipsoidWGS84:1/298.2572235631,snapToCardinalHeading:function(n){var t=Math.round(n/90);return t=(t%4+4)%4,t*90},locationRectToMercatorZoom:function(n,i){var f=i.width/360,u=Math.abs(a.latitudeToY(i.getNorth())-a.latitudeToY(i.getSouth())),r=Math.min(n.width/(t.zoomOriginWidth*f),n.height/(t.zoomOriginWidth*u));return c.log2(r)},getMercatorCenter:function(n){var t=n.center;return new y(a.yToLatitude((a.latitudeToY(n.getNorth())+a.latitudeToY(n.getSouth()))/2),t.longitude,t.altitude,t.altitudeReference)},getMercatorFootprint:function(n,t){var f=t.width/2,u=t.height/2,r=[new i(-f,-u),new i(f,-u),new i(f,u),new i(-f,u)],h=n.getViewportToWorld(),s=n.getCrs(),e,o=r.length;while(o--)e=h.transform(r[o]),r[o]=s===a?e:a.fromLocation(s.toLocation(e));return r}},l.MapMath=nt,a={latitudeLimit:85.051128,invFourPi:1/(4*Math.PI),unitsPerMeterAtEquator:1/nt.earthCircumferenceInMeters,toLocation:function(n){var t=a.yToLatitude(n.y);return new y(t,(n.x-.5)*360,n.z?a.unitsToMetersAtLatitude(t,n.z):0,dt.ellipsoid)},fromLocation:function(n){return new r(n.longitude/360+.5,a.latitudeToY(n.latitude),a.metersToUnitsAtLatitude(n.latitude,n.altitude))},wrap:function(n,t){var i=n.x,u=t?t.x:.5;return new r(i<u-.5||i>u+.5?i-Math.floor(i-u+.5):i,n.y,n.z)},getUpVector:function(){return new r(0,0,1)},getNadirMatrix:function(n){return new e(1,0,0,0,0,1,0,0,0,0,-1,0,-n.x,-n.y,n.z,1)},unitsToMeters:function(n,t){var i=a.yToLatitude(n.y);return a.unitsToMetersAtLatitude(i,t)},metersToUnits:function(n,t){var i=a.yToLatitude(n.y);return a.metersToUnitsAtLatitude(i,t)},changeAltitude:function(n,t){var u=a.yToLatitude(n.y),i=a.metersToUnitsAtLatitude(u,t);return new r(n.x,n.y,i)},unitsToMetersAtLatitude:function(n,t){return t===0?0:t*Math.cos(n*c.radiansPerDegree)/a.unitsPerMeterAtEquator},metersToUnitsAtLatitude:function(n,t){return t===0?0:t*a.unitsPerMeterAtEquator/Math.cos(n*c.radiansPerDegree)},yToLatitude:function(n){return 90-2*Math.atan(Math.exp((n*2-1)*Math.PI))*c.degreesPerRadian},latitudeToY:function(n){if(n>=a.latitudeLimit)return 0;if(n<=-a.latitudeLimit)return 1;var t=Math.sin(n*c.radiansPerDegree);return.5-Math.log((1+t)/(1-t))*this.invFourPi}},l.MercatorCube=a,fr=new function(){var t=1/298.257222101,i=t*(2-t),f=1/(1-i),n=nt.earthRadiusInMeters,u=new r(0,0,-n);this.toLocation=function(r){var w=r.x,p=r.y,o=r.z,b,d,e,v,a,s,l=Math.sqrt(w*w+p*p),f=o,u,h,k;d=Math.atan2(p,w),u=l*(1-t),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),v=f*h,a=u*h,s=n,e=l>1?l/a-s:o>0?o-n*(1-t):-o-n*(1-t),k=3;while(k--)u=l*(1-i*s/(s+e)),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),v=f*h,a=u*h,s=n/Math.sqrt(1-i*v*v),e=l>1?l/a-s:o>0?o-n*(1-t):-o-n*(1-t);return new y(b*c.degreesPerRadian,d*c.degreesPerRadian,e,dt.ellipsoid)},this.fromLocation=function(t){var o=t.latitude*c.radiansPerDegree,h=t.longitude*c.radiansPerDegree,e=t.altitude,u=Math.sin(o),s=Math.cos(o),l=Math.sin(h),a=Math.cos(h),f=n/Math.sqrt(1-i*u*u);return new r((f+e)*s*a,(f+e)*s*l,(f*(1-i)+e)*u)},this.wrap=function(){return wrap.clone()},this.getUpVector=function(n){return new r(n.x,n.y,n.z*f).normalize()},this.getNadirMatrix=function(n){var t,f=this.getUpVector(n),o=r.multiply(f,-1),s=r.cross(f,r.subtract(u,n)),i;return t=s.isZero()?new r(1,0,0):r.cross(s,f).normalize(),i=r.cross(f,t),e.multiply(e.translation(-n.x,-n.y,-n.z),new e(i.x,t.x,o.x,0,i.y,t.y,o.y,0,i.z,t.z,o.z,0,0,0,0,1))},this.unitsToMeters=function(n,t){return t},this.metersToUnits=function(n,t){return t},this.changeAltitude=function(n,t){var i=self.toLocation(n);return i.altitude=t,self.fromLocation(i)}},it.prototype={getParent:function(){return new it(this.levelOfDetail-1,Math.floor(this.x/2),Math.floor(this.y/2))},clone:function(){return new it(this.levelOfDetail,this.x,this.y)},getSibling:function(n,t){var r=1<<this.levelOfDetail,u=this.x+n,i;return u<0?u+=r:u<r||(u-=r),i=this.y+t,i<0?i=0:i<r||(i=r-1),new it(this.levelOfDetail,u,i)},toString:function(){return"[TileId "+this.levelOfDetail+" "+this.x+","+this.y+"]"}},it.areEqual=function(n,t){return n&&t&&n.levelOfDetail===t.levelOfDetail&&n.x===t.x&&n.y===t.y},l.TileId=it,f.prototype={convertCoordinateReferenceSystem:function(n){if(n!==this.getCrs()){var t=n.fromLocation(this.getCrs().toLocation(this.getLookAt()));return new f(n,t,n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),this.getWidth())),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse()<bt?0:1/n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),1/this.getDistanceInverse())),h,h,this.getZoomOriginWidth())}return this.clone()},clone:function(){return new f(this.getCrs(),this.getLookAt().clone(),this.getWidth(),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse(),this.getZoomDelta(),this.getPerspectiveOrigin().clone(),this.getZoomOriginWidth())},toString:function(){return"[MapCamera]"}},f.smallWidthRatioDiff=.1,f.smallAngle=1,f.smallPixelDistance=2,f.simpleGround=new ui(0,0,1,0),f.simpleWorldToFrustumNoZ=e.identity(),f.fromDirectionVector=function(n,t,i,u,o,s){var y,a;var p=n.getNadirMatrix(t),l=p.transform(r.add(t,u)).normalize(),h=0;(l.x!==0||l.y!==0)&&(directionXY=new r(l.x,l.y,0).normalize(),h=Math.acos(r.dot(directionXY,new r(0,-1,0)))*c.degreesPerRadian,directionXY.x<0&&(h=360-h));var w=(Math.PI/2-Math.acos(r.dot(l,new r(0,0,-1))))*c.degreesPerRadian,a=0,b=e.multiply(p,e.rotationZ(-h),e.rotationX(-(w+90))),v=b.transform(r.add(t,o));return(v.x!=0||v.y!=0)&&(y=new r(v.x,v.y,0).normalize(),a=Math.acos(r.dot(y,new r(0,-1,0)))*c.degreesPerRadian,y.x<0&&(a=360-a)),new f(n,t,i,h,w,a,s)},f.mercatorZoomToWidth=function(n,t,i){var r=1/Math.pow(2,n);return t===a?r:t.metersToUnits(i,a.unitsToMeters(a.fromLocation(t.toLocation(i)),r))},f.widthToMercatorZoom=function(n,t,i){var r=t===a?n:a.metersToUnits(a.fromLocation(t.ToLocation(i)),t.unitsToMeters(i,n));return c.log2(1/r)},f.snapSmallDifferences=function(n,i){n.getCrs()!==i.getCrs()&&(n=i.convertCoordinateReferenceSystem(i.getCrs()));var s=Math.max(n.getWidth(),i.getWidth())/t.zoomOriginWidth,e=s*f.smallPixelDistance,u=e*e,o=new f(n.getCrs(),r.distanceSquared(i.getLookAt(),n.getLookAt())>u?n.getLookAt():i.getLookAt(),Math.abs(i.getWidth()/n.getWidth()-1)>f.smallWidthRatioDiff?n.getWidth():i.getWidth(),Math.abs(n.getHeading()-i.getHeading())>f.smallAngle?n.getHeading():i.getHeading(),Math.abs(n.getPitch()-i.getPitch())>f.smallAngle?n.getPitch():i.getPitch(),Math.abs(n.getRoll()-i.getRoll())>f.smallAngle?n.getRoll():i.getRoll(),Math.abs(n.getDistanceInverse()-i.getDistanceInverse())>bt?n.getDistanceInverse():i.getDistanceInverse(),Math.abs(n.getZoomDelta()-i.getZoomDelta())>f.smallWidthRatioDiff?n.getZoomDelta():i.getZoomDelta(),r.distanceSquared(i.getPerspectiveOrigin(),n.getPerspectiveOrigin())>u?n.getPerspectiveOrigin():i.getPerspectiveOrigin(),n.getZoomOriginWidth());return f.areEqual(o,n)?n:o},f.lerp=function(n,t,i){var u=i,e=t.getWidth()/n.getWidth();return Math.abs(e-1)>f.smallWidthRatioDiff&&(u=(Math.pow(e,i)-1)/(e-1)),new f(t.getCrs(),r.lerp(n.getLookAt(),t.getLookAt(),u),c.lerpDouble(n.getWidth(),t.getWidth(),u),c.lerpAngle(n.getHeading(),t.getHeading(),i),c.lerpAngle(n.getPitch(),t.getPitch(),i),c.lerpAngle(n.getRoll(),t.getRoll(),i),c.lerpDouble(n.getDistanceInverse(),t.getDistanceInverse(),i),c.lerpDouble(n.getZoomDelta(),t.getZoomDelta(),i),r.lerp(n.getPerspectiveOrigin(),t.getPerspectiveOrigin(),u),n.getZoomOriginWidth())},f.areAligned=function(n,t){return n&&t&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()},f.areEqual=function(n,t){return n&&t&&(n===t||r.areEqual(n.getLookAt(),t.getLookAt())&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()&&n.getZoomDelta()===t.getZoomDelta()&&r.areEqual(n.getPerspectiveOrigin(),t.getPerspectiveOrigin()))},l.MapCamera=f,ut={mercator:new f(a,new r(.5,.5,0),1),enhancedBirdseyeNorthUp:new f(a,new r(.5,.5,0),1,nt.northUpHeading,nt.enhancedBirdseyePitch),enhancedBirdseyeEastUp:new f(a,new r(.5,.5,0),1,nt.eastUpHeading,nt.enhancedBirdseyePitch),enhancedBirdseyeSouthUp:new f(a,new r(.5,.5,0),1,nt.southUpHeading,nt.enhancedBirdseyePitch),enhancedBirdseyeWestUp:new f(a,new r(.5,.5,0),1,nt.westUpHeading,nt.enhancedBirdseyePitch)},l.StandardMapCameras=ut,l.MemoryCache=ci,d={tileIdToCacheKey:function(n){return n.levelOfDetail+"~"+n.x+"~"+n.y},latLonToMercatorXY:function(n,t){var r=t/360+.5;return r-=Math.floor(r),new i(r,a.latitudeToY(n))},mercatorXYToTileId:function(n,t){var i=1<<t;return new it(t,Math.floor(n.x*i),Math.floor(n.y*i))},mercatorXYToCacheKey:function(n,t){return d.tileIdToCacheKey(d.mercatorXYToTileId(n,t))},latLonToTileId:function(n,t,i){var r=d.latLonToMercatorXY(n,t);return d.mercatorXYToTileId(r,i)},latLonToCacheKey:function(n,t,i){return d.tileIdToCacheKey(d.latLonToTileId(n,t,i))},tileIdToMercatorXY:function(n){var t=1<<n.levelOfDetail;return new i((n.x+.5)/t,(n.y+.5)/t)},tileIdToLocation:function(n){var t=d.tileIdToMercatorXY(n);return a.toLocation(t)},normalizeMercatorBounds:function(n){n.width<1?n.x-=Math.floor(n.x):(n.x=0,n.width=1);var t=Math.min(n.getBottom(),1);n.y=Math.max(n.y,0),n.height=t-n.y}},l.SpatialCache=d,et=new function(){function o(){var o,u,y;if(f.length&&a<1&&k){var c=f.shift(),t=c.topLeft,i=c.bottomRight,l=!0,g=t.x,b=i.x,tt=t.y,nt=i.y,r=new it(t.levelOfDetail,0,0);for(o=tt;o<=nt;o++){for(u=g;u<=b;u++){r.x=u,r.y=o,r=hi.wrapX(r);if(e.get(d.tileIdToCacheKey(r))===h){l=!1;break}}if(!l)break}if(l)n.invoke(c.requestHandle,"downloaded",{cacheHit:!0});else{y=1<<t.levelOfDetail,t.x-=s,t.y=Math.max(0,t.y-s),i.x+=s,i.y=Math.min(y-1,i.y+s);var p=d.tileIdToLocation(t),v=d.tileIdToLocation(i),w=k.replace("{north}",p.latitude.toFixed(6)).replace("{west}",p.longitude.toFixed(6)).replace("{south}",v.latitude.toFixed(6)).replace("{east}",v.longitude.toFixed(6)).replace("{cols}",i.x-t.x+1).replace("{rows}",i.y-t.y+1);a++,fi.getObjectAsync(w,ot,{topLeft:t,bottomRight:i,requestHandle:c.requestHandle})}}}function ot(t,i){var s,f;if(i.success){var h=i.userData.topLeft,p=i.userData.bottomRight,k=h.x,b=p.x,w=h.y,y=p.y,c=t.alt;if(c&&c.length===(y-w+1)*(b-k+1)){var u=new it(h.levelOfDetail,0,0),r,nt,g=0,v=0;for(s=w;s<=y;s++)for(f=k;f<=b;f++){v+=c[g++],u.x=f,u.y=s,u=hi.wrapX(u),r=u;while(r.levelOfDetail>=h.levelOfDetail-ut){if(e.insert(d.tileIdToCacheKey(r),v))break;r=r.getParent()}}l++,n.invoke(i.userData.requestHandle,"downloaded",{cacheHit:!1})}}a--,o()}function rt(n){return Math.floor(Math.min(n+w,ft))}var u=this,k,st=64,w=c.log2(t.zoomOriginWidth/st),p=10+w,ft=20+w,ut=6,e=new ci(5e3),f=[],a=0,l=0,s=4,et=3,ht=new r(0,0,1),g=v+"ellipsoid",tt;this.authenticate=function(n){tt||(tt=!0,n(function(n){n&&(k=t.elevationServiceUrl.replace("{credentials}",n),o())}))},this.getAltitudeAtLatLon=function(n,t){return u.getAltitudeAtMercatorXY(d.latLonToMercatorXY(n,t))},this.getAltitudeForTile=function(n){return e.get(d.tileIdToCacheKey(n))},this.getApproximateAltitudeForTile=function(n){var t=e.get(d.tileIdToCacheKey(n)),r,i;if(t!==h)return t;for(r=-1;r<2;r++)for(i=-1;i<2;i++){t=e.get(d.tileIdToCacheKey(n.getSibling(r,i)),!1);if(t!==h)return t}},this.getAltitudeAtMercatorXY=function(n){var e=d.mercatorXYToTileId(n,ft),f,t;while(e.levelOfDetail>=1){f=u.getApproximateAltitudeForTile(e);if(f!==h){var o=e.levelOfDetail,k=1<<o,r=n.x*k-.5,v=n.y*k-.5,a=Math.floor(r),l=Math.ceil(r),y=Math.floor(v),w=Math.ceil(v),b=u.getAltitudeForTile(new it(o,a,y)),c=u.getAltitudeForTile(new it(o,l,y)),p=u.getAltitudeForTile(new it(o,a,w)),s=u.getAltitudeForTile(new it(o,l,w)),i;return b!==h?i=c!==h?b*(l-r)+c*(r-a):b:c!==h&&(i=c),p!==h?t=s!==h?p*(l-r)+s*(r-a):p:s!==h&&(t=s),i!==h?f=t!==h?i*(w-v)+t*(v-y):i:t!==h&&(f=t),f}e=e.getParent()}return 0},this.rayToGround=function(n,t,i){if(Math.abs(t.x-i.x)<=bt&&Math.abs(t.y-i.y)<=bt)return n.changeAltitude(t,u.getAltitudeAtMercatorXY(t));var o,r,e,f=t,s=et;while(s--){r=u.getAltitudeAtMercatorXY(f);if(Math.abs(o-r)<1)break;o=r,e=ui.fromNormal(n.changeAltitude(f,r),ht),f=e.intersectWithLine(t,i)}return f},this.toEllipsoid=function(n,t){var i,f,r;if(n.altitudeReference===dt.ellipsoid)return n;if(t)return new y(n.latitude,n.longitude,0,dt.ellipsoid);return i=n[g],i&&i.latitude===n.latitude&&i.longitude===n.longitude&&i.forAltitude===n.altitude&&i.forAltitudeReference===n.altitudeReference&&i.forGeneration===l?i:(f=u.getAltitudeAtLatLon(n.latitude,n.longitude),r=n.altitudeReference===dt.ground?n.altitude+f:f,i=new y(n.latitude,n.longitude,r,dt.ellipsoid),i.forAltitude=n.altitude,i.forAltitudeReference=n.altitudeReference,i.forGeneration=l,n[g]=i,i)},this.isElevationAvailableAtLatLon=function(n,t,i){var e=rt(i),r,f;if(e<p)return!0;r=d.latLonToTileId(n,t,e),f=ut;while(f--){if(u.getApproximateAltitudeForTile(r)!==h)return!0;r=r.getParent()}return!1},this.adjustCameraElevation=function(n){var i=n.getLookAt(),t=u.rayToGround(n.getCrs(),i,n.getViewportToWorld().transform(new r(0,0,1)));return r.areAlmostEqual(i,t)?n:n.getAlignedCamera(0,t)},this.downloadElevationData=function(n,t){var u,r;u=rt(n.getMercatorZoom());if(u>=p){r=vt.union(nt.getMercatorFootprint(n,t)),d.normalizeMercatorBounds(r);var s=d.mercatorXYToTileId(r,u),h=d.mercatorXYToTileId(new i(r.getRight(),r.getBottom()),u),e={};return f.push({topLeft:s,bottomRight:h,requestHandle:e}),b.dispatch(o),e}},this.downloadElevationDataForLocationRect=function(n,t){t=t||19;if(t>=p){var h=n.getNorth(),s=n.getWest(),e=n.getSouth(),c=n.getEast(),r=d.latLonToTileId(h,s,t),u=d.latLonToTileId(e,c,t),i={};return f.push({topLeft:r,bottomRight:u,requestHandle:i}),b.dispatch(o),i}},this.cancelDownload=function(n){if(n){var t=f.length;while(t--)f[t].requestHandle===n&&f.splice(t,1)}}},l.ElevationService=et,wt.nativeMercatorCamera=ut.mercator.getAlignedCamera(t.minMercatorZoom),wt.createMercatorScene=function(n,i,r,u){var f=null;return n&&(f=kt.createQuadKeyTilePyramid(t.defaultTileSize,t.defaultTileSize,n,ft.horizontal,u),f.projectingCamera=ut.mercator),new wt(wt.nativeMercatorCamera,f,t.maxMercatorZoom-t.minMercatorZoom,i,r)},l.CompositeModeScene=wt,lt.entityRenderers=[],lt.registerEntityRenderer=function(t,i){var r={getRenderer:t,priority:i?i.priority:null};lt.entityRenderers.push(r),lt.entityRenderers._key="k"+yi.getNext(),i&&i.priority!==null&&lt.entityRenderers.sort(function(n,t){var r=0,i=n.priority,u=t.priority;return(i!==null||u!==null)&&(r=i!==null&&u!==null?i-u:i!==null?-1:1),r}),n.invoke(lt,"newEntityRenderer")},lt.getEntityRenderer=function(n,t){var f=lt.entityRenderers._key,i=t._cmRd,u,r;if(t._cmRdk!==f){for(i=null,u=lt.entityRenderers,r=0;r<u.length&&!i;r++)i=u[r].getRenderer(n,t);t._cmRd=i,t._cmRdk=f}return i},l.CompositeMode=lt,w=new function(){function r(){var e=k(),r=t.length,u,f,s;while(r--){var o=t[r],c=p.Style.camelize(o),l=p.Style.get_camelized_style_name(o,e);e.style[l]!==h&&(i.Properties[c]=l,i.Attributes[c]=p.Style.get_css_style_name(o,e))}for(r=0;r<n.length;r++){u=n[r];for(f in u)if(f in e.style)for(s in u[f])i.Events[s]=u[f][s]}}var i=this,t,n;this.Properties={},this.Attributes={},this.Events={},t=["transform","transform-origin","transition","transition-delay","transition-property","transition-duration"],n=[{webkitTransition:{transitionEnd:"webkitTransitionEnd"}},{MozTransition:{transitionEnd:"MozTransitionEnd"}}],r()},o={none:0,allowed:1,readyForTarget:2,started:3,pendingCompletion:4},ot.Default=new ot(.25,.1,.25,1),ot.Linear=new ot(0,0,1,1),ot.EaseIn=new ot(.42,0,1,1),ot.EaseOut=new ot(0,0,.58,1),ot.EaseInOut=new ot(.42,0,.58,1),ot.EaseOutIn=new ot(0,.42,1,.58),ot.Flick=new ot(.2,.5,.35,1),gt=function(){function i(n){var i;if(!n[t]){newKey=+new Date;while(newKey in r)newKey++;n[t]=newKey}return i=r[n[t]]||[],r[n[t]]=i,i}function f(n,t,r){var o=i(n),f=!1,e=o.length;while(e--&&!f)f=o[e]===t,f&&r&&(o.splice(e,1),u(n));return f}function u(n){var e=i(n),s=e.length,h=new Date,r="",u="",o=!0,t,f;while(s--)t=e[s],f=h-t.getStartTime(),o||(r+=", ",u+=" "),r+=t.getProperty()+" "+t.getDuration()+"s "+t.getTimingFunction().cssText,u+="-"+f+"ms",o=!1;n.style[w.Properties.transition]=r,n.style[w.Properties.transitionDelay]=u}function e(t,r,e){function v(){var n=t&&r&&e;!n}var s=this,c=t,y=e,a=r,l=new Date(0),o=0,h=null;this.getStartTime=function(){return l},this.getProperty=function(){return c},this.getTimingFunction=function(){return y},this.getDuration=function(){return a},this.setDuration=function(n){o==0&&(a=n)},this.applyAnimation=function(n){if(!n||f(n,s))return;i(n).push(s),o==0&&(l=new Date),o++,p(n).add_event(w.Events.transitionEnd,function(n){n.propertyName==c&&(p(this).remove_event(w.Events.transitionEnd,arguments.callee,!1),s.removeAnimation(this))},!1),u(n)},this.removeAnimation=function(t){t&&t!=h&&f(t,s,!0)&&(o--,h=t,n.invoke(t,"animationsequenceprogress",new wu(s,t,o>0,i(t).length>0)),h=null)},v()}var r={},t=v+"CssAnimationSequenceId";return e}(),gt.prototype={getElapsedTimeAsPercentage:function(){return(new Date-this.getStartTime())/(this.getDuration()*1e3)},getProgress:function(n){n==null&&(n=this.getElapsedTimeAsPercentage());var t=1/(400*this.getDuration());return this.getTimingFunction().getProgress(n,t)},duplicate:function(n,t,i){return new gt(n?n:this.getProperty(),t?t:this.getDuration(),i?i:this.getTimingFunction())}},gt.Transformer=u.allowCssAnimations&&new gt(w.Attributes.transform,.3,ot.EaseInOut),gt.Flicker=u.allowCssAnimations&&gt.Transformer.duplicate(null,null,ot.Flick),gt.TileFader=u.allowCssAnimations&&new gt("opacity",.3,ot.Linear);var vr=function(){function t(){function u(n){if(!r||!r.length)return;var i=r.length,t=!1;while(!t&&i--)t=n(r[i])}function c(n){return n?n[f]:null}function l(n){n&&n.animationSequence&&!e&&u(function(t){if(t===n.animationSequence)return o(c(n.node),t),!0})}function o(i,r){i&&r&&t[i]&&t[i].remaining&&(e=!0,r.removeAnimation(t[i].node),e=!1,t[i].remaining--,t[i].remaining||(n.removeHandler(t[i].handler),t[i].node=null,t[i].handler=null,delete t[i],--s==0&&n.invoke(h,"animationscomplete",!1)))}var h=this,f=v+"CssAnimationGroupId"+ ++i,a=0,r=null,t={},s=0,e=!1;this.manageAnimations=function(n){var t,i;r&&h.removeAllAnimations(),r=n,t=r instanceof Array&&r.length>0;if(t){i=r.length;while(i--&&t)t=r[i]instanceof gt}if(!t)throw"Must pass in a non-empty array of CssAnimationSequence objects";},this.addToGroup=function(i){var u,e;if(!i)return;if(!i[f]){u=+new Date;while(u in t)u++;i[f]=u}e=i[f],t[e]||(s++,t[e]={node:i,handler:n.addHandler(i,"animationsequenceprogress",l),remaining:r.length})},this.applyAllAnimations=function(){u(function(n){for(var i in t)n.applyAnimation(t[i].node)})},this.removeAllAnimations=function(){u(function(n){for(var i in t)o(i,n)})},this.removeAnimations=function(n){u(function(t){o(c(n),t)})},this.hasPendingAnimations=function(){return s>0}}var i=0;return t}(),ii=new function(){function d(){var n=null,r=k(),t=w.Properties.transform,i;if(t&&t in a){i=a[t];try{r.style[t]="matrix(1,0,0,1,0,0)",l=i.p,n=i.f}catch(u){}}"opacity"in r.style&&(y=!0),n==null&&"filter"in r.style&&(n=g,c.requireFlowLayout=!0,v=!0,c.usingIEFilters=!0),n==null&&(n=p),c.setTransformAndOpacity=n}function s(n){if(n.offsetZ){var i=n.invert(),t=3;while(t--)o[t]=i.transform(h[t]);return yt.conversion(o[0],o[1],o[2],h[0],h[1],h[2])}return n.m44==1?n:new yt(n.m11/n.m44,n.m12/n.m44,n.m21/n.m44,n.m22/n.m44,n.offsetX/n.m44,n.offsetY/n.m44)}function e(n){var t={};return t.position="absolute",t["white-space"]="nowrap",t["line-height"]="0",n&&(t.width=n.width.toFixed(0)+"px",t.height=n.height.toFixed(0)+"px"),t}function r(n){var t=[];for(styleKey in n)t.push(styleKey,":",n[styleKey],";");return t.join("")}function g(i,f,o,h){var w,b,a;h=h||{};var l=s(i),y=Math.round(l.m11*n)/n,tt=Math.round(l.m22*n)/n,nt=Math.round(l.m12*n)/n,g=Math.round(l.m21*n)/n,c=h.excludeCommonCss?{}:e(f),v=null,d,k;if(y==1&&nt==0&&g==0&&tt==1)d=l.offsetX.toFixed(0),k=l.offsetY.toFixed(0);else if(u.cssZoomAffectsTopLeft()||y!=tt||nt!=0||g!=0)w=Math.round(f.width/2),b=Math.round(f.height/2),d=-w,k=-b,a=yt.multiply(l,new yt(1,0,0,1,w,b)),v="progid:DXImageTransform.Microsoft.Matrix(FilterType=nearest,  M11="+a.m11.toFixed(t)+", M21="+a.m12.toFixed(t)+", M12="+a.m21.toFixed(t)+", M22="+a.m22.toFixed(t)+", dX="+a.offsetX.toFixed(0)+", dY="+a.offsetY.toFixed(0)+")";else{var p=Math.abs(y-1)>.02?Math.round(y*1e4)/1e4:1,it=l.invert(),rt=it.offsetX,ut=it.offsetY,d=-rt*p,k=-ut*p;p!=1&&(c.zoom=p)}return c.left=d+"px",c.top=k+"px",o<.01?c.display="none":(c.display="block",o<.99&&(v=(v==null?"":v+", ")+"alpha(opacity = "+(o*100).toFixed(0)+")")),v&&(c.filter=v),h.returnStyleObject?c:r(c)}function f(t,i,f,o){var h,v;o=o||{};var k=s(t),a=Math.round(k.m11*n)/n,y=Math.round(k.m22*n)/n,g=Math.round(k.m12*n)/n,d=Math.round(k.m21*n)/n,b=Math.round(k.offsetX*n)/n,p=Math.round(k.offsetY*n)/n,c=o.excludeCommonCss?{}:e(i);return a===1&&g===0&&d===0&&y===1?u.useTransform2d?(c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+b+"px,"+p+"px)"):(c.left=b+"px",c.top=p+"px"):(i&&u.isIE9&&a&&y&&d===0&&Math.abs(a-y)<.01&&(h=a-1,v=y-1,h>.0102||h<-.009998||(h>.0079||h<-.0075?h>.009175||h<-.009086?(b+=i.width*h*-.05,p+=i.height*v*-.05,a+=h*.1,y+=v*.1):(a+=h*.17,y+=v*.17,h>0&&a<1.0100995||h<0&&a>.99?(b+=i.width*h*.5,p+=i.height*v*.5):(b+=i.width*h*-.09,p+=i.height*v*-.09)):(b+=i.width*h*.5,p+=i.height*v*.5,a+=h*.2,y+=v*.2))),c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix("+a+","+g+","+d+","+y+","+b+l+","+p+l+")"),f<.01?c.display="none":(f>.99||(c.opacity=f.toFixed(2)),c.display="block"),o.returnStyleObject?c:r(c)}function b(t,i,u,f){f=f||{};var s=f.excludeCommonCss?{}:e(i),o=t.m44,b=Math.round(t.m11*n/o)/n,p=Math.round(t.m12*n/o)/n,k=Math.round(t.m14*n/o)/n,g=Math.round(t.m21*n/o)/n,d=Math.round(t.m22*n/o)/n,y=Math.round(t.m24*n/o)/n,c=Math.round(t.m31*n/o)/n,h=Math.round(t.m32*n/o)/n,l=Math.round(t.m34*n/o)/n,v=Math.round(t.offsetX/o),a=Math.round(t.offsetY/o);return b===1&&p===0&&k===0&&g===0&&d===1&&y===0&&c===0&&h===0&&l===0?(s[f.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+v+"px,"+a+"px,0px)"):(s[f.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix3d("+b+","+p+",0,"+k+","+g+","+d+",0,"+y+","+c+","+h+",1,"+l+","+v+","+a+",0,1)"),u>=.01||f.explicitOpacity?((u<=.99||f.explicitOpacity)&&(s.opacity=u.toFixed(2)),s.display="block"):s.display="none",f.returnStyleObject?s:r(s)}function p(n,t,i,u){u=u||{};var o=s(n).invert(),f=u.excludeCommonCss?{}:e(t);return f.left=(-o.offsetX).toFixed(0)+"px",f.top=(-o.offsetY).toFixed(0)+"px",f.display=i>.1?"block":"none",u.returnStyleObject?f:r(f)}var c=this,a={transform:{p:"",f:f},msTransform:{p:"",f:f},webkitTransform:{p:"",f:u.useTransform3d?b:f},MozTransform:{p:"px",f:f},OTransform:{p:"",f:f}},l,t=6,n=Math.pow(10,t),h=[new i(0,0),new i(128,128),new i(-128,128)],o=[],y=!1,v=!1;this.setExactTransformOrHide=function(n,t,i,f){var o,h,l,c;return f=f||{},o=f.excludeCommonCss?{}:e(t),h=s(n).invert(),Math.abs(h.m11-1)<bt&&Math.abs(h.m12-0)<bt&&Math.abs(h.m21-0)<bt&&Math.abs(h.m22-1)<bt&&i>=.01?(l=-Math.round(h.offsetX)+"px",c=-Math.round(h.offsetY)+"px",o.display="block",u.useTransform3dForTranslate?o[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+l+","+c+",0px)":u.useTransform2d?o[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+l+","+c+")":(o.left=l,o.top=c),i>.99||(y?o.opacity=i.toFixed(2):v&&(o.filter="alpha(opacity = "+(i*100).toFixed(0)+")"))):o.display="none",f.returnStyleObject?o:r(o)},d()},pi=new function(){function p(){for(var e,h,u,s=0;s<i.length;s++){for(e=i[s],h=0;h<e.length;h++){var l=e[h],o=l.url,v=a.getState(o);switch(v){case st.none:case st.timedout:case st.cacheExpired:c<t.maxConcurrentTileDownloads&&(l.basket=e,f[o]||(c++,u=k("img"),f[o]=u,u[r]=l,u.onload=g,u.onerror=y,u.onabort=y,u[d]=window.setTimeout(function(){var n=u;return function(){nt.call(n)}}(),l.timeout),u.src=o));break;case st.downloading:break;default:e.hasNewTiles=!0}}e.hasNewTiles&&(n.invoke(e,"hasnewtiles"),e.hasNewTiles=!1)}}function g(){if(!this[e]){var n=this[r].url;o(this,n),w.insert(n,!0),l.insert(n,this)}}function y(){if(!this[e]){var n=this[r].url;o(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),s.insert(n,st.failed)}}function nt(){if(!this[e]){var n=this[r].url;o(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),s.insert(n,st.timedout)}}function o(n,t){var o,i,u;n[e]=!0,n.onload=null,n.onerror=null,n.onabort=null,window.clearTimeout(n[d]),o=n[r],i=o.basket,i.hasNewTiles=!0,u=i.length;while(u--)i[u]===o&&i.splice(u,1);c--,delete f[t],b.dispatch(p,-10)}var a=this,i=[],c=0,f={},l=new ci(50),s=new ci(30),w=new ci(200);u.useImageDisposer&&l.useDisposer(function(n){n&&n.src&&(n.src=t.spacerImageUrl)});var r=v+"downloadRequest",d=v+"timeoutid",e=v+"processed";this.getState=function(n){if(l.get(n))return st.ready;if(w.get(n))return st.cacheExpired;var t=s.get(n);return t!==h?t:f[n]?st.downloading:st.none},this.setDownloadBasket=function(n,t){a.removeDownloadBasket(n.basketId),n.length>0&&(t?i.push(n):i.unshift(n),b.dispatch(p,-10))},this.removeDownloadBasket=function(n){for(var t=0;t<i.length;)i[t].basketId===n?i.splice(t,1):t++}},st={none:0,downloading:1,ready:2,failed:3,timedout:4,cacheExpired:5};kt.createQuadKeyTilePyramid=function(n,i,r,u,f,e){var o=Math.pow(2,t.maxMercatorZoom);return new kt(n*o,i*o,n,i,0,0,0,0,kt.createMercatorQuadKeyUrlRetriever(r,n,u,f),kt.createQuadkeyTileReplacementHandler(),e)},kt.createMercatorQuadKeyUrlRetriever=function(n,i,r,u){return kt.createQuadKeyUrlRetriever(n,u,i,r,t.minMercatorZoom,t.maxMercatorZoom)},kt.createQuadKeyUrlRetriever=function(n,t,i,r,u,f,e){var l=c.ceilLog2(i),h,o,s;return typeof n=="string"?(h=n,o=t?t:h):s=n,function(n,t){var v=n.levelOfDetail-l,i,c,a;if(v>=u&&v<=f){i=new it(v,n.x,n.y),r&ft.horizontal&&(i=hi.wrapX(i)),r&ft.vertical&&(i=hi.wrapY(i));if(hi.isInBounds(i)){if(s)return s(i);if(i.levelOfDetail===0)if(e)c=hi.fromTileId(i,!0),a=e;else return null;else c=hi.fromTileId(i,!1),a=c.charAt(c.length-1);return t?o.replace("{quadkey}",c).replace("{subdomain}",a):h.replace("{quadkey}",c).replace("{subdomain}",a)}}return null}},kt.createQuadkeyTileReplacementHandler=function(){var n=new ci(200);return function(t){var e=t.toString(),i=n[e],f,u,r;if(i){f=i.toString();while(n[f])i=n[f],f=i.toString();u=n[e],r=u.toString();while(n[r])u=n[r],n[r]=i,r=u.toString()}else i=t.getParent(),n[e]=i;return i}},ft={none:0,horizontal:1,vertical:2},l.TilePyramid=kt,l.TilePyramidWrapMethod=ft,rr.getBestLevelOfDetail=function(n,t,i){var r,f,u;return r=t.getMaxLevelOfDetail()-c.log2(t.getWidth()/t.projectingCamera.getWidth()/(n.getZoomOriginWidth()/n.getWidth())),f=Math.ceil(r),u=Math.floor(r),f!=u&&(i&&(r=r+i),r=Math.round(r),r=Math.min(f,Math.max(u,r))),r=Math.min(r,t.getMaxLevelOfDetail())},l.TileRenderer=iu,oi=new function(){function n(){s()?(i=1,r=!0,f=!0):h()?(i=2,r=!1,f=!0):o()&&(i=3,r=!0,f=!1),n=function(){}}function s(){var n=!1,t;return document.implementation&&document.implementation.hasFeature?n=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"):document.createElementNS&&(t=document.createElementNS(ns,"svg"),n=typeof t.createSVGRect!="undefined"),s=function(){return n},n}function h(){var t=document.createElement("v:shape"),n;return t.style.behavior="url(#default#VML)",n=typeof t.strokecolor!="undefined",h=function(){return n},n}function o(){var t=document.createElement("canvas"),n=t.getContext&&t.getContext("2d")!==null;return o=function(){return n},n}function e(n){function t(n){this._surface=n,this._paths=[]}return t.prototype={setSize:function(n,t){this._width=n,this._height=t},createPath:function(){},renderPath:function(){},removePath:function(n){var t=this._paths.length;while(t--)if(this._paths[t]===n){this._surface.removeChild(n.nativeShape),this._paths.splice(t,1);break}},clear:function(){var n=this._paths.length;while(n--)this._surface.removeChild(this._paths[n].nativeShape);this._paths=[]}},new t(n)}function a(n){function i(){}function r(){function n(){var r=this,n=document.createElement("v:shape"),t,i;n.style.position="absolute",t=document.createElement("v:stroke"),n.appendChild(t),i=document.createElement("v:fill"),n.appendChild(i),this._stroke=t,this._fill=i,this._initialize(n)}return n.prototype=t,n.prototype.stroke=function(){this.data==null||this.data.length&&this.data.charAt(this.data.length-1)==="E"||(this.data+="E");var n=this.nativeShape;n.strokecolor=this.strokeStyle,n.strokeweight=this.lineWidth+"pt",this.lineCap&&(this._stroke.endcap=this.lineCap.toLowerCase()==="butt"?"flat":path.lineCap,this._stroke.dashstyle=this.dashArray,this._stroke.opacity=this.strokeOpacity),this.fillStyle&&this.fillStyle!=="none"?(this._fill.color=this.fillStyle,this._fill.opacity=this.fillOpacity*100+"%"):n.filled=!1,n.path=this.data},new n}return i.prototype=new e(n),i.prototype.createPath=function(){return new r},i.prototype.renderPath=function(n){var i="url(#default#VML)",r=this._height!=null?this._height:this._surface.offsetHeight,u=this._width!=null?this._width:this._surface.offsetWidth,t=n.nativeShape;this._surface.appendChild(t),t.style.height=r+"px",t.style.width=u+"px",t.style.behavior=i,t.coordsize=u+","+r,n._stroke.style.behavior=i,n._fill.style.behavior=i,this._paths.push(n)},new i}function l(n){function r(){}function o(){function n(){var t=this,n=document.createElementNS(f,"path");n.style.pointerEvents="visiblePainted",this._initialize(n)}return n.prototype=t,n.prototype.stroke=function(){var n=this.nativeShape;n.setAttribute("stroke",this.strokeStyle),n.setAttribute("stroke-width",this.lineWidth),n.setAttribute("stroke-linecap",this.lineCap),n.setAttribute("stroke-dasharray",this.dashArray),n.setAttribute("fill",this.fillStyle),n.setAttribute("fill-opacity",this.fillOpacity),n.setAttribute("fill-rule","evenodd"),n.setAttribute("stroke-opacity",this.strokeOpacity),n.setAttribute("d",this.data)},new n}var f="http://www.w3.org/2000/svg",i=document.createElementNS(f,"svg");return u.safariRenderHack&&(i.style.cssText=u.safariRenderHack),i.setAttribute("width","100%"),i.setAttribute("height","100%"),n.appendChild(i),r.prototype=new e(i),r.prototype.createPath=function(){return new o},r.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new r(n)}function c(n){function i(){}function r(i,r){function u(){var f=this,t=document.createElement("canvas"),u;t.style.cssText="position:absolute;",n.appendChild(t),u=t.getContext("2d"),u.beginPath(),this.context=u,this._initialize(t),this.setSize(i,r)}function o(n,t){if(n.length==7){var i=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+t+")"}return""}var e,f;return u.prototype=t,u.prototype.setSize=function(n,t){e=n,f=t,this.nativeShape.setAttribute("width",e),this.nativeShape.setAttribute("height",f)},u.prototype.beginPath=function(){this.context.beginPath()},u.prototype.moveTo=function(n,t){this.context.moveTo(n,t)},u.prototype.lineTo=function(n,t){this.context.lineTo(n,t)},u.prototype.curveTo=function(n,t,i,r,u,f){this.context.bezierCurveTo(n,t,i,r,u,f)},u.prototype.stroke=function(){var n=this.context;n.clearRect(0,0,e,f),this.fillStyle&&this.fillStyle!=="none"&&(n.fillStyle=o(this.fillStyle,this.fillOpacity),n.fill()),n.strokeStyle=o(this.strokeStyle,this.strokeOpacity),n.lineWidth=this.lineWidth,n.stroke(),this.drawn=!0},new u}return i.prototype=new e(n),i.prototype.setSize=function(n,t){if(this._width!==n||this._height!==t){this._width=n,this._height=t;var i=this._paths.length;while(i--)this._paths[i].setSize(n,t)}},i.prototype.createPath=function(){var t=this._height?this._height:this._surface.offsetHeight,n=this._width?this._width:this._surface.offsetWidth;return new r(n,t)},i.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new i(n)}var r,f,i,t;this.isClipped=function(){return n(),r},this.isEventsSupported=function(){return n(),f},this.getContext=function(t){if(!t.harmonyContext){n();var r;switch(i){case 1:r=new l(t);break;case 2:r=new a(t);break;case 3:r=new c(t)}t.harmonyContext=r}return t.harmonyContext},this.destroyContext=function(n){n.harmonyContext&&(n.harmonyContext.clear(),n.harmonyContext=null)},t={nativeShape:null,_events:null,id:null,data:"",strokeStyle:"#000",strokeOpacity:"1",dashArray:"solid",fillStyle:"#000",fillOpacity:"1",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"#000000ff",beginPath:function(){this.data=""},moveTo:function(n,t){this.data+="M"+Math.round(n)+","+Math.round(t)+" "},lineTo:function(n,t){this.data+="L"+Math.round(n)+","+Math.round(t)+" "},curveTo:function(n,t,i,r,u,f){this.data+="C"+Math.round(n)+","+Math.round(t)+" "+Math.round(i)+","+Math.round(r)+" "+Math.round(u)+","+Math.round(f)+" "},stroke:function(){},onMouseDown:function(n){this._events.mousedown.push(n)},onMouseUp:function(n){this._events.mouseup.push(n)},onClick:function(n){this._events.click.push(n)},onMouseMove:function(n){this._events.mousemove.push(n)},onMouseOver:function(n){this._events.mouseover.push(n)},onMouseOut:function(n){this._events.mouseout.push(n)},_dispatchEvent:function(n,t){var i=this._events[n].length;while(i--)this._events[n][i].call(this,t)},_initialize:function(n){function i(n){n=n||window.event,t._dispatchEvent(n.type,n)}var t=this;t._events={mousedown:[],mouseup:[],mousemove:[],mouseover:[],mouseout:[],click:[]},n.onmousedown=n.onmouseup=n.onclick=n.onmousemove=n.onmouseover=n.onmouseout=i,this.nativeShape=n}}},l.Harmony=oi,or.ensureVmlNamespace=function(){or.ensureVmlNamespace=function(){};try{document.namespaces&&document.namespaces.add&&document.namespaces.add("v","urn:schemas-microsoft-com:vml")}catch(n){}},l.CompositeModeEntityRenderer=or,new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof nr||r instanceof di){f=n.length;while(f--)n[f]===i&&(u=t[f]);u||(u=new bu(i),n.push(i),t.push(u))}return u};lt.registerEntityRenderer(i)},lu=new function(){function r(t,r){var c=r.userData,o=null,l,e,f,s,u,a;if(r&&r.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders){o=[],l=t.resourceSets[0].resources[0].imageryProviders,u=l.length;while(u--){var v=l[u],h=v.coverageAreas,p={attribution:v.attribution,coverageAreas:[]},y=h?h.length:0;while(y--)e=h[y],f=e.bbox,p.coverageAreas.push({zoomMax:e.zoomMax,zoomMin:e.zoomMin,boundingBox:ht.fromEdges(f[2],f[1],f[0],f[3])});o.push(p)}i[c]=o}s=n[c],delete n[c],u=s.length;while(u--)a=s[u],a.callback(o,a.userData)}var i={},n={};this.getCachedImageryProviders=function(n){return i[n]},this.getImageryProviders=function(u,f,e,o){if(i[u])e(i[u],o);else if(n[u])n[u].push({callback:e,userData:o});else if(t.imageryMetadataUrl){n[u]=[],n[u].push({callback:e,userData:o});var s=t.imageryMetadataUrl.replace(/{imagerySet}/,u).replace(/{credentials}/,f);fi.getObjectAsync(s,r,u)}else e(null,o)}},dr=new function(){function u(t,i){var u,e,o,f;i&&i.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders&&(u=i.userData,e=t.resourceSets[0].resources[0],r=e.displayCombinedLogo,o=[ti.defaultCopyright.text].concat(e.imageryProviders),n[u]&&(f=n[u].callback,delete n[u],n[u]=null,f&&f(o,r)))}var i=0,n=[],r=!1;this.getCopyrights=function(f,e,o,s,h,c){if(f&&e&&o&&h&&c){var l=t.imageryCopyrightUrl.replace(/{imagerySet}/,f).replace(/{zoom}/,parseInt(o)).replace(/{minLat}/,e.getSouth()).replace(/{minLon}/,e.getWest()).replace(/{maxLat}/,e.getNorth()).replace(/{maxLon}/,e.getEast()).replace(/{heading}/,parseInt(s)).replace(/{credentials}/,h);n[i]={callback:c},fi.getObjectAsync(l,u,i),i=++i%10}else c([ti.defaultCopyright.text],r)}},l.ModeEventHandler=uu,l.ModeEventHandlerComposite=hu,cu=new function(){function n(n,u,f,e,o,s){var h=kt.createQuadKeyTilePyramid(r,i,u,f,s);return h.projectingCamera=n,new wt(n.getAlignedCamera(t.minMercatorZoom),h,t.maxMercatorZoom-t.minMercatorZoom,"EnhancedBirdseye",e)}var u=this,r=256,i=180;this.createContributor=function(t){var s=t.credentialsProvider,r=t.urlFormat,f=t.urlWithLabelsFormat,o=new ei("Synth",s),e=new ei("SynthWithLabels",s),u={},i;return i={},u[nt.northUpHeading]=i,i[rt.hidden]=n(ut.enhancedBirdseyeNorthUp,r.replace("{dir}","dir_n"),ft.horizontal,o),i[rt.visible]=n(ut.enhancedBirdseyeNorthUp,f.replace("{dir}","dir_n"),ft.horizontal,e,r.replace("{dir}","dir_n")),i={},u[nt.westUpHeading]=i,i[rt.hidden]=n(ut.enhancedBirdseyeWestUp,r.replace("{dir}","dir_w"),ft.vertical,o),i[rt.visible]=n(ut.enhancedBirdseyeWestUp,f.replace("{dir}","dir_w"),ft.vertical,e,r.replace("{dir}","dir_w")),i={},u[nt.southUpHeading]=i,i[rt.hidden]=n(ut.enhancedBirdseyeSouthUp,r.replace("{dir}","dir_s"),ft.horizontal,o),i[rt.visible]=n(ut.enhancedBirdseyeSouthUp,f.replace("{dir}","dir_s"),ft.horizontal,e,r.replace("{dir}","dir_s")),i={},u[nt.eastUpHeading]=i,i[rt.hidden]=n(ut.enhancedBirdseyeEastUp,r.replace("{dir}","dir_e"),ft.vertical,o),i[rt.visible]=n(ut.enhancedBirdseyeEastUp,f.replace("{dir}","dir_e"),ft.vertical,e,r.replace("{dir}","dir_e")),{priority:30,minZoomLevel:0,getScene:function(n,t,i,r,f,e){return r>this.minZoomLevel?u[nt.snapToCardinalHeading(f)][e]:null}}}},pt.mercator="m",pt.auto="auto",t.allowOrdnanceSurvey&&(pt.ordnanceSurvey="os"),t.allowCollinsBart&&(pt.collinsBart="cb"),n.addHandler(tr,"mapcreationstart",function(n){var f=n.map,s=n.options,r=s&&s.credentials?function(n){return n.replace(/{key}/,s.credentials)}:function(n){return n},e=f.getCredentials,i=new lt,nt=wt.createMercatorScene(r(t.roadUriFormat),"Road",new ei("Road",e),r(t.roadUnlabeledUriFormat)),o={priority:10,getScene:function(){return nt}},l={},w,p,k,v,g,y,h,a;l[rt.hidden]=wt.createMercatorScene(r(t.aerialUriFormat),"Aerial",new ei("Aerial",e)),l[rt.visible]=wt.createMercatorScene(r(t.aerialWithLabelsUriFormat),"Aerial",new ei("AerialWithLabels",e),r(t.aerialUriFormat));var u={priority:20,maxZoomLevel:4.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevel?l[f]:null}},c=cu.createContributor({credentialsProvider:e,urlFormat:r(t.enhancedBirdseyeUriFormat),urlWithLabelsFormat:r(t.enhancedBirdseyeWithLabelsUriFormat)}),b=new au({credentialsProvider:e,urlFormat:r(t.nativeBirdseyeUriFormat),urlWithLabelsFormat:r(t.nativeBirdseyeWithLabelsUriFormat)}),d=new li(pt.mercator,i);d.activated=function(){i.setSceneContributors([])},w=new li(pt.road,i),w.activated=function(){i.setSceneContributors([o])},p=new li(pt.aerial,i),p.activated=function(){u.maxZoomLevel=1e3,i.setSceneContributors([u])},t.allowCollinsBart&&(k=new tu(wt.createMercatorScene(r(t.collinsBartUriFormat),"CollinsBart",new ei("CollinsBart",e)),t.collinsBartMinZoom-.5,t.collinsBartMaxZoom+.5,t.collinsBartBounds,15),v=new li(pt.collinsBart,i),v.activated=function(){i.setSceneContributors([o,k])},f.registerMapType(v)),t.allowOrdnanceSurvey&&(g=new tu(wt.createMercatorScene(r(t.ordnanceSurveyUriFormat),"OrdnanceSurvey",new ei("OrdnanceSurvey",e)),t.ordnanceSurveyMinZoom-.5,t.ordnanceSurveyMaxZoom+.5,t.ordnanceSurveyBounds,15),y=new li(pt.ordnanceSurvey,i),y.activated=function(){i.setSceneContributors([o,g])},f.registerMapType(y)),h=new li(pt.auto,i),h.activated=s.disableBirdseye!==!0&&t.defaultAerialTiltOn===!0?function(){u.maxZoomLevel=4.5,c.minZoomLevel=16.5,i.setSceneContributors([o,u,c,b])}:function(){var n={priority:20,maxZoomLevelBand1:4.5,minZoomLevelBand2:16.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevelBand1||r>this.minZoomLevelBand2?l[f]:null}};i.setSceneContributors([n,o])},a=new li(pt.birdseye,i),a.activated=function(){s.disableBirdseye!==!0?(u.maxZoomLevel=1e3,c.minZoomLevel=12.5,i.setSceneContributors([u,c,b])):(u.maxZoomLevel=1e3,i.setSceneContributors([u]))},f.registerMapType(d),f.registerMapType(h),f.registerMapType(w),f.registerMapType(p),f.registerMapType(a)}),delete window.Microsoft.Maps.initMapCode,PRF.end("Map core initialized","mapcore")},Microsoft.Maps.Globals&&Microsoft.Maps.initMapCode&&window.Microsoft.Maps.initMapCode(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},window.Microsoft.Maps.initMapDelayCode=function(){function sr(e,o,s){function ni(){b&&(n.removeHandler(b),n.removeHandler(yt),n.removeHandler(pt),b=null,p.remove_event("mousedown",g).remove_event("dblclick",i).remove_event("touchstart",g).remove_event("keydown",ut).remove_event("keyup",ct),t(y).remove_event("click",st),t(v).remove_event("click",ht),a.parentNode.removeChild(a),a=null,y=null,c=null,v=null)}function kt(n){var n=e.isRotationEnabled();n!==tt&&(tt=n,bt.set_style(tt?{visibility:"visible"}:{visibility:"hidden"}),n||(c.className="NavBar_compass NavBar_compassFlat",rt=null),wt())}function wt(){var t,n;if(tt){t=e.getTargetHeading();if(t!==rt){n="";switch(lt.snapToCardinalHeading(t)){case lt.northUpHeading:n="NavBar_compassN";break;case lt.eastUpHeading:n="NavBar_compassE";break;case lt.southUpHeading:n="NavBar_compassS";break;case lt.westUpHeading:n="NavBar_compassW"}c.className="NavBar_compass "+n,rt=t}}}function ft(n){var i=t.Screen.get_mouse_pos(n),r;isNaN(i.x)&&(i=new f(n.touches[0].pageX,n.touches[0].pageY)),h=new f(i.x-it.x-w.x,i.y-it.y-w.y),r=Math.sqrt(h.x*h.x+h.y*h.y),r<nt&&(h.x=h.x/nt*gt,h.y=h.y/nt*gt)}function et(){Math.abs(h.x)>1||(h.x=0),Math.abs(h.y)>1||(h.y=0);if(h.x||h.y){var n=e.tryPixelToLocation(h);n&&e.setView({center:n,animate:!1})}}function g(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),l(e,n),t(document).add_event("mousemove",k,!0).add_event("mouseup",d,!0).add_event("touchmove",k,!0).add_event("touchend",d,!0).add_event("contextmenu",i,!0),p.add_event("selectstart",i,!0),w=new f(c.offsetWidth/2,c.offsetHeight/2),nt=Math.min(w.x,w.y),it=p.get_absolute_pos(),ft(n),et(),at=window.setInterval(et,100))}function ut(t){t.stopPropagation();var i=new gi("keydown",t.keyCode,t.altKey,t.ctrlKey,t.shiftKey);i.originalEvent=t,n.invoke(e,"keydown",i)}function ct(t){t.stopPropagation();var i=new gi("keyup",t.keyCode,t.altKey,t.ctrlKey,t.shiftKey);i.originalEvent=t,n.invoke(e,"keyup",i)}function k(n){n.preventMouseEvent&&n.preventMouseEvent(),i(n),ft(n)}function d(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),t(document).remove_event("mousemove",k,!0).remove_event("mouseup",d,!0).remove_event("touchmove",k,!0).remove_event("touchend",d,!0).remove_event("contextmenu",i,!0),p.remove_event("selectstart",i,!0),window.clearInterval(at))}function st(n){i(n),l(e,n),dt(90)}function ht(n){i(n),l(e,n),dt(-90)}function dt(n){e.setView({heading:e.getTargetHeading()+n})}var ii=this,a,c,p,it,w,nt,at,h,gt=15,tt,ti,rt,y,v,bt,yt,pt,b;a=r("div",s.getClassName()),ot(a),y=vt("NavBar_rotateLeft",u.getString("L_rotateLeftTooltip_Text")),t(y).add_event("click",st).set_attr("uici","NB.CS.RotateLeft"),c=r("a"),c.href="#",c.onclick=function(){return!1},c.appendChild(document.createTextNode(u.getString("L_compassNorthLabel_Text"))),p=t(c),c.title=u.getString("L_compassTooltip_Text"),v=vt("NavBar_rotateRight",u.getString("L_rotateRightTooltip_Text")),t(v).add_event("click",ht).set_attr("uici","NB.CS.RotateRight"),bt=t([y,v]),p.add_event("mousedown",g).add_event("dblclick",i).add_event("touchstart",g).add_event("keydown",ut).add_event("keyup",ct).set_attr("uici","NB.CS.PanControl"),s.getRotateVisible()&&a.appendChild(y),s.getCompassVisible()&&a.appendChild(c),s.getRotateVisible()&&a.appendChild(v),o.appendChild(a),s.getDomElement=function(){return a},yt=n.addHandler(e,"imagerychanged",kt),pt=n.addHandler(e,"targetviewchanged",wt),kt(),b=n.addHandler(e,"ondispose",ni),this.dispose=ni}function ki(i,u,f){function g(){y(),nt=new Date,c||(o(e,"show"),c=!0,rt.appendChild(a));if(h.style.visibility==="hidden"){var f=s.offsetHeight,r=t(s).get_relative_pos().x,l=t(s).get_absolute_pos(),n=i.getRootElement(),u=t(n).get_absolute_pos().x+n.offsetWidth-(l.x+h.offsetWidth);u<0&&(r+=u),h.style.top=f+"px",h.style.left=r+"px",h.style.visibility="visible"}}function p(){y(),c&&(o(e,"hide"),c=!1,a.parentNode.removeChild(a),h.style.visibility="hidden")}function y(){d&&(window.clearTimeout(d),d=null),k&&(window.clearTimeout(k),k=null)}var e=this,rt=u,v,c=!1,it=[],nt=new Date(0),et=300,d,k,s=r("span","NavBar_button NavBar_typeButton"+(f?" "+f:"")),tt=t(s),l,b,ut,w,ft,a,h;tt.add_event("mouseenter",function(n){o(e,"mouseenter",n)}).add_event("mouseleave",function(n){o(e,"mouseleave",n)}).add_event("touchstart",function(n){o(e,"touchstart",n)}),l=r("a","NavBar_typeButtonLabel",s),l.href="#",l.appendChild(document.createTextNode("")),b=t(l),b.add_event("click",function(n){o(e,"clicklabel",n)}).add_event("mouseenter",function(n){o(e,"mouseenterlabel",n)}).add_event("mouseleave",function(n){o(e,"mouseleavelabel",n)}),ut=r("span","separator",s),w=r("a","NavBar_dropIconContainer",s),w.href="#",t(w).add_event("click",function(n){o(e,"clickicon",n)}).add_event("mouseenter",function(n){o(e,"mouseentericon",n)}).add_event("mouseleave",function(n){o(e,"mouseleaveicon",n)}),ft=r("span","NavBar_dropIcon",w),u.appendChild(s),a=r("div","NavBar_ModeSelectorControl"),h=r("ul","MicrosoftMap_NavBar_typeMenu",a),h.style.cssText="position:absolute;visibility:hidden",t(h).add_event("mouseenter",function(n){o(e,"mouseenter",n)}).add_event("mouseleave",function(n){o(e,"mouseleave",n)}),this.dispose=function(){s&&(p(),s.parentNode.removeChild(s),s=null)},this.isShown=function(){return c},this.addMenuItem=function(t,i){t&&(it.push(t),n.addHandler(t,"click",function(t){n.invoke(e,"clickitem",t)})),h.appendChild(i)},this.getItems=function(){return it},this.setMapType=function(n){v&&b.remove_class("NavBar_MapType_"+v),v=n,n&&b.add_class("NavBar_MapType_"+v)},this.getMapType=function(){return v},this.updateLabel=function(n){l.replaceChild(document.createTextNode(n),l.firstChild)},this.setSelected=function(n){n?tt.add_class("NavBar_buttonSel"):tt.remove_class("NavBar_buttonSel")},this.toggleMenu=function(){c?new Date-nt>et&&p():(g(),nt=new Date(0))},this.showMenu=function(){g()},this.showMenuDelay=function(n){y(),c||(d=window.setTimeout(g,n))},this.hideMenu=function(){p()},this.hideMenuDelay=function(n){y(),k=window.setTimeout(p,n)}}function bi(i,u,f){var a=this,c=it[i],s=r("li","NavBar_menuitem"+(u?" NavBar_menuItemSel":"")),e=r("div","NavBar_itemContainer NavBar_itemContainer_"+i,s),h;t(e).add_event("click",function(t){t.stopPropagation(),n.invoke(a,"click",t),f(i)});var v=r("div","NavBar_typePreview NavBar_typePreview_"+i,e),o=r("div","NavBar_typeContent",e),l=r("div","NavBar_typeTitle",o);l.appendChild(document.createTextNode(c.title)),h=r("div","NavBar_typeDesc",o),h.appendChild(document.createTextNode(c.description)),this.getTypeId=function(){return i},this.getElement=function(){return s},this.getContent=function(){return o},this.setSelected=function(n){s.className="NavBar_menuitem"+(n?" NavBar_menuItemSel":"")}}function br(i,f,e,s){function tt(){var e=i.getOptions(),u,r,t,n,f;h=i.getMapTypeId(),h===b?(c=!1,p.disableBirdseye!==!0&&(h=a)):h===a&&(p.disableBirdseye===!0?h=b:c=!0);if(it.hasOwnProperty(h)){u=v.getItems(),r=u.length;while(r--)t=u[r],n=t.getTypeId(),t.setSelected(n==h||d(h)&&d(n));f=it[h],v.updateLabel(f.title),v.setMapType(i.getMapTypeId())}y=e.labelOverlay!==ft.hidden,g&&(g.checked=y),k&&(k.checked=c)}function rt(n){n===a&&(n=p.disableBirdseye!==!0&&c?a:b),i.setView({mapTypeId:n,labelOverlay:y||n===st?ft.visible:ft.hidden});var t=i.getComponent("analyticsProxy");t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function d(n){return n===b||n===a}function et(n){y=!y,ut(n,g,y)}function ot(n){c=!c,ut(n,k,c)}function ut(n,t,r){n.stopPropagation(),l(i,n),n.currentTarget.tagName==="SPAN"&&t&&(t.checked=r),d(h)&&rt(a),ht&&v.hideMenuDelay(1e3)}function lt(t){var r=new ki(i,f),v,e,s,c,u;for(r.mapTypes=t,r.updateLabel(it[t[0]].title),r.setMapType(t[0]),v=[],r.events=v,u=0;u<t.length;u++)e=t[u],e&&(s=new bi(e,h===e,rt),r.addMenuItem(s,s.getElement()),(e===a||e===b&&p.disableBirdseye===!0)&&at(s.getContent()));c=[["clicklabel",function(n){l(i,n),r.toggleMenu()}],["clickicon",function(n){l(i,n),r.toggleMenu()}],["clickitem",function(n){l(i,n),r.hideMenu()}],["mouseenter",function(){r.showMenu()}],["mouseleave",function(){r.hideMenuDelay(1e3)}],["show",function(){o(ct,"showmaptypemenu",{menuPosition:0})}],["hide",function(){o(ct,"hidemaptypemenu",{menuPosition:0})}]],u=c.length;while(u--)v.push(n.addHandler(r,c[u][0],c[u][1]));return r}function at(n){var o=r("div","NavBar_checkControls"),e=r("div","NavBar_checkControl",o),i=r("input"),f;i.id="LabelCB_"+ri.getNext(),i.setAttribute("type","checkbox"),t(i).add_event("click",et),g=i,e.appendChild(i),i.checked=!0,f=r("span","",e),f.appendChild(document.createTextNode(u.getString("L_aerialShowLabels_Text"))),t(f).add_event("click",et),p.disableBirdseye!==!0&&(e=r("div","NavBar_checkControl",o),i=r("input"),i.id="TiltCB_"+ri.getNext(),i.setAttribute("type","checkbox"),t(i).add_event("click",ot),k=i,e.appendChild(i),i.checked=!0,f=r("span","",e),f.appendChild(document.createTextNode(u.getString("L_aerialEnableTilt_Text"))),t(f).add_event("click",ot)),n.appendChild(o)}var ct=this,st=w.auto,a=w.birdseye,b=w.aerial,h=i.getMapTypeId(),p=s,y=!0,c=nt.defaultAerialTiltOn===!0,g=null,k=null,v=lt([w.road,nt.allowCollinsBart?w.collinsBart:null,nt.allowOrdnanceSurvey?w.ordnanceSurvey:null,st,p.disableBirdseye!==!0?a:b]),vt=n.addHandler(i,"maptypechanged",tt),yt=n.addHandler(i,"optionschanged",tt),pt=!1;tt(),this.dispose=function(){var i=v.events,t=i.length;while(t--)n.removeHandler(i[t]);v.dispose(),n.removeHandler(vt),n.removeHandler(yt)},this.showMenu=function(){v.showMenu()},this.hideMenu=function(){v.hideMenu()},this.getAerialViewSettings=function(){return{showLabels:y,enableTilt:c}},this.setAerialViewSettings=function(n,t){y=n,c=t,d(h)&&rt(a)}}function dr(i,f,e,s){function b(){var l=i.getOptions(),u,r,n,s;c=i.getMapTypeId();if(it.hasOwnProperty(c)){u=h.length;while(u--){var t=h[u],o=!1,e=t.getItems(),f=e.length;while(f--)r=e[f],n=r.getTypeId(),r.setSelected(n==c),n==c&&(o=!0,s=it[n],t.updateLabel(s.title),t.setMapType(n));t.setSelected(o)}}!p&&d(c)&&(a=l.labelOverlay!==ft.hidden,ot.checked=a),p=!1}function v(n){var u=i.getOptions(),r=n==ut||a,t;p=u.labelOverlay!==ft.hidden!==r,i.setView({mapTypeId:n,labelOverlay:r?ft.visible:ft.hidden}),t=i.getComponent("analyticsProxy"),t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function d(n){return n===y||n===k}function g(){var n=h.length;while(n--)h[n].hideMenu()}function tt(n){n.stopPropagation(),l(i,n),a=!a,ot.checked=a,d(c)&&v(c),ht&&h[1].hideMenuDelay(1e3)}function et(t,r){var b=h.length,u=new ki(i,f,r),w,e,s,p;for(u.mapTypes=t,u.updateLabel(it[t[0]].title),u.setMapType(t[0]),w=[],u.events=w,e=0;e<t.length;e++)s=t[e],s&&(p=new bi(s,c===s,v),u.addMenuItem(p,p.getElement()));var y=!1,a=[["clicklabel",function(n){l(i,n),g(),v(u.getMapType())}],["clickicon",function(n){l(i,n),u.toggleMenu()}],["clickitem",function(n){l(i,n),g()}],["mouseentericon",function(){u.showMenu()}],["mouseleaveicon",function(){u.hideMenuDelay(1)}],["mouseenterlabel",function(){y=!0}],["mouseleavelabel",function(){y=!1}],["mouseenter",function(){u.isShown()&&!y&&u.showMenu()}],["mouseleave",function(){u.hideMenuDelay(1e3)}],["show",function(){var t=h.length;while(t--)u!=h[t]&&h[t].hideMenu();o(rt,"showmaptypemenu",{menuPosition:b})}],["hide",function(){o(rt,"hidemaptypemenu",{menuPosition:b})}]],e=a.length;while(e--)w.push(n.addHandler(u,a[e][0],a[e][1]));return u}function st(n){var e=r("div","NavBar_checkControl"),i=r("input"),f;return i.setAttribute("type","checkbox"),t(i).add_event("click",tt),e.appendChild(i),i.checked=!0,f=r("span","",e),f.appendChild(document.createTextNode(u.getString("L_aerialShowLabels_Text"))),t(f).add_event("click",tt),n.addMenuItem(null,e),i}var rt=this,ut=w.auto,k=w.birdseye,y=w.aerial,c=i.getMapTypeId(),ct=s,h=[];h.push(et([w.road,nt.allowCollinsBart?w.collinsBart:null,nt.allowOrdnanceSurvey?w.ordnanceSurvey:null,ut],"NavBar_DropDownMenu_0")),h.push(et(ct.disableBirdseye!==!0?[k,y]:[y],"NavBar_DropDownMenu_1"));var a=!0,ot=st(h[1]),lt=n.addHandler(i,"maptypechanged",b),at=n.addHandler(i,"optionschanged",b),p=!1;b(),this.dispose=function(){var r=h.length;while(r--){var u=h[r],t=u.events,i=t.length;while(i--)n.removeHandler(t[i]);u.dispose()}n.removeHandler(lt),n.removeHandler(at)},this.showMenu=function(n){h[n].showMenu()},this.hideMenu=function(n){h[n].hideMenu()},this.getAerialViewSettings=function(){return{showLabels:a}},this.setAerialViewSettings=function(n,t){a=n,d(c)&&(t?v(k):v(y))}}function gr(e,o,s){function lt(n){i(n),t.Events.capture_mouse(h),y=!0}function g(n){k();var t=Math.min(1,n.touches.length);at||n.touches.length!==1||(p=new f(n.touches[0].pageX,n.touches[0].pageY),p.target=n.target,p.start=new Date),d=new f(n.touches[0].pageX,n.touches[0].pageY),at=d,y=!0,i(n)}function ct(n){i(n);if(y){var r=b(t.Screen.get_mouse_pos(n).y);h.style.top=r+"px",w(r,!0)}}function tt(n){k(),et(),d=new f(n.touches[0].pageX,n.touches[0].pageY);if(y){var t=b(d.y);h.style.top=t+"px",w(t,!0)}i(n)}function pt(n){i(n),y&&(t.Events.release_mouse(),y=!1,w(b(t.Screen.get_mouse_pos(n).y),!1),ut(),l(e,n))}function nt(n){k(),p?(bt(n),l(e,n)):y&&(y=!1,w(b(d.y),!1),ut(),l(e,n)),et()}function ft(n){i(n),w(b(t.Screen.get_mouse_pos(n).y)),l(e,n)}function bt(n){n.target===c&&w(b(p.y))}function et(){p=null}function rt(){var n=e.getZoomRange();a&&a.min==n.min&&a.max==n.max||(a=n),ut()}function b(n){var i=c.offsetHeight-h.offsetHeight;return n-=t(c).get_absolute_pos().y+h.offsetHeight/2,n=Math.max(n,0),n=Math.min(n,i)}function w(n,t){var i=h.offsetHeight/2,f=c.offsetHeight-i,u=n+i,r=Math.round(a.max+(u-i)*-(a.max-a.min)/(f-i));e.setView({zoom:r,suspend:t})}function dt(n,t){if(a){var i=h.offsetHeight/2,u=c.offsetHeight-i,r=Math.round(i+(u-i)*(t-a.max)/-(a.max-a.min));n.style.top=r-n.offsetHeight/2+"px"}}function ut(){dt(h,e.getTargetZoom())}function st(){it&&(window.clearTimeout(it),it=null)}function k(){st(),ht&&(it=window.setTimeout(wt,5e3))}function wt(){st(),o.style.display="none"}var gt=this,v,c,kt,h,ht=s,yt,vt,y,a,p,d,at,it;v=r("div","NavBar_zoom"),ot(v),c=r("div","NavBar_zoomBar",v),c.style.cssText="position:absolute;overflow:hidden",t(c).add_event("click",ft).add_event("touchstart",g).add_event("touchmove",tt).add_event("touchend",nt),kt=r("div","NavBar_zoomBarBg",c),h=r("div","NavBar_zoomSlider",c),h.title=u.getString("L_zoomSliderTooltip_Text"),t(h).add_event("mousedown",lt).add_event("mouseup",pt).add_event("mousemove",ct).add_event("click",i).add_event("touchstart",g).add_event("touchmove",tt).add_event("touchend",nt),t(v).add_event("mousedown",i).add_event("mouseup",i).add_event("mousemove",i).add_event("click",i).add_event("touchstart",i).add_event("touchmove",i).add_event("touchend",i),o.appendChild(v),yt=n.addHandler(e,"targetviewchanged",rt),vt=n.addHandler(e,"imagerychanged",rt),ht&&k(),this.getDomElement=function(){return v},this.dispose=function(){v&&(t(c).remove_event("click",ft).remove_event("touchstart",g).remove_event("touchmove",tt).remove_event("touchend",nt),t(h).remove_event("mousedown",lt).remove_event("mouseup",pt).remove_event("mousemove",ct).remove_event("click",i).remove_event("touchstart",g).remove_event("touchmove",tt).remove_event("touchend",nt),t(v).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousemove",i).remove_event("click",i).remove_event("touchstart",i).remove_event("touchmove",i).remove_event("touchend",i),n.removeHandler(yt),n.removeHandler(vt),v.parentNode.removeChild(v),c=null,h=null,v=null)},this.show=function(){rt()},this.resetZoomBarTimer=k}function kr(u,f,e){function w(){s&&(n.removeHandler(p),n.removeHandler(s),s=null,v.removeNavigationBar(u))}function a(){var i=f.getDomElement(),r,n;i&&(r=i.offsetWidth,n="",r>665?r>774||(n="medium"):n="narrow",n!==h&&(t(i).remove_class(h).add_class(n),h=n))}function y(n){var t,u,i;t=c[n],u=f.getDomElement();if(!t){t=r("div","NavBar_clientRegion NavBar_clientRegion_"+b.getName(n));switch(n){case b.left:i=c[b.middle],u.insertBefore(t,i?i.nextSibling:e.getDomElement().nextSibling);break;case b.middle:t=e.getDomElement();break;case b.right:u.appendChild(t)}c[n]=t,a()}return t}var c={},o={},h="",s,p;v.registerNavigationBar(u,this),s=n.addHandler(u,"ondispose",w),p=n.addHandler(u,"resize",a),this.addClientButton=function(n,r,f,e,s){var c=y(n),h=typeof f=="string"?vt(e,f):f;return c.appendChild(h),o[r]=h,t(h).add_event("click",function(n){typeof f=="string"&&i(n),l(u,n),s&&s(r)}).set_attr("uici","NB.TB."+f),h},this.updateClientButton=function(n,i,r){var u=o[n];u&&(u.className="NavBar_button NavBar_toolButton "+(r||""),u.title=i||"",t(u).set_attr("uici","NB.TB."+i))},this.removeClientButton=function(n,t){var r=y(n),i=o[t];i&&(delete o[t],r.removeChild(i))}}function iu(f,o,s){function vr(){n.removeHandler(at),at=null,hr=f.getTargetCenter(),lr=f.getTargetZoom()}function pt(){gt&&(f.entities.remove(gt),gt=null),c.current.style.display!=="none"&&(c.current.style.display="none",c.currentDelim.style.display="none",g=p[d],y())}function cr(){c.current.style.display==="none"&&(l.currentZoom=f.getTargetZoom(),l.currentCenter=f.getTargetCenter(),c.current.style.display="inline-block",c.currentDelim.style.display="inline",y())}function tf(n){ni=n,y()}function er(){et=ni!==null?ni:ef()}function ef(){var r=c.breadcrumbContainer,u=c.breadcrumb,n,i;return u&&r?(n=t(u),i=r.offsetWidth-parseInt(n.get_style("paddingLeft"))-parseInt(n.get_style("paddingRight")),i>0?i:0):0}function wu(){y()}function yu(){var t,n,i;er();if(et>0)c.breadcrumb&&(c.breadcrumb.style.display="block");else{c.breadcrumb&&(c.breadcrumb.style.display="none");return}t=c.breadcrumbBar.offsetWidth;if(t>=et)for(n=0,i=p.length-1;n<i;n++){c[p[n]].firstChild.nodeValue="...",c[p[n]].setAttribute("title",l[p[n]]),t=c.breadcrumbBar.offsetWidth;if(t<et)break}tu()}function tu(){var t,n,i;er();if(et>0)c.breadcrumb&&(c.breadcrumb.style.display="block");else{c.breadcrumb&&(c.breadcrumb.style.display="none");return}t=c.breadcrumbBar.offsetWidth;if(t>=et)for(n=0,i=b.length;n<i;n++){a[b[n].name].firstChild.nodeValue="...",a[b[n].name].setAttribute("title",b[n].value),t=c.breadcrumbBar.offsetWidth;if(t<et)break}tr(rt)}function br(){c.breadcrumb&&(hi(c.breadcrumbContainer),c.breadcrumbContainer.parentNode.removeChild(c.breadcrumbContainer),c.breadcrumbContainer=null,c.breadcrumb=null)}function bu(t){var f=a[t+"Delim"],u,i,r;f&&(f.parentNode.removeChild(f),a[t+"Delim"]=null),u=ct(t),u.type==="group"?(i=t+"Click",n.removeHandler(k[i]),k[i]=null,i=t+"MouseEnter",n.removeHandler(k[i]),k[i]=null,i=t+"MouseLeave",n.removeHandler(k[i]),k[i]=null,u===rt&&ut(!0),r=a[t+"Container"],a[t+"Container"]=null,a[t]=null,a[t+"ListSign"]=null,r.parentNode.removeChild(r)):(i=t+"Click",n.removeHandler(k[i]),k[i]=null,r=a[t],a[t]=null,r.parentNode.removeChild(r))}function ku(t){var i,r,u;g=t,y();switch(t){case"world":case"country":case"state":case"county":case"city":case"neighborhood":cr();break;case"current":pt();break;default:n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:ct(t).value});return}i={animate:ru},f.isStreetside&&f.isStreetside()&&(i.mapTypeId=w.road),r=l[t+"Bounds"],r?(u=ti.fromEdges(r[2],r[1],r[0],r[3]),i.bounds=u):t==="current"?(i.center=l.currentCenter,i.zoom=l.currentZoom):(i.center=l.currentCenter,i.zoom=l[t+"Zoom"]),of(i),n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:l[t]})}function dr(){ku(this.attributes.pathNodeLevel.value)}function bi(){var h,u,n,e;c.root||(c.root=f.getRootElement(),h=r("div","pathContainer"),c.breadcrumb=h,h.setAttribute("onselectstart","return false;"),u=r("div",s.getClassName(),o),s.getDomElement=function(){return u},ot(u),c.breadcrumbContainer=u,u.appendChild(c.breadcrumb),n=document.createElement("div"),n.className="unlockButton",e=t(n),e.add_event("click",vi),e.add_event("touchstart",i),e.add_event("touchend",vi),c.root.appendChild(n),c.breadcrumbUnlock=n,pu())}function pu(){var f,i,r,e,o,n;if(c.breadcrumb){f=document.createElement("span"),f.className="path";for(i in ft)r=document.createElement("span"),i!=="world"?(i==="current"&&(e=document.createElement("span"),f.appendChild(e),c.breadcrumbExtension=e),o="•",r.className="pathNodeDelim",r.style.display="none"):(o="",r.className="pathHeight",r.style.display="inline-block"),r.appendChild(document.createTextNode(o)),f.appendChild(r),c[i+"Delim"]=r,i==="current"?(n=document.createElement("a"),n.className="currentIcon",n.href="#",n.title=u.getString("L_currentIconTooltip_Text")):(n=document.createElement("a"),n.href="#",n.className="pathNode",i!=="world"?n.appendChild(document.createTextNode("")):n.appendChild(document.createTextNode(l[i]))),i!=="world"&&(n.style.display="none"),t(n).add_event("click",dr),n.setAttribute("pathNodeLevel",i),n.setAttribute("uici","BC.PN."+i),f.appendChild(n),c[i]=n;c.breadcrumbBar=f,c.breadcrumb.appendChild(f)}}function wi(){h.country=null,h.state=null,h.county=null,h.city=null,h.neighborhood=null,h.street=null,h.current=null,h.countryBounds=null,h.stateBounds=null,h.countyBounds=null,h.cityBounds=null,h.neighborhoodBounds=null,h.streetBounds=null,h.currentBounds=null,h.countryEntityId=null,h.stateEntityId=null,h.countyEntityId=null,h.cityEntityId=null,h.neighborhoodEntityId=null,h.streetEntityId=null,h.currentEntityId=null}function pi(){c.breadcrumbUnlock.style.display="block"}function ki(){c.breadcrumbUnlock.style.display="none"}function du(n,t,i,r,u){var f={type:n,name:t,value:i,values:r,isVisible:u};b.push(f),nf(f)}function nf(n){var u=document.createElement("span"),e="•",r,f,i;u.className="pathNodeDelim",u.style.display="none",u.appendChild(document.createTextNode(e)),a[n.name+"Delim"]=u,c.breadcrumbExtension.appendChild(u),n.type==="group"?(r=document.createElement("span"),r.className="groupContainer",r.style.display="none",r.setAttribute("pathNodeLevel",n.name),k[n.name+"Click"]=t(r).add_event("click",rf),k[n.name+"MouseEnter"]=t(r).add_event("mouseenter",rr),k[n.name+"MouseLeave"]=t(r).add_event("mouseleave",ir),i=document.createElement("span"),i.className="group",i.appendChild(document.createTextNode("")),f=document.createElement("span"),f.className="groupListSign",a[n.name+"Container"]=r,a[n.name]=i,a[n.name+"ListSign"]=f,r.appendChild(i),r.appendChild(f),c.breadcrumbExtension.appendChild(r)):(i=document.createElement("span"),i.className="pathNode",i.appendChild(document.createTextNode("")),i.style.display="none",k[n.name+"Click"]=t(i).add_event("click",dr),i.setAttribute("pathNodeLevel",n.name),i.setAttribute("uici","BC.PN."+n.name),a[n.name]=i,c.breadcrumbExtension.appendChild(i))}function gu(n,t){var i=ct(n);if(i.isVisible===t)return;i.type==="group"&&t===!1&&i===rt&&ut(!0),i.isVisible=t,y()}function vu(n){bu(n),b.splice(au(n),1),y()}function ct(n){var t=b.length;while(t--)if(b[t].name===n)return b[t]}function au(n){var t=b.length;while(t--)if(b[t].name===n)return t}function yi(t,i){var r=ct(t),u=r.value;r.value=i,a[t].firstChild.nodeValue=i,oi(t),y(),n.invoke(v,"groupselecteditemchanged",{groupName:t,newItem:i,oldItem:u})}function ai(t){ht=!0,lt=t,kt(!0),n.invoke(v,"locked")}function of(t){at||(at=n.addHandler(f,"targetviewchanged",vr)),f.setView(t),window.setTimeout(function(){at&&vr()},100)}function sf(){ht=!1}function hf(){ht=!1,ki(),ut(!0),pt(),wi(),h.currentZoom=f.getTargetZoom(),gi(),g=p[d],y(),lt=f.getTargetCenter(),kt(!0),n.invoke(v,"unlocked")}function vi(t){hf(),n.invoke(v,"closed"),t.stopPropagation()}function rf(){var i=this.attributes.pathNodeLevel.value,r=ct(i);oi(i),y(),a.groupList?ut(!0):nr(r),n.invoke(v,"pathnodeclicked",{pathNodeLevel:i,pathNodeValue:r.value})}function rr(){nr(ct(this.attributes.pathNodeLevel.value))}function ir(){a.groupList&&ut()}function yt(n){yi(rt.name,this.firstChild.nodeValue),ut(!0),i(n)}function ur(){var u,f,r;it=null;if(a.groupList){n.removeHandler(fi),n.removeHandler(ei),u=a.groupList.childNodes,f=u.length;while(f--)r=t(u[f]),r.remove_event("click",yt),r.remove_event("touchstart",i),r.remove_event("touchend",yt);fi=null,ei=null,a.groupList.parentNode.removeChild(a.groupList),a.groupList=null,rt=null}}function ut(n){a.groupList&&(n?(it&&(clearTimeout(it),it=null),ur()):it||(it=setTimeout(ur,1e3)))}function tr(n){var i=a.groupList;if(i){var u=t(o).get_absolute_pos(),r=c.breadcrumb,e=t(r).get_absolute_pos().y+r.offsetHeight-u.y,f=t(a[n.name+"Container"]).get_absolute_pos().x-u.x;i.style.top=e+"px",i.style.left=f+"px"}}function nr(n){var r,e,u,f;if(rt)if(rt!==n)ut(!0);else{it&&(clearTimeout(it),it=null);return}r=document.createElement("ul"),a.groupList=r,rt=n,r.className="pathList",r.style.position="absolute",r.setAttribute("pathNodeLevel",n.name),o.appendChild(r),fi=t(r).add_event("mouseenter",rr),ei=t(r).add_event("mouseleave",ir);for(e in n.values)u=document.createElement("li"),u.appendChild(document.createTextNode(n.values[e])),r.appendChild(u),f=t(u),f.add_event("click",yt),f.add_event("touchstart",i),f.add_event("touchend",yt);tr(n)}function uf(){l.country=null,l.state=null,l.county=null,l.city=null,l.neighborhood=null,l.street=null,l.current=null,l.countryBounds=null,l.stateBounds=null,l.countyBounds=null,l.cityBounds=null,l.neighborhoodBounds=null,l.streetBounds=null,l.currentBounds=null,l.countryEntityId=null,l.stateEntityId=null,l.countyEntityId=null,l.cityEntityId=null,l.neighborhoodEntityId=null,l.streetEntityId=null,l.currentEntityId=null,d=ft.world,g="world"}function si(){li=or,st++,f.getCredentials(function(n){if(n){var t=wr+"/"+lt.latitude.toFixed(10)+","+lt.longitude.toFixed(10)+"?include=EntityId&includeEntityTypes=Neighborhood,PopulatedPlace,AdminDivision1,AdminDivision2,CountryRegion&output=json&key="+n+"&culture="+ui;tt.useXHR||(t+="&jsonp=microsoftMapsNetworkCallback&jsonso={jsono}"),wt.getObjectAsync(t,su,st)}})}function kt(n,t){n?(clearTimeout(nt),nt=null,si()):(li===ar&&nt&&(clearTimeout(nt),nt=null),st++,li=ar,nt=t?setTimeout(si,t):setTimeout(si,ff))}function ci(n){var o="",e=ft[n]+1,t;while(e-->1){var r=p[e],u=iu[r],i=h[r];if(u&&i)o+="&"+u+"="+i;else{ri();return}}n!=="street"&&(t=yr.get(h[n+"EntityId"])),t?(h[n+"Bounds"]=t,ri()):f.getCredentials(function(n){if(n){var t=wr+"?key="+n+"&culture="+ui+"&output=json"+o;tt.useXHR||(t+="&jsonp=microsoftMapsNetworkCallback&jsonso={jsono}"),wt.getObjectAsync(t,gr,st)}})}function y(){var f=ft,u,n,i,r;bt.selectedCrumb=g;for(n in f)i=c[n],n!=="current"&&(n==="street"?i.firstChild.nodeValue="Near "+l[n]:(u=l[n],u||(u=""),i.firstChild.nodeValue=u),i.removeAttribute("title"),r=c[n+"Delim"],(ft[n]<=d||ht)&&l[n]?(i&&(i.style.display="inline",n===g?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&n!=="world"&&(r.style.display="inline")):(i&&(i.style.display="none"),r&&n!=="world"&&(r.style.display="none")));hu(),yu()}function hu(){for(var n,i,r,u=0,f=b.length;u<f;u++)n=b[u],i=a[n.name],i.firstChild.nodeValue=n.value,i.removeAttribute("title"),r=a[n.name+"Delim"],n.isVisible?(i&&(n.type==="group"?a[n.name+"Container"].style.display="inline":i.style.display="inline",n.name===g?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&(r.style.display="inline")):(i&&(n.type==="group"?(a[n.name+"Container"].style.display="none",ut(!0)):i.style.display="none"),r&&(r.style.display="none"))}function su(n,t){var c=t.userData,s,e,f,o,u,r,i;if(c===st&&t.success&&n.statusCode===200){s=n.resourceSets[0],e=!1;if(s.estimatedTotal>0){f=s.resources,wi(),u=f.length;while(u--){r=f[u],o=r.entityType;if(di[o]&&o!=="Neighborhood"){i=r.address,h.country=i.countryRegion,h.state=i.adminDistrict,h.county=i.adminDistrict2,h.city=i.locality,h.street=i.addressLine,h.countryEntityId=i.countryRegionEntityId,h.stateEntityId=i.adminDistrictEntityId,h.countyEntityId=i.adminDistrict2EntityId,h.cityEntityId=i.localityEntityId,h.streetEntityId=i.addressLineEntityId;break}}u=f.length;while(u--){r=f[u];if(r.entityType==="Neighborhood"){i=r.address,h.country=i.countryRegion,h.state=i.adminDistrict,h.county=i.adminDistrict2,h.neighborhood=i.locality,h.countryEntityId=i.countryRegionEntityId,h.stateEntityId=i.adminDistrictEntityId,h.countyEntityId=i.adminDistrict2EntityId,h.neighborhoodEntityId=i.localityEntityId;break}}e=!0}else uf(),y();bt={currentCrumb:p[d],selectedCrumb:g,country:h.country,state:h.state,county:h.county,neighborhood:h.neighborhood,city:h.city,street:h.street,location:n},e&&cu()}}function lu(n,t){var i=di[n];h[i+"Bounds"]=t,yr.add(h[i+"EntityId"],t)}function cu(){kr=3,ci("city"),ci("state"),ci("country")}function gr(n,t){var r=t.userData,i;r===st&&t.success&&n&&n.statusCode===200&&n.resourceSets&&n.resourceSets.length>0&&n.resourceSets[0].resources&&n.resourceSets[0].resources.length>0&&(i=n.resourceSets[0].resources[0],lu(i.entityType,i.bbox)),ri()}function ri(){--kr||(l=h,gi(),bt.currentCrumb=p[d],n.invoke(v,"breadcrumbschanged"),y())}function uu(n){var t=f.getBounds();return!(n.width>t.width||n.height>t.height)}function ou(n){var i=f.getBounds(),t=Math.min(i.width/4,i.height/4);return n.width>=t||n.height>=t}function gi(){var n,u,t,r,f,i;if(ht){d=ft.neighborhood;return}for(n=0,u=p.length-1;n<u;n++)if(l[p[n]]){t=l[p[n]+"Bounds"];if(t){r=ti.fromEdges(t[2],t[1],t[0],t[3]);if(uu(r)){f=r,ou(r)&&(d=n);break}else d=n}else{i=l[p[n]+"Zoom"];if(i)if(i<l.currentZoom)d=n;else if(i<l.currentZoom+2){d=n;break}}}g=p[d]}function eu(){bi(),lt=f.getTargetCenter(),h.currentZoom=f.getTargetZoom(),kt(!1,5e3),sr=n.addHandler(f,"viewchangeend",fu)}function fu(){ii.areEqual(f.getTargetCenter(),hr)&&f.getTargetZoom()===lr||(pt(),ht===!1?(lt=f.getCenter(),h.currentZoom=f.getZoom(),kt()):y())}function oi(n){g!==n&&(g=n,y())}function fr(){nt&&(clearTimeout(nt),nt=null),n.removeHandler(sr),br()}function pr(){dt&&(n.removeHandler(dt),dt=null,fr(),f.addComponent("breadcrumb",v))}var wr=e.Globals.bingMapsRESTServicesUrl,ui="en-us",nu=["cs-cz","da-dk","nl-nl","en-ca","en-gb","en-us","fi-fi","fr-ca","fr-fr","de-de","it-it","ja-jp","nb-no","pt-br","pt-pt","es-es","es-us","sv-se"],kr=0,et=0,ni=null,st=0,lt,rt,fi=null,ei=null,k={},gt,ru=!0,v=this,ht=!1,sr,cf,af="navigationBar",bt={},g="world",lf=0,or="ready",ar="wait",li=or,hr,lr,at,nt,ff=1e3,it,b=[],l={world:u.getString("L_world_Text"),worldBounds:[-75,-175,75,175],countryZoom:4,stateZoom:7,countyZoom:10,cityZoom:13,neighborhoodZoom:15,streetZoom:16,current:""},h=l,ft={world:0,country:1,state:2,county:3,city:4,neighborhood:5,street:6,current:7},p=["world","country","state","county","city","neighborhood","street","current"],d=ft.world,c={},a={},yr={_cacheSize:100,_history:[],_recentlyUsed:[],_cache:{},add:function(n,t){if(!n)return;this._cache[n]=t,this._history.push(n),this._history.length>this._cacheSize&&delete this._cache[this._history.shift()]},get:function(n){return n?this._cache[n]:null}},iu={street:"addressLine",city:"locality",county:"adminDistrict2",state:"adminDistrict",country:"countryRegion"},di={Dependent:"country",Sovereign:"country",CountryRegion:"country",AdminDivision1:"state",AdminDivision2:"county",PopulatedPlace:"city",Neighborhood:"neighborhood",Address:"street"},vt=e.Globals.locale,dt;vt&&(vt=vt.toLowerCase(),t(nu).index_of(vt)!==-1&&(ui=vt)),n.addHandler(f,"resize",wu),f.addComponent("breadcrumb",v),dt=n.addHandler(f,"ondispose",pr),v.enable=eu,v.disable=fr,v.dispose=pr,v.setWidth=tf,v.lockToLocation=ai,v.unlockFromLocation=sf,v.showCloseButton=pi,v.hideCloseButton=ki,v.addCrumb=du,v.removeCrumb=vu,v.setVisibility=gu,v.selectGroupItem=yi,v.highlightCrumb=oi,v.showBookmark=cr,v.hideBookmark=pt,v.relocateCloseButton=function(n,t){c.breadcrumbUnlock.style.top=n,c.breadcrumbUnlock.style.right=t},v.getBreadcrumbs=function(){return bt},this.enable()}function tu(f,e,o){function it(){y&&(n.removeHandler(y),y=null,a&&a.dispose(),t(b).remove_event("click",nt).remove_event("mouseenter",c).remove_event("mouseleave",v),t(w).remove_event("click",tt).remove_event("mouseenter",c).remove_event("mouseleave",v),s.parentNode.removeChild(s))}function tt(n){i(n),l(f,n),ht()?c():d(),f.setView({zoom:f.getTargetZoom()+1})}function nt(n){i(n),l(f,n),ht()?c():d(),f.setView({zoom:f.getTargetZoom()-1})}function c(){k(),o.getZoomBarVisible()&&(h||(h=r("div","NavBar_zoomDrop"),h.style.cssText="position:absolute;display:none;",a=new gr(f,h,o.getZoomBarToggle()),s.firstChild?s.insertBefore(h,s.firstChild):s.appendChild(h),o.getZoomBarToggle()&&t(h).add_event("mouseenter",c).add_event("mouseleave",v)),h.style.display==="none"&&(h.style.display="",a.show()),ht()&&a.resetZoomBarTimer())}function v(){k(),p=window.setTimeout(d,1e3)}function d(){k(),o.getZoomBarToggle()&&h&&(h.style.display="none")}function k(){p&&(window.clearTimeout(p),p=null),g&&(window.clearTimeout(g),g=null)}var rt=this,s,w,b,h,a,p,g,y;s=r("div",o.getClassName()),ot(s),b=vt("NavBar_zoomOut",u.getString("L_zoomOutTooltip_Text")),t(b).add_event("click",nt).add_event("mouseenter",c).add_event("mouseleave",v).set_attr("uici","NB.ZC.ZoomOut"),w=vt("NavBar_zoomIn",u.getString("L_zoomInTooltip_Text")),t(w).add_event("click",tt).add_event("mouseenter",c).add_event("mouseleave",v).set_attr("uici","NB.ZC.ZoomIn"),o.getZoomOutVisible()&&s.appendChild(b),o.getZoomInVisible()&&s.appendChild(w),e.appendChild(s),o.getZoomBarToggle()||c(),o.getDomElement=function(){return s},y=n.addHandler(f,"ondispose",it),this.dispose=it}function nu(t,i,u){function a(){if(c){n.removeHandler(c),c=null;var t=e.length;while(t--)n.removeHandler(e[t][2]);h.dispose(),f.parentNode.removeChild(f)}}var e=[["showmaptypemenu",function(n){o(v.getNavBar(t),"showmaptypemenu",n)}],["hidemaptypemenu",function(n){o(v.getNavBar(t),"hidemaptypemenu",n)}]],h,f=r("div",u.getClassName()),y,l,s,c;ot(f),y=r("span","NavBar_separator",f),l={disableBirdseye:u.getDisableBirdseye()},h=u.getMapTypes()!==null?new dr(t,f,this,l):new br(t,f,this,l),i.appendChild(f),u.getDomElement=function(){return f},s=e.length;while(s--)e[s][2]=n.addHandler(h,e[s][0],e[s][1]);c=n.addHandler(t,"ondispose",a),this.dispose=a}function ar(t,i,u){function y(){s&&(n.removeHandler(s),n.removeHandler(b),s=null,f.parentNode.removeChild(f)),p&&n.removeHandler(p),v&&n.removeHandler(v)}for(var l=new k,f=r("div",u.getClassName()),w=u.getLength(),a,o,h,e=0;e<w;e++)a=u.get(e),o=c.getRenderer(a),typeof o=="function"&&new o(t,f,a);u.getStopPropagation()&&ot(f),i=u.getParentOverride()||i,h=u.getNextSibling(),h?i.insertBefore(f,h):i.appendChild(f),u.getDomElement=function(){return f},l.setContext(f);var b=n.addHandler(u,"entitychanged",function(n){n&&n.entity==u&&(n.handled=!0,f.className=u.getClassName(),u.getStopPropagation()?ot(f):hi(f))}),p=n.addHandler(u,"entityadded",function(n){if(n&&n.collection==u){var i=n.entity,r=c.getRenderer(i);typeof r=="function"&&new r(t,f,i),l.insert(i,n.index)}}),v=n.addHandler(u,"entityremoved",function(n){l.remove(n.entity)}),s=n.addHandler(t,"ondispose",y);this.dispose=y}function k(n){function o(n){var t=document.createElement("div");return t.className="item",t.style.marginRight="1px",t.entity=n,t}function s(n){var t=n.length;while(t--)f(n[t])}function f(n){n.parentNode&&n.parentNode.removeChild(n)}function u(n){var h,o,u,f,s;if(!r)return;for(h=n===k.Layout.TopBottom||n===k.Layout.BottomTop?"none":"left",((i===k.Layout.TopBottom||i===k.Layout.LeftRight)&&(n===k.Layout.BottomTop||n===k.Layout.RightLeft)||(i===k.Layout.BottomTop||i===k.Layout.RightLeft)&&(n===k.Layout.TopBottom||n===k.Layout.LeftRight))&&t.reverse(),o=0;o<t.length;o++)u=t[o],u.wrapped||(f=u.entity,s=f&&f.getDomElement&&f.getDomElement(),s?u.appendChild(s):u.appendChild(f),u.wrapped=!0),u.style.cssFloat!==undefined?u.style.cssFloat=h:u.style.styleFloat!==undefined&&(u.style.styleFloat=h),r.appendChild(u);r.appendChild(e)}var r=n,t=[],i=k.Layout.TopBottom,e=document.createElement("span");e.style.cssText="display:block;height:0;width:0;line-height:0;font-size:0;clear:both;",this.setContext=function(n){r||(r=n,u(i))},this.add=function(n){var r=o(n);t.push(r),u(i)},this.insert=function(n,r){var f=o(n);t.splice(r,0,f),u(i)},this.pop=function(){f(t.pop())},this.removeAt=function(n){s(t.splice(n,1))},this.remove=function(n){var i=t.length;while(i--)if(t[i].entity===n){this.removeAt(i);break}},this.clear=function(){s(t),t.length=0},this.setLayout=function(n){n!==i&&(u(n),i=n)}}function wi(n){var i=document.createElement("span");t(i).add_class("shadowtextDark"),n.appendChild(i),this.setColorsForDarkBackground=function(){t(i).swap_class("shadowtextDark","shadowtextLight")},this.setColorsForLightBackground=function(){t(i).swap_class("shadowtextLight","shadowtextDark")},this.setHtmlContent=function(n){i.innerHTML=n},this.setTextContent=function(n){i.innerHTML="",i.appendChild(document.createTextNode(n))}}function cr(t,i,u){function h(){p(),e=window.setTimeout(g,k)}function p(){e!=null&&window.clearTimeout(e)}function g(){e=null,f.getCopyrights(nt)}function nt(i,r){r!==l&&(l=r,n.invoke(t,"logorequirementschanged",{showCombinedLogo:l}));for(var f=i.concat(a).sort(function(n,t){return(n||"").length>(t||"").length}),e=f.length,u=0;u<e;u++)f[u]&&(f[u]='<span class = "copyrightAttribution">'+f[u]+"</span>");v.setHtmlContent(f.join(""))}function c(){d.getImageryBackground(t.getImageryId())===d.light?v.setColorsForLightBackground():v.setColorsForDarkBackground()}function b(){if(o){n.removeHandler(o),o=null;var t=s.length;while(t--)n.removeHandler(s[t]);s.length=0}}var w=r("div",u.getClassName(),i),s,o,y;u.getDomElement=function(){return w};var v=new wi(w),f=t,a=[],e=null,k=1e3,l=null;h(),c(),s=[n.addThrottledHandler(f,"copyrightchanged",h,2e3),n.addHandler(f,"imagerychanged",c),n.addHandler(f,"modechanged",c),n.addHandler(f,"viewchangestart",p)],o=n.addHandler(t,"ondispose",b),y=new function(){this.get_customAttributions=function(){return a},this.set_customAttributions=function(n){a=n,h()}},t.addComponent("copyright",y)}function vr(i,f,e){function ni(){var d,k,b,f,w;rt=n.addHandler(i,"ondispose",ti),a=r("div",e.getClassName(),fi),e.getDomElement=function(){return a},l=t(a),(bt||dt)&&l.add_event("mouseover",at).add_event("mouseout",vt).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s).add_event("click",s),h=document.createElement("a"),h.href="http://www.bing.com",h.title=u.getString("L_BingLogoTooltip_Text"),h.target="mc_bingMaps",bt?n.addHandler(i,"viewchangeend",gt):(h.onclick=function(){return!1},h.style.cursor="default"),ut=document.createElement("span"),ut.id="bingLogo",h.appendChild(ut),p=document.createElement("span"),p.id="cobrandLogo",p.style.display="none",h.appendChild(p),d=document.createElement("span"),d.className="ms-clear",d.style.cssText="float: none !important",h.appendChild(d),a.appendChild(h),n.addHandler(i,"imagerychanged",st),n.addHandler(i,"maptypechanged",st),n.addHandler(i,"logorequirementschanged",ct),st(),ct({showCombinedLogo:!1}),dt&&(k=document.createElement("div"),k.className="LogoSearchContainer",b=document.createElement("div"),b.className="LogoSearchGroup",k.appendChild(b),f=document.createElement("input"),f.id="LogoSearchInput",f.type="text",tt.useXHR&&(f.style.margin="0"),f.maxLength=60,f.className="watermark",f.value=u.getString("L_BingSearchWatermark_Text"),y=!0,b.appendChild(f),w=document.createElement("input"),w.id="LogoSearchGo",tt.useXHR||(w.type="button"),w.title=u.getString("L_BingSearchGoTooltip_Text"),b.appendChild(w),o=t(k),o.set_style({display:"none"}),v=!1,o.add_event("mouseover",ht).add_event("mouseout",lt).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s),g=t(w),g.add_event("blur",et).add_event("focus",ot).add_event("click",ft),c=t(f),c.add_event("blur",pt).add_event("focus",wt).add_event("keydown",yt),a.appendChild(k))}function ti(){rt&&(n.removeHandler(rt),rt=null),h&&n.removeHandler(gt),l&&l.remove_event("mouseover",at).remove_event("mouseout",vt).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s).remove_event("click",s),a.parentNode.removeChild(a),o&&(o.remove_event("mouseover",ht).remove_event("mouseout",lt).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s),g.remove_event("blur",et).remove_event("focus",ot).remove_event("click",ft),c.remove_event("blur",pt).remove_event("focus",wt).remove_event("keydown",yt),o.element().parentNode.removeChild(o.element())),k(),h=null,ut=null,p=null,a=null,g=null,c=null,o=null}function k(){o&&w&&(window.clearTimeout(w),w=null)}function it(){o&&b&&(k(),w=window.setTimeout(ri,2e3))}function kt(){y||c.element().value||(c.element().value=u.getString("L_BingSearchWatermark_Text"),c.add_class("watermark"),y=!0)}function ei(){y&&(c.element().value="",c.remove_class("watermark"),y=!1)}function ri(){w=null,ui(),b=!1}function ui(){o.set_style({display:"none"}),l.remove_class("Active"),o.set_style("width",null)}function gt(){if(h){var t=i.getCenter();t&&(h.href=nt.logoBingMapsLink.replace("{0}",t.latitude).replace("{1}",t.longitude).replace("{2}",i.getZoom()))}}function ct(n){t(p).set_style({display:n.showCombinedLogo?"":"none"}),l.set_style({display:ii&&!n.showCombinedLogo?"none":""})}function st(){d.getImageryBackground(i.getImageryId())===d.dark?l.add_class("dark"):l.remove_class("dark")}function ht(){k()}function lt(){v||it()}function et(){v=!1,it()}function ot(){v=!0,k()}function pt(n){et(n),kt()}function wt(n){ot(n),ei()}function ft(){var t=c.element().value,i;!y&&typeof t=="string"&&t.length>0&&(c.element().value="",kt(),t=ur.encodeUrl(t),i=nt.logoBingSearchUrl.replace("{0}",t),window.open(i,"mc_bingSearch"),it())}function yt(n){v&&n.keyCode===13&&ft()}function at(){k(),o&&!b&&(o.set_style({display:""}),b=!0,l.add_class("Active"))}function vt(){o?b&&!v&&it():l.remove_class("Active")}var fi=f,bt=e.getClickable(),dt=e.getEnableSearch(),ii=e.getShowCombinedOnly(),oi=this,ut=null,p=null,b=!1,v=!1,y=!1,w=null,l=null,o=null,c=null,g=null,a=null,h=null,rt;ni()}function tr(n,i){function w(n){for(var r=Math.floor(n),i,t=0;t<h.length;t++){i=h[t];if(r>i)return i}return 1}function p(n,t){for(var r,i=0;i<c.length;i++){r=c[i];if(n>r)return r*t}return t}function r(n){var u=Math.log(n)/y,r=Math.floor(u),t=Math.pow(10,r),i=n/t;return 1===t?w(i):p(i,t)}var y=2.3025850929940459,e=n,l=i,v=0,a=0,h=[5,2],c=[5,2.5,2],o,f,s;t(e).add_class("ScaleBar"),o=document.createElement("span"),e.appendChild(o),f=new wi(o),s=document.createElement("span"),s.className="scalerect",e.appendChild(s),this.getMaxWidth=function(){return v},this.setMaxWidth=function(n){return v=n,n},this.getActualWidth=function(){return a},this.setActualWidth=function(n){return a=n,n},this.setColorsForBackground=function(n){n===d.light?f.setColorsForLightBackground():f.setColorsForDarkBackground()},this.setScale=function(n){var f,t,i,s,e,o;l===at.kilometersMeters?(s=n*this.getMaxWidth(),s>g.metersPerKm?(t=r(s/g.metersPerKm),f=Math.floor(t*g.metersPerKm/n),i=u.getString("L_scaleBarKilometers_Text")):(t=r(s),f=Math.floor(t/n),i=u.getString("L_scaleBarMeters_Text"))):(e=n*g.feetPerMeter,o=e*this.getMaxWidth(),o>g.feetPerMile?(t=r(o/g.feetPerMile),f=Math.floor(t*g.feetPerMile/e),i=u.getString("L_scaleBarMiles_Text")):l===at.milesFeet?(t=r(o),f=Math.floor(t/e),i=u.getString("L_scaleBarFeet_Text")):(t=r(o/g.feetPerYard),f=Math.floor(t*g.feetPerYard/e),i=u.getString("L_scaleBarYards_Text"))),this.setControlScale(f,i.replace("{num}",t))},this.setControlScale=function(n,t){this.setActualWidth(n+2),e.style.width=this.getActualWidth().toFixed()+"px",f.setTextContent(t)}}function pr(n){var e=200,u=n,i,f,r;t(u).add_class("DoubleScaleBar"),_scaleBarMiElement=document.createElement("span"),i=new tr(_scaleBarMiElement,at.milesFeet),i.setMaxWidth(e/2),u.appendChild(_scaleBarMiElement),f=document.createElement("span"),r=new tr(f,at.kilometersMeters),r.setMaxWidth(e/2),u.appendChild(f),this.setColorsForBackground=function(n){r.setColorsForBackground(n),i.setColorsForBackground(n)},this.setScale=function(n){r.setScale(n),i.setScale(n)}}function yr(t,i,u){function s(){o.setScale(t.getMetersPerPixel())}function l(){o.setColorsForBackground(d.getImageryBackground(t.getImageryId()))}function c(){if(e){n.removeHandler(e),e=null;var t=f.length;while(t--)n.removeHandler(f[t]);f.length=0}}var h=r("div",u.getClassName(),i),o,f,e;u.getDomElement=function(){return h},o=new pr(h),o.setScale(t.getMetersPerPixel()),f=[n.addHandler(t,"viewchangeend",s),n.addHandler(t,"imagerychanged",l),n.addHandler(t,"modechanged",s)],e=n.addHandler(t,"ondispose",c)}function ir(i,r){function vt(){var n=i.getOptions();return!(n.disablePanning||n.disableMouseInput||n.disableUserInput)}function at(){var n=i.getOptions();return!(n.disableZooming||n.disableMouseInput||n.disableUserInput)}function bt(n){var r=Math.round(i.getTargetZoom()),t=1<<r,u=new pt(r,Math.floor(n.x*t),Math.floor(n.y*t));return dt.fromTileId(u,!1)}function kt(){var n=i.getOptions().labelOverlay;ot=n===ft.hidden?!0:r}function ri(){var n=null,t=i.getImageryId();switch(t){case"Road":n=fi;break;case"Aerial":n=hi;break;case"EnhancedBirdseye":case"NativeBirdseye":u.removeLayer(l),l=null;break;default:c.removeLayer(l),l=null,st()}n!==l&&(et(),c.removeLayer(l),c.addLayer(n),l=n,rt())}function oi(n){p=n}function ui(){s&&(n.removeHandler(s),s=null,h||(p=null,h=n.addHandler(i,"mousemove",oi)),o&&it())}function rt(){h&&(n.removeHandler(h),h=null),s||(s=n.addHandler(i,"mousemove",lt));var r=Math.round(i.getTargetZoom()),t=y.getMapTargetMercatorBounds(i);c.loadQuadkeysForMercatorBounds(t,r),p&&(lt(p),p=null)}function ei(n){return v&&(window.clearTimeout(v),v=null),n.handled=!1,!1}function si(n){if(n.targetType!=="map"&&n.target.pointerEvents!=="none"||n.mouseMoved)return n.handled=!1,!1;if(v)return n.handled=!0,!0;var i=new f(n.getX(),n.getY()),t=g(i);return t?(v=window.setTimeout(function(){ci(t.hotRegion,i,t.worldPoint)},250),n.handled=!0,!0):(n.handled=!1,!1)}function ci(t,r,f){var s,h,a,o;v=null,s={hotRegion:t,cancelDefault:!1,clickLocation:i.tryPixelToLocation(r,null,{normalizeLongitude:!1})},n.invoke(u,"click",s),h=t.bmv;if(!s.cancelDefault&&h){var y=h.tl,l=h.br,b=h.z,p=h.c,w=360*Math.floor(f.x),c=180*Math.floor(f.y),e;y&&l?(a=ti.fromEdges(y.y+c,y.x+w,l.y+c,l.x+w),ut(a.center,s.clickLocation),e={bounds:a,animate:!0},vt()||(o=i.getCenter(),ut(o,s.clickLocation),e.center=o),at()||(e.center=e.center||e.bounds.center,delete e.bounds),i.setView(e)):p&&b&&(o=vt()?new ii(p.y+c,p.x+w):i.getCenter(),ut(o,s.clickLocation),e={center:o,zoom:at()?b:i.getZoom(),animate:!0},i.setView(e))}}function ut(n,t){while(n.longitude-t.longitude>180&&n.longitude>t.longitude)n.longitude-=360;while(t.longitude-n.longitude>180&&n.longitude<t.longitude)n.longitude+=360}function g(n){var s=i.getMode().tryPixelToMercatorPoint,t,l,r,e,u,o;if(s){t=s(n),l=new f(t.x,t.y),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1;var v=bt(t),h=c.getTileHotRegionsForQuadkey(v),a=h.length;while(a--){r=h[a];if(ot&&r.type==="label")continue;if(r.getMercatorBounds().contains(t)){e=r.boundRegions,u=e.length;while(u--){o=e[u];if(o.getMercatorBounds().contains(t))if(o.isMercatorPointInBoundRegion(t))return{hotRegion:r,worldPoint:l}}}}}return null}function it(){var t={hotRegion:o,cancelDefault:!1};n.invoke(u,"leave",t),!t.cancelDefault&&a&&(ht.set_style({cursor:a}),a=null),o=null}function lt(i){var s;if(i.targetType!=="map"&&i.target.pointerEvents!=="none")if(o)var c=!0,l=!1,e=null;else return;if(!c)var v=new f(i.getX(),i.getY()),h=g(v),e=h&&h.hotRegion,c=o&&(!e||e.id!==o.id),l=e&&(!o||o.id!==e.id);c&&it(),o=e,l&&(s={hotRegion:e,cancelDefault:!1},n.invoke(u,"enter",s),!s.cancelDefault&&e&&e.bmv&&(!r||e.type!=="label")&&(a=ht.get_style("cursor"),tt.isWebkit&&a.toLowerCase().indexOf("/cursors/grab.cur")!==-1?a=wt.Grab:t.Browser.is_ie&&(a+=", "+wt.Grab),(vt()||at())&&ht.set_style({cursor:"pointer"})))}function et(){s||(s=n.addHandler(i,"mousemove",lt)),w||(w=n.addHandler(i,"click",si)),d||(_mapMouseClickDoubleHandle=n.addHandler(i,"dblclick",ei)),b||(b=n.addHandler(i,"viewchangeend",rt)),k||(k=n.addHandler(i,"viewchangestart",ui))}function st(){h&&(n.removeHandler(h),h=null),s&&(n.removeHandler(s),s=null),w&&(n.removeHandler(w),w=null),d&&(n.removeHandler(d),d=null),b&&(n.removeHandler(b),b=null),k&&(n.removeHandler(k),k=null),o&&it()}function yt(){c.getLayerCount()>0?et():st()}var u=this,s,w,d,ni,gt,b,k,ot=r,c=new wr,wt={Grab:"url("+nt.cursorPath+"grab.cur)"+tt.cursorHotspot+", default"},ht=t(i.getRootElement()),a=null,o=null,fi=new ct(e.Globals.hotRegionsRoadUrl,null,i,"r"),hi=new ct(e.Globals.hotRegionsAerialWithLabelsUrl,null,i,"a"),l=null,p,h,v;u.getHotRegionAtPoint=function(n){var t=g(n);return t&&t.hotRegion},u.enable=function(){et(),ni=n.addHandler(i,"maptypechanged",kt),gt=n.addHandler(i,"imagerychanged",ri),kt(),ri()},u.disable=function(){st(),n.removeHandler(gt),n.removeHandler(ni),o=null},u.createLayer=function(n,t,i,r){return new ct(n,t,i,r)},u.addLayer=function(n,t){c.addLayer(n,t),yt(),rt()},u.removeLayer=function(n){c.removeLayer(n),yt()},i.addComponent("hotRegions",u),u.enable()}function bt(n,t){function a(n){var i=[],r=n.length,t;while(r--)t=n[r],i.push(new f(t.x,t.y));return i}var i,e,u,r,o,c,s;n.boundRegions=[];var v=n.boundRegions,l=n.brs,h=l.length;while(h--)i=l[h],ci(i)?(r=a(i),r.push(r[0]),e=new ni(t,r),v.push(e)):i&&i.x&&i.y&&i.r&&(e=new gt(t,new f(i.x,i.y),i.r),v.push(e));if(n.hbrs){n.highlightBoundRegions=[];var p=n.highlightBoundRegions,y=n.hbrs,h=y.length;while(h--){u=y[h];if(u)switch(u.t){case"polygon":r=a(u.v),r.push(r[0]),o=new ni(t,r),p.push(o);break;case"circle":o=new gt(t,new f(u.x,u.y),u.r),p.push(o)}}}return c=/^YN/i,s=n.ypid,s&&c.test(s)&&(n.ypid=s.substring(2)),n.getLocationCenter=bt.prototype.getLocationCenter,n.getMercatorBounds=bt.prototype.getMercatorBounds,n}function fi(n){this.hotRegions=n}function ni(n,t){this._tileId=n,this._quadkeyTilePoints=t}function gt(n,t,i){this._tileId=n,this._quadkeyTilePointCenter=t,this._quadkeyTilePointRadius=i}function lr(i){function b(n){var r=!1,t;return n.hotRegion.type==="vm"&&(e.VenueMaps?(h||(h=new e.VenueMaps.VenueMapFactory(i)),t=h.getActiveVenueMap(),t&&n.hotRegion.vmid===t.id||(r=!0)):r=!0),r}function ct(n){b(n)&&(n.cancelDefault=!0,s!==n.hotRegion.vmid&&ut(n.hotRegion.vmid))}function lt(n){b(n)&&(n.cancelDefault=!0,o=l.get_style("cursor"),tt.isWebkit&&o.toLowerCase().indexOf("/cursors/grab.cur")!==-1?o=k.Grab:t.Browser.is_ie&&(o+=", "+k.Grab),s===n.hotRegion.vmid?l.set_style({cursor:"wait"}):l.set_style({cursor:"pointer"}),f=n.hotRegion,ht())}function vt(n){b(n)&&(o&&(l.set_style({cursor:o}),o=null),w(),f=null)}function w(){g(),a&&(i.entities.remove(a),a=null)}function ht(){var r,u,n,t;w();if(f){a=new di({zIndex:-1}),r=f.highlightBoundRegions?f.highlightBoundRegions:f.boundRegions,u=r.length;while(u--)n=r[u],n.type==="polygon"&&(t=new er(n.getLocations(),{strokeThickness:1,strokeColor:new yi(255,0,0,0),fillColor:new yi(0,0,0,0)}),t.pointerEvents="none",a.push(t));i.entities.push(a),s!==f.vmid&&yt()}}function yt(){if(!r){d=n.addHandler(i,"mousemove",at),r=document.createElement("span"),r.style.cssText="position:absolute;visibility:hidden;background-color:white;border: 1px solid black;padding:5px;";var t=f.name?u.getString("L_VenueMapExplorerTooltip_Text").replace("{0}",f.name):u.getString("L_VenueMapExplorerTooltip_Text").replace(" {0}","");r.appendChild(document.createTextNode(t)),i.getRootElement().appendChild(r)}}function g(){r&&(n.removeHandler(d),r.parentNode.removeChild(r),r=null)}function at(n){r.style.visibility="visible",r.style.left=i.getWidth()/2+16+n.getX()+"px",r.style.top=i.getHeight()/2+16+n.getY()+"px"}function st(){v||(v=n.addHandler(i.getComponent("hotRegions"),"click",ct),p=n.addHandler(i.getComponent("hotRegions"),"enter",lt),y=n.addHandler(i.getComponent("hotRegions"),"leave",vt))}function rt(){v&&(n.removeHandler(v),v=null),p&&(n.removeHandler(p),p=null),y&&(n.removeHandler(y),y=null)}function ut(n){ot(n),e.loadModule("Microsoft.Maps.VenueMaps",{callback:function(){h||(h=new e.VenueMaps.VenueMapFactory(i));var t=h.getActiveVenueMap();t&&t.dispose(),h.create({venueMapId:n,success:ft,error:et})}})}function ft(n){if(s===n.id){var r=n.bestMapView;r.animate=!0,i.setView(r),n.show(),it(!0)}}function ot(t){s=t,f&&(l.set_style({cursor:"wait"}),g()),n.invoke(c,"activationstart",t)}function it(t){var i=s;s=null,f&&(o&&(l.set_style({cursor:o}),o=null),w()),n.invoke(c,"activationend",{isSuccess:t,venueMapId:i})}function et(n,t){s===t.venueMapId&&it(!1)}var c=this,v,p,y,h,s,o,k={Grab:"url("+nt.cursorPath+"grab.cur)"+tt.cursorHotspot+", default"},l=t(i.getRootElement()),f,a,r,d;c.enable=function(){st()},c.disable=function(){rt(),s=null},i.addComponent("venueMapsExplorer",c),c.enable()}function et(){return null}function hr(n,t){function o(r,f){var c,e,o,h;r||f&&f.httpStatus===401?(c=r&&r.authenticationResultCode=="ValidCredentials",i=c&&typeof r.sessionId=="string"&&r.sessionId.length>0?r.sessionId:null,c||(e=document.createElement("div"),e.style.cssText="position:absolute; width:100%; top:50%; text-Align:center",o=document.createElement("div"),o.innerHTML=u.getString("L_invalidcredentials_text"),o.style.cssText="background: #f8f7f5; padding:10px; color: #000;",e.appendChild(o),h=n&&n.getRootElement(),h&&h.appendChild(e))):i=t,s()}var e=this,f=nt.logServiceUriFormat,r,h,i;if(f){r=[],f=f.replace(/{credentials}/,t),this.getCredentials=function(n){r.push(n)};function s(){e.getCredentials=function(n){n(i)};var n=r.length;while(n--)e.getCredentials(r[n])}wt.getObjectAsyncWithNoJsonso(f,o,ri.getNext(),1e4)}else i=t,this.getCredentials=function(n){n(i)}}function c(n){function i(i){if(!i||i.handled!==!0){t&&t.dispose();var r=c.getRenderer(n.overlays);typeof r=="function"&&(t=new r(n,n.getRootElement(),n.overlays))}}var t;this.update=i}function si(n){this.setOptions(n)}function li(n){this.setOptions(n)}function ei(n){this.setOptions(n)}function ut(n){this._namedEntities={},ut.baseConstructor.call(this,n),this.setOptions(n)}function ui(n){this.setOptions(n)}function oi(n){this.setOptions(n)}function vi(n){this.setOptions(n)}function ai(n){this.setOptions(n)}var e=window.Microsoft.Maps,a=e.InternalNamespaceForDelay,gi=a.KeyEventArgs,u=Microsoft.Maps.Resources,p=a.Common,or=a.DelayMap,ri=a.IdGenerator,wt=a.Network,nr=a.PRF,it,b,d,at,g,st,h;nr.start("mapdelay");var t=e.Gimme,nt=e.Globals,ru=e.Map,f=e.Point,ft=e.LabelOverlay,n=e.Events,ti=e.LocationRect,ii=e.Location,fu=e.Pushpin,w=e.MapTypeId,di=e.EntityCollection,rt=a.MercatorCube,pi=a.SpatialCache,dt=e.QuadKey,pt=a.TileId,uu=e.AltitudeReference,kt=a.Rect,yi=e.Color,er=e.Polygon,lt=a.MapMath,tt=a.Quirks,ur=a.IOSec,v=new function(){function s(n,t,i){var r=document.createElement(n||"div");return t&&(r.className=t),i&&i.appendChild(r),r}function e(n){var i,t=u.length;while(t--)u[t][0]===n&&(i=u[t][1]);return i}function o(t,i,r){n.invoke(t,i,r)}function f(n){n.stopPropagation()}function r(n){h=!0,n.stopPropagation()}var u=[],h=!1;this.addIgnoreEvents=function(n){t(n).add_event("mousedown",i).add_event("mouseup",i).add_event("mousewheel",i).add_event("dblclick",i).add_event("contextmenu",i).add_event("keydown",f).add_event("keyup",i).add_event("click",i).add_event("touchstart",r).add_event("touchmove",r).add_event("touchend",r).add_event("touchcancel",r)},this.removeIgnoreEvents=function(n){t(n).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousewheel",i).remove_event("dblclick",i).remove_event("contextmenu",i).remove_event("keydown",f).remove_event("keyup",i).remove_event("click",i).remove_event("touchstart",r).remove_event("touchmove",r).remove_event("touchend",r).remove_event("touchcancel",r)},this.createElement=s,this.createToolButton=function(n,t){var i=s("a","NavBar_button NavBar_toolButton "+(n||""));return i.href="#",t&&(i.title=t),i},this.registerNavigationBar=function(n,t){u.push([n,t])},this.removeNavigationBar=function(n){var t=u.length;while(t--)if(u[t][0]===n){u.splice(t,1);break}},this.reportAction=function(n,t){var r=e(n),i;r&&(i=t.currentTarget,i&&o(r,"navbaraction",{id:i.id,typeName:i.className,title:i.title}))},this.getNavBar=e,this.invokeEvent=o,this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=f,this.isTouch=function(){return h},this.addClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n+(n.search(i)===-1?" "+t:"")},this.removeClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n.replace(i,"$1").replace(/^\s+|\s+$/g,"")}};a.NavigationCommon=v,it={auto:new function(){p.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeAutoName_Text")}}),p.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeAutoDescription_Text")}})},r:new function(){p.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeRoadName_Text")}}),p.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeRoadDescription_Text")}})},a:new function(){p.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeAerialName_Text")}}),p.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeAerialDescription_Text")}})},be:new function(){p.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeBirdsEyeName_Text")}}),p.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeBirdsEyeDescription_Text")}})},cb:new function(){p.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeCollinsBartName_Text")}}),p.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeCollinsBartDescription_Text")}})},os:new function(){p.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeOrdnanceSurveyName_Text")}}),p.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeOrdnanceSurveyDescription_Text")}})}},b={left:0,middle:1,right:2,getName:function(n){switch(n){case b.left:return"left";case b.middle:return"middle";case b.right:return"right"}return""},isValid:function(n){return n===b.left||n===b.middle||n===b.right}},e.ClientRegion=b,k.Layout={TopBottom:"topBottom",BottomTop:"bottomTop",LeftRight:"leftRight",RightLeft:"rightLeft"},d={light:0,dark:1},d.getImageryBackground=function(n){return n==="Aerial"||n==="EnhancedBirdseye"||n==="NativeBirdseye"||n==="streetside"?d.dark:d.light},at={milesFeet:0,milesYards:1,kilometersMeters:2},g={metersPerKm:1e3,yardsPerMeter:1.0936133,yardsPerMile:1760,feetPerYard:3,feetPerMeter:3.2808399,feetPerMile:5280},bt.prototype={getLocationCenter:function(){var i=this.highlightBoundRegions?this.highlightBoundRegions:this.boundRegions,u=0,e=0,n=i.length,r=n,t;while(r--)t=i[r].getMercatorBounds().getCenter(),u+=t.x,e+=t.y;return this._locationCenter=rt.toLocation(new f(u/n,e/n)),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorBounds:function(){var i=null,t=null,u=null,f=null,h=this.boundRegions,r=this.boundRegions.length-1,n;if(r>-1){n=h[r].getMercatorBounds(),i=n.y,t=n.x,u=n.getRight(),f=n.getBottom();while(r--){var n=h[r].getMercatorBounds(),c=n.y,s=n.x,e=n.getRight(),o=n.getBottom();c<i&&(i=c),o>f&&(f=o),s<t&&(t=s),e>u&&(u=e)}}return this._mercatorBounds=new kt(t,i,u-t,f-i),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds}},fi.prototype={getHotRegionsForTile:function(n){var r={},a,s,t,l,e,u;for(this._tileIndexedHotRegions=r,a=n.length,s=this.hotRegions,t=0,l=s.length;t<l;t++){var o=s[t],i=o.getMercatorBounds(),v=new f(i.x,i.y),p=new f(i.getRight(),i.getBottom()),w=y.getMercatorBoundsDescriptor(v,p,a),h=y.getQuadkeysForBounds(w),c=h.length;while(c--)e=h[c],u=r[e],u?u.push(o):r[e]=[o]}return this.getHotRegionsForTile=function(n){var t=this._tileIndexedHotRegions[n];return t?t:[]},this.getHotRegionsForTile(n)}};var ct=function(n,t,i,r){function d(n,t){return n.z-t.z}function c(n){var t;return t=n==="l1"?1:n==="l2"?2:n.length+2}function rt(n,t){var f=c(n),o=e[f],r=h[f],p,v,s,u,w,a;o||(o=e[f]={},r=h[f]=[]);if(o[n])return!1;o[n]=t,r.push(n),p=(Math.ceil(i.getHeight()/1024)+2*l)*(Math.ceil(i.getWidth()/1024)+2*l);while(r.length>p){for(v||(v=tt(y.getMapTargetMercatorBounds(i),Math.max(f-2,0))),s=!1,u=0,w=r.length;u<w;u++)if(it(v,r[u])===-1){a=r.splice(0,u+1),delete o[a.pop()],r=r.concat(a),s=!0;break}if(!s)break}return!0}function it(n,t){var i=n.length;while(i--)if(n[i]===t)return i;return-1}function tt(n,t){var u=new f(n.left,n.top),r=new f(n.right,n.bottom),i=y.getMercatorBoundsDescriptor(u,r,t);return y.getQuadkeysForBounds(i)}function k(n,t){var i,f,e;delete u[t];if(n&&b(n.hrs)){i=null,i=t==="l1"?new pt(-1,0,0):t==="l2"?new pt(0,0,0):dt.toTileId(t);var r=[],o=n.hrs,s=o.length;while(s--)f=new bt(o[s],i),r.push(f);r.sort(d),e=new fi(r),rt(t,e)}}function s(i){var v=c(i),a=e[v],f,s,o,l,h;a&&a[i]||(p(),u[i]||(u[i]={requestTime:+new Date},f="",s="",i==="l1"?s="&lod=1":i!=="l2"&&(f=i),o="0",f!==""&&(o=f.charAt(f.length-1)),l=typeof t=="function"?t(i):n,h=l.replace("{subdomain}",o).replace("{quadkey}",f).replace("{jsonp}",nt).replace("{jsonso}",encodeURIComponent(r+"|"+i))+s,wt.getObjectAsyncCacheFriendly(h)))}function a(){u={}}function p(){var i=+new Date,t,n;for(t in u)n=u[t].requestTime,n&&i-n>g&&delete u[t]}function v(n){var r=y.tileQuadkeyToSheetQuadkey(n),u=n.length,i=e[u],t;if(i){t=i[r];if(t)return t.getHotRegionsForTile(n);s(r)}return[]}function w(n,t){var i;if(t===1)s("l1");else if(t===2)s("l2");else{var c=Math.max(t-2,0),a=new f(n.left,n.top),h=new f(n.right,n.bottom),l=y.getMercatorBoundsDescriptor(a,h,c),o=y.getQuadkeysForBounds(l),u=e[t],r=o.length;while(r--)i=o[r],u&&u[i]||s(i)}}function b(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"}var o=this,nt="microsoftMapsHotRegionsCacheCallback",e={},h={},l=1,g=1e4,u={};o.getTileHotRegionsForQuadkey=v,o.loadQuadkeysForMercatorBounds=w,o.getHotRegionsNetworkCallback=k,o.clearRequestedQuadkeys=a,o.getId=function(){return r}},wr=function(){function i(t){var i=n.length;while(i--)if(n[i].layer.getId()===t)return i;return null}function o(t,r){if(r){var f=decodeURIComponent(r).split("|"),e=f[0],o=f[1],u=i(e);u!==null&&n[u].layer.getHotRegionsNetworkCallback(t,o)}}function c(t){var i=[],r=n.length;while(r--)i=i.concat(n[r].layer.getTileHotRegionsForQuadkey(t));return i}function h(t,i){var r=n.length;while(r--)n[r].layer.loadQuadkeysForMercatorBounds(t,i)}function u(n,t){return t.zIndex-n.zIndex}function r(t,r){t instanceof ct&&(r||(r=0),i(t.getId())===null&&(n.push({zIndex:r,layer:t}),n.sort(u)))}function e(t){if(t instanceof ct){var r=i(t.getId());r!==null&&(n.splice(r,1),t.clearRequestedQuadkeys())}}function f(){return n.length}var t=this,s="microsoftMapsHotRegionsCacheCallback",n=[];t.addLayer=r,t.removeLayer=e,t.getLayerCount=f,t.getTileHotRegionsForQuadkey=c,t.loadQuadkeysForMercatorBounds=h,window[s]=o},y=new function(){this.tilePixelToLocation=function(n,t){var u=this._tilePixelToMapPixel(n,t),r=this._mapPixelToMercatorPoint(n.levelOfDetail,u);return rt.toLocation(r)},this.tilePixelToMapPixel=function(n,t){return new f(n.x*1024+t.x,n.y*1024+t.y)},this.mapPixelToMercatorPoint=function(n,t){var i,r;return i=n<0?1/(1<<Math.abs(n)):1<<n,r=new f(t.x/i/1024,t.y/i/1024)},this.getMapTargetMercatorBounds=function(n){var r=n.getMode().tryPixelToMercatorPoint,u,t;if(r){var e=n.getHeight()/2,o=n.getWidth()/2,s=new f(-o,-e),i=r(s);return i.x=(i.x%1+1)%1,i.y=(i.y%1+1)%1,u=new f(o,e),t=r(u),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1,{left:i.x,right:t.x,top:i.y,bottom:t.y}}return null},this.getQuadkeysForBounds=function(n){var h=n.levelOfDetails,o=n.tileIdXCount,c=n.tileIdYCount,a=n.tileIdX0,l=n.tileIdY0,s=n.tileIdCount,r=[],i,u,e,t,f;while(o--){i=c,u=(a+o)%s;while(i--)e=(l+i)%s,t=dt.fromTileId(new pt(h,u,e)),t.length===0&&(f=0,f++),r.push(t)}return r},this.getMercatorBoundsDescriptor=function(n,t,i){var u=pi.mercatorXYToTileId(n,i),o=pi.mercatorXYToTileId(t,i),r=1<<i,s=(o.x-u.x+r)%r+1,h=u.x,e,f;return s===1&&t.x<n.x&&(s=r,h=0),f=(o.y-u.y+r)%r+1,e=u.y,f===1&&t.y<n.y&&(f=r,e=0),{mercatorTL:n,mercatorBR:t,levelOfDetails:i,tileIdTL:u,tileIdBR:o,tileIdX0:h,tileIdY0:e,tileIdXCount:s,tileIdYCount:f,tileIdCount:r}},this.tileQuadkeyToSheetQuadkey=function(n){var i=n.length,t="l1";return i>2?t=n.substr(0,i-2):i===2&&(t="l2"),t}};ni.prototype={type:"polygon",getLocations:function(){var n,t;this._locations=[];var r=this._locations,u=this.getMercatorPoints(),i=u.length;while(i--)n=u[i],t=rt.toLocation(n),r.push(t);return this.getLocations=function(){return this._locations},r},getMercatorPoints:function(){var n,t;this._mercatorPoints=[];var r=this._mercatorPoints,u=this.getMapPixels(),i=u.length;while(i--)n=u[i],t=y.mapPixelToMercatorPoint(this._tileId.levelOfDetail,n),r.push(t);return this.getMercatorPoints=function(){return this._mercatorPoints},r},getMapPixels:function(){var t;this._mapPixels=[];var i=this._mapPixels,r=this._quadkeyTilePoints,n=r.length;while(n--)t=y.tilePixelToMapPixel(this._tileId,r[n]),i.push(t);return this.getMapPixels=function(){return this._mapPixels},i},getMercatorBounds:function(){var e=null,o=null,f=null,u=null,t=this.getMercatorPoints(),n=t.length-1,i,r;if(n>-1){e=f=t[n].x,o=u=t[n].y;while(n--)i=t[n].x,r=t[n].y,i>e?e=i:i<f&&(f=i),r>o?o=r:r<u&&(u=r)}return this._mercatorBounds=new kt(f,u,e-f,o-u),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){for(var i=this.getMercatorPoints(),h=i.length-1,l=n.x,e=n.y,f=!1,t=0,r=h-1;t<h;r=t++){var u=i[t].y,o=i[r].y,s=i[t].x,c=i[r].x;u>e!=o>e&&l<(c-s)*(e-u)/(o-u)+s&&(f=!f)}return f}},gt.prototype={getLocations:function(){var n=this.getMercatorBounds(),o=new f(n.x,n.y),e=new f(n.getRight(),n.y),h=new f(n.getRight(),n.getBottom()),s=new f(n.x,n.getBottom()),t=rt.toLocation(o),r=rt.toLocation(e),i=rt.toLocation(h),u=rt.toLocation(s);return this._locationBounds=[t,r,i,u,t],this.getLocations=function(){return this._locationBounds},this._locationBounds},type:"circle",getLocationCenter:function(){return this._locationCenter=rt.toLocation(this.getMercatorCenter()),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorCenter:function(){return this._mercatorCenter=y.mapPixelToMercatorPoint(this._tileId.levelOfDetail,this.getMapCenter()),this.getMercatorPoints=function(){return this._mercatorCenter},this._mercatorCenter},getMercatorRadius:function(){return this._mercatorRadius=y.mapPixelToMercatorPoint(this._tileId.levelOfDetail,new f(0,this._quadkeyTilePointRadius)).y,this.getMercatorRadius=function(){return this._mercatorRadius},this._mercatorRadius},getPixelRadius:function(){return this._quadkeyTilePointRadius},getMapCenter:function(){return this._mapCenter=y.tilePixelToMapPixel(this._tileId,this._quadkeyTilePointCenter),this.getMapCenter=function(){return this._mapCenter},this._mapCenter},getMercatorBounds:function(){var i=this.getMercatorCenter(),n=this.getMercatorRadius(),t=2*n;return this._mercatorBounds=new kt(i.x-n,i.y-n,t,t),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){var r=this.getMercatorCenter(),u=this.getMercatorRadius(),t=n.x-r.x,i=n.y-r.y;return t*t+i*i-u*u<=0}};var i=v.ignoreEvent,s=v.stopPropagation,l=v.reportAction,o=v.invokeEvent,r=v.createElement,vt=v.createToolButton,ot=v.addIgnoreEvents,hi=v.removeIgnoreEvents,ht=v.isTouch,yt=v.addClass,fr=v.removeClass,rr=p.extend,ci=p.isArray;st=or.prototype,st.showOverlays=function(t){var r,d,i,nt,y,b,v,p,ft,k,u,l,g,o,s,f,rt,ot,w,et,h,tt,a;if(this._map){r=this._map,d=!1,e.Themes&&(d=r.getTheme()instanceof e.Themes.BingTheme),i=new ut({className:"MicrosoftNav"}),i.setNextSibling(r.getRootElement().firstChild),nt={breadcrumb:{overlayClass:yt(i.getClassName(),"NavBar_breadcrumb"),constructor:ai,args:t,displayField:"showBreadcrumb",defaultDisplay:!1},compass:{constructor:ei},zoom:{constructor:li},modeselector:{constructor:si,args:t,displayField:"showMapTypeSelector",defaultDisplay:!0,postCreate:function(n,t){b=new kr(r,t,n)}}},y=d?["modeselector","breadcrumb","zoom","compass"]:["breadcrumb","compass","zoom","modeselector"];if(t.showDashboard!==!1){for(v=new ut({className:"OverlaysTL",stopPropagation:!0}),t.showDualMapTypeSelector&&(i.setOptions({className:yt(i.getClassName(),"NavBar_typeButton_count2")}),t.mapTypes=[]),ft=y.length,p=0;p<ft;p++){k=y[p],u=nt[k];if(u){if(u.displayField){l=t[u.displayField];if(l!==undefined&&!l||l===undefined&&!u.defaultDisplay)continue}u.overlayClass&&i.setOptions({className:yt(i.getClassName(),u.overlayClass)}),g=new u.constructor(u.args),v.addNamedEntity(k,g),u.postCreate&&u.postCreate(g,v)}}i.addNamedEntity("overlaysTL",v)}(t.showScalebar!==!1||t.showCopyright!==!1||t.showLogo!==!1)&&(s=new ut({className:"OverlaysBL"}),s.setParentOverride(r.getRootElement()),f=new ut({className:"OverlaysBR"}),f.setParentOverride(r.getRootElement()),t.showLogo!==!1&&(rt=new oi(t),o=t.logoPosition==="bottomLeft"?s:f,o.addNamedEntity("logo",rt)),t.showScalebar!==!1&&(ot=new vi,o=t.scalebarPosition==="bottomLeft"?s:f,o.addNamedEntity("scalebar",ot)),t.showCopyright!==!1&&(w={},t.copyrightStacked===!0&&(w.className="CopyrightContainer stacked"),et=new ui(w),o=t.copyrightPosition==="bottomLeft"?s:f,o.addNamedEntity("copyright",et)),t.copyrightPosition==="bottomRight"&&t.showLogo!==!1&&f.setOptions({className:"OverlaysBR-logoAware"}),i.addNamedEntity("overlaysBR",f),i.addNamedEntity("overlaysBL",s));function it(){var n=i.getClassName();h&&(n=fr(n,"MapTypeId_"+h)),h=r.getMapTypeId(),n=yt(n,"MapTypeId_"+h),i.setOptions({className:n})}tt=n.addHandler(r,"maptypechanged",it),it();function st(){a&&(n.removeHandler(a),a=null,n.removeHandler(tt))}a=n.addHandler(r,"ondispose",st),r.overlays=i,n.invoke(r,"overlayscreationstart",{map:r,overlays:i}),this._overlays||(this._overlays=new c(r),this._overlays.update()),b&&r.addComponent("navigationBar",b)}},st.showHotRegions=function(n){this._map&&new ir(this._map,n)},st.showVenueMapsExplorer=function(){this._map&&new lr(this._map)},st.authenticate=function(n){this._map&&(this._authentication=new hr(this._map,n))},st.getCredentials=function(n){this._map&&this._authentication.getCredentials(n)},c.renderers={},c.registerOverlay=function(n,t){c.renderers[n]=t},c.getRenderer=function(n){return c.renderers[n.toString()]},a.Overlays=c,si.prototype={_className:"NavBar_modeSelectorControlContainer",_mapTypes:null,_disableBirdseye:!1,getDomElement:et,getClassName:function(){return this._className},getMapTypes:function(){return this._mapTypes},getDisableBirdseye:function(){return this._disableBirdseye},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),ci(t.mapTypes)&&(this._mapTypes=t.mapTypes,i=!0),typeof t.disableBirdseye=="boolean"&&(this._disableBirdseye=t.disableBirdseye,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ModeSelectorControl]"}},c.registerOverlay("[ModeSelectorControl]",nu),li.prototype={_className:"NavBar_zoomControlContainer",_zoomInVisible:!0,_zoomOutVisible:!0,_zoomBarVisible:!0,_zoomBarToggle:!0,getDomElement:et,getClassName:function(){return this._className},getZoomInVisible:function(){return this._zoomInVisible},getZoomOutVisible:function(){return this._zoomOutVisible},getZoomBarVisible:function(){return this._zoomBarVisible},getZoomBarToggle:function(){return this._zoomBarToggle},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.zoomInVisible=="boolean"&&(this._zoomInVisible=t.zoomInVisible,i=!0),typeof t.zoomOutVisible=="boolean"&&(this._zoomOutVisible=t.zoomOutVisible,i=!0),typeof t.zoomBarVisible=="boolean"&&(this._zoomBarVisible=t.zoomBarVisible,i=!0),typeof t.zoomBarToggle=="boolean"&&(this._zoomBarToggle=t.zoomBarToggle,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ZoomControl]"}},c.registerOverlay("[ZoomControl]",tu),ei.prototype={_className:"NavBar_compassControlContainer",_compassVisible:!0,_rotateVisible:!0,getDomElement:et,getClassName:function(){return this._className},getCompassVisible:function(){return this._compassVisible},getRotateVisible:function(){return this._rotateVisible},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.compassVisible=="boolean"&&(this._compassVisible=t.compassVisible,i=!0),typeof t.rotateVisible=="boolean"&&(this._rotateVisible=t.rotateVisible,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CompassControl]"}},c.registerOverlay("[CompassControl]",sr),rr(ut,di),h=ut.prototype,h.getDomElement=et,h._nextSibling=null,h.getNextSibling=function(){return this._nextSibling},h.setNextSibling=function(n){this._nextSibling=n},h._parentOverride=null,h.getParentOverride=function(){return this._parentOverride},h.setParentOverride=function(n){this._parentOverride=n},h._className="",h.getClassName=function(){return this._className},h._stopPropagation=!1,h.getStopPropagation=function(){return this._stopPropagation},h.setOptions=function(t,i){var r=ut.superClass.setOptions.call(this,t,!0);return t&&(typeof t.className=="string"&&(this._className=t.className,r=!0),typeof t.stopPropagation=="boolean"&&(this._stopPropagation=t.stopPropagation,r=!0)),r&&!i&&n.invoke(this,"entitychanged",{entity:this}),r},h.addNamedEntity=function(n,t){this._namedEntities[n]=t,this.push(t)},h.insertNamedEntity=function(n,t,i){this._namedEntities[n]=t,this.insert(t,i)},h.getNamedEntity=function(n){return this._namedEntities[n]},h.removeNamedEntity=function(n){var t=this._namedEntities[n];t&&(delete this._namedEntities[n],this.remove(t))},h.toString=function(){return"[OverlayEntityCollection]"},c.registerOverlay("[OverlayEntityCollection]",ar),ui.prototype={_className:"CopyrightContainer",getDomElement:et,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CopyrightControl]"}},c.registerOverlay("[CopyrightControl]",cr),oi.prototype={_className:"LogoContainer",_clickable:!0,_enableSearch:!0,_showCombinedOnly:!1,getDomElement:et,getClassName:function(){return this._className},getClickable:function(){return this._clickable},getEnableSearch:function(){return this._enableSearch},getShowCombinedOnly:function(){return this._showCombinedOnly},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.clickable=="boolean"&&(this._clickable=t.clickable,i=!0),typeof t.enableSearch=="boolean"&&(this._enableSearch=t.enableSearch,i=!0),t.showLogo==="combined"&&(this._showCombinedOnly=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[LogoControl]"}},c.registerOverlay("[LogoControl]",vr),vi.prototype={_className:"ScaleBarContainer",getDomElement:et,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ScalebarControl]"}},c.registerOverlay("[ScalebarControl]",yr),ai.prototype={_className:"BreadcrumbContainer",getDomElement:et,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[BreadcrumbControl]"}},c.registerOverlay("[BreadcrumbControl]",iu),delete window.Microsoft.Maps.initMapDelayCode,a.Dynamic&&a.Dynamic.done("Microsoft.Maps.Overlays"),nr.end("Map delay initialized","mapdelay")},Microsoft.Maps.Map&&Microsoft.Maps.initMapDelayCode&&window.Microsoft.Maps.initMapDelayCode(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},window.Microsoft.Maps.initInfoboxRenderer=function(){function h(i){function f(n,i,r){n.trueEntity&&f(n.trueEntity,i,r);if(u.hasHandler(n,i)){var e=t.Screen.get_mouse_pos(r),o=new v(h,"infobox",n,i,e.x,e.y,0,!1,r);u.invoke(n,i,o)}}var h=i,l="cm"+c.getNext(),r=l+"_etr";this.shouldDraw=function(n,t){return n.getVisible()&&(n.getClip()===!1?t.actualBounds.contains(n.getLocation()):t.currentBounds.contains(n.getLocation()))},this.update=function(c,l){var ii=l.customRenderer,rt=l.update,v,a=c[r],ct,tt,y,st,tr,wt,vi,it,ut,g,w,nt,ft,p,pi,k,b,ht,ni,ri,ir,d,wi,kt,ai,si,dt,yi,et,bt,ci,fi,li,bi,oi,hi,di,gt,pt;a?(rt=a.updateEntity||rt,a.updateEntity=!1):(v=n(null,s.safariRenderHack),a={dom:v},c[r]=a,rt=!0),v=a.dom,ct=c.getTypeName(),tt=c.getHtmlContent()==null||c.getTitle()!==null&&c.getTitle()!==""||c.getDescription()!==null&&c.getDescription()!="";if(rt){a.htmlContent!=null&&tt&&(a.htmlContent.style.display="none",a.infoBoxNode!=null&&(a.infoBoxNode.style.display=""));if(tt){a.infoBoxNode==null?(y=n("div"),v.appendChild(y),y.className=ct,a.infoBoxNode=y):(y=a.infoBoxNode,y.className=ct),y.offsetWidth,c.getShowCloseButton()&&a.closeButtonNode==null&&tt?(st=n("a"),tr=document.createTextNode("x"),y.appendChild(st),st.className="infobox-close",st.href="#",st.appendChild(tr),wt=function(n){n.preventDefault(),(c.trueEntity||c).setOptions({visible:!1})},t(st).add_event("click",wt).add_event("touchend",wt),a.closeButtonHideEvent=wt,a.closeButtonNode=st):c.getShowCloseButton()&&tt||!a.closeButtonNode||(t(a.closeButtonNode).remove_event("click",a.closeButtonHideEvent).remove_event("touchend",a.closeButtonHideEvent),a.closeButtonHideEvent=null,y.removeChild(a.closeButtonNode),a.closeButtonNode=null),vi=c.getHeight()-55,c.getActions().length>0&&(vi-=32),it=c.getTitle(),it===""&&(it=null),ut=c.getDescription(),ut===""&&(ut=null),g=a.contentNode,g==null&&tt?(g=n("div"),g.className="infobox-body",y.appendChild(g),a.contentNode=g):g==null||tt||(y.removeChild(g),a.contentNode=null),w=a.titleDivNode,it!=null&&a.titleDivNode==null&&(w=n("div"),w.className="infobox-title",g.insertBefore(w,g.firstChild),a.titleDivNode=w),nt=a.titleLinkNode,nt!=null&&(a.titleLinkHandler!=null&&(t(nt).remove_event("click",a.titleLinkHandler).remove_event("touchend",a.titleLinkHandler),a.titleLinkHandler=null),nt.firstChild&&nt.removeChild(nt.firstChild),a.titleLinkNode=null,nt=null);while(w!=null&&w.firstChild)w.removeChild(w.firstChild);it==null&&w!=null&&(g.removeChild(w),a.titleDivNode=null),it!=null&&(c.getTitleClickHandler()!=null?(nt=n("a"),w.appendChild(nt),a.titleLinkNode=nt,nt.innerHTML=it,nt.setAttribute("href","#"),t(nt).add_event("click",c.getTitleClickHandler()).add_event("touchend",c.getTitleClickHandler()),a.titleLinkHandler=c.getTitleClickHandler()):w.innerHTML=it),it!==null&&c.getTitleAction()!==null&&(ft=c.getTitleAction(),a.titleAction=[],p=n("a"),p.className="infobox-titleActionLink",p.appendChild(document.createTextNode(ft.label)),kt=ft.url?ft.url:"#",p.setAttribute("href",kt),ft.urltarget&&p.setAttribute("target",ft.urltarget),pi=document.createElement("span"),pi.className="infobox-titleActionSeparator",w.appendChild(pi),w.appendChild(p),t(p).add_event("click",ft.eventHandler).add_event("touchend",ft.eventHandler)),k=a.descriptionNode,ut!=null&&k==null&&(k=n("div"),k.cssText="height:"+vi+"px",k.className="infobox-info",a.actionsNode?g.insertBefore(k,a.actionsNode):g.appendChild(k),a.descriptionNode=k);if(ut!=null)if(ut.innerHTML){while(k.firstChild)k.removeChild(k.firstChild);k.appendChild(ut)}else k.innerHTML=ut;else k&&(v.removeChild(k),a.descriptionNode=null);b=c.getActions();if(b.length>0)if(a.actionsNode!=null){while(a.actionsNode.firstChild)a.actionsNode.removeChild(a.actionsNode.firstChild);ht=a.actionsNode}else ht=n("div"),a.actionsNode=ht,ht.className="infobox-actions",g.appendChild(ht);if(a.actionsEventHandlers!=null)try{while((ni=a.actionsEventHandlers.pop())!=null)t(ni.elem).remove_event("click",ni.event).remove_event("touchend",ni.event)}catch(er){}if(b.length>0){for(ri=n("ul"),ri.className="infobox-actions-list",ir=[],a.actionsEventHandlers=[],d=0;d<b.length;d++){var nr=n("li"),p=n("a"),ui,fr=h.getImageryId();switch(fr){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":ui="dark";break;default:ui="light"}wi=b[d][ui+"Icon"]||b[d].icon,kt=b[d].url?b[d].url:"#",p.setAttribute("href",kt),b[d].urltarget&&p.setAttribute("target",b[d].urltarget),wi?(p.className="icon",ai=n("img"),ai.src=wi,p.appendChild(ai),si=n("span"),si.className="iconUnderline",p.appendChild(si)):(p.innerHTML=b[d].label,p.id=b[d].id),nr.appendChild(p),ri.appendChild(nr),t(p).add_event("click",b[d].eventHandler).add_event("touchend",b[d].eventHandler),a.actionsEventHandlers.push({elem:p,event:b[d].eventHandler})}ht.appendChild(ri)}c.getShowPointer()&&a.pointerNode==null&&tt?(dt=n("div"),dt.className="infobox-stalk",y.appendChild(dt),a.pointerNode=dt):c.getShowPointer()&&tt||!a.pointerNode||(y.removeChild(a.pointerNode),a.pointerNode=null)}else yi=c.getHtmlContent(),et=a.htmlContent,it==null&&ut==null&&yi!=null&&(et==null&&(et=n("div"),v.appendChild(et),a.htmlContent=et),et.innerHTML=yi,y=et,a.infoBoxNode!=null&&(a.infoBoxNode.style.display="none"),a.pointerNode!=null&&(a.pointerNode.style.display="none"),v.style.pointerEvents="all")}var yt="position:absolute;overflow:visible;white-space:normal;line-height:16px;pointer-events:none;",at="position:absolute;background-color:white;border:1px solid rgb(136, 136, 136);left:0px;top:0px;pointer-events:auto;",ki="width:33px;height:38px;overflow:hidden;position:absolute;z-index:1;",lt=c.getClip();if(!ii&&(!l.linear||!a.isDrawn||lt===!1)){bt=h.tryLocationToPixel(c.getLocation(),lt===!1?o.control:o.viewport);if(bt){var gi=c.getOffset(),ei=c.getAnchor(),ur=lt===!1?0:l.parentOffsetLeft||0,rr=lt===!1?0:l.parentOffsetTop||0,ti=bt.x-ur,ot=bt.y-rr;ti=ti+gi.x-ei.x,ot=ot-gi.y-ei.y,rt&&tt?(yt+="left:"+ti+"px;",yt+="top:"+ot+"px;"):(v.style.position="absolute",v.style.left=ti+"px",v.style.top=ot+"px",v.style.display="")}else rt?yt+="display:none;":v.style.display="none"}if(rt&&tt){ci=c.getZIndex(),typeof ci=="number"&&(yt+="z-index:"+ci+";"),at+="width:"+c.getWidth(),at+=typeof c.getWidth()=="number"?"px;":";",at+="height:"+c.getHeight(),at+=typeof c.getHeight()=="number"?"px;":";",lt===!1&&(v.className=i.getRootElement().className,t(v).remove_class("MapTypeId_m").add_class("InfoboxExtension")),v.style.cssText=yt+s.safariRenderHack,ki+="left:20px;",ki+="top:"+c.getHeight()+"px;";if(ct==="Infobox")a.infoBoxNode.style.cssText=at;else{var gt=c.getWidth(),pt=c.getHeight(),vt="";vt+="width:"+gt,vt+=typeof gt=="number"?"px;":";",vt+="height:"+pt,vt+=typeof pt=="number"?"px;":";",a.infoBoxNode.style.cssText=vt}c.getShowPointer()&&ct==="Infobox"&&(a.pointerNode.style.cssText=ki)}c.getShouldFireEvents()&&(a.mapImageryChanged||(fi=function(){u.invoke(c,"entitychanged",{entity:c})},u.addHandler(h,"imagerychanged",fi),a.mapImageryChanged=fi),a.mouseDoubleClickInfobox||(li=function(n){f(c,"dblclick",n),n.stopPropagation()},t(v).add_event("dblclick",li,!0),a.mouseDoubleClickInfobox=li),a.mouseEnterInfobox||(bi=function(n){f(c,"mouseenter",n),n.stopPropagation()},t(v).add_event("mouseenter",bi,!0),a.mouseEnterInfobox=bi),a.mouseLeaveInfobox||(oi=function(n){f(c,"mouseleave",n),n.stopPropagation()},t(v).add_event("mouseleave",oi,!0),a.mouseLeaveInfobox=oi),a.mouseClickInfobox||(hi=function(n){f(c,"click",n),n.stopPropagation()},t(v).add_event("click",hi,!1),a.mouseClickInfobox=hi),t(v).add_event("touchstart",e)),ii?a.isDrawn?rt&&ii.updateEntity(c):(ii.addEntity(c,v),a.isDrawn=!0):(a.isDrawn||(lt===!1?(di=i.getRootElement().parentNode,di.appendChild(v)):l.parentDom.appendChild(v),a.isDrawn=!0),y&&rt===!0&&(ct!==Microsoft.Maps.InfoboxType.standard||c.getHtmlContent()!==null)&&(gt=y.offsetWidth,pt=y.offsetHeight,c.setCalculatedSize({width:gt,height:pt}),ot=ot+ei.y-pt,v.style.top=ot+"px"))},this.remove=function(n,i){if(n&&n[r]){var f=n[r],o=f.dom;o&&f.isDrawn&&(u.removeHandler(f.mapImageryChanged),t(o).remove_event("mouseenter",f.mouseEnterInfobox,!0).remove_event("mouseleave",f.mouseLeaveInfobox,!0).remove_event("click",f.mouseClickInfobox,!1).remove_event("dblclick",f.mouseDoubleClickInfobox,!0).remove_event("touchstart",e,!1),f.mapImageryChanged=f.mouseEnterInfobox=f.mouseLeaveInfobox=f.mouseClickInfobox=f.mouseDoubleClickInfobox=null,o.parentNode&&o.parentNode.removeChild(o)),f.updateEntity=f.updateEntity||i.update,f.isDrawn=!1,i.customRenderer&&i.customRenderer.removeEntity(n)}},this.dispose=function(n){delete n[r]}}var i=window.Microsoft.Maps,t=i.Gimme,y=i.Globals,u=i.Events,l=i.Infobox,o=i.PixelReference,r=i.InternalNamespaceForDelay,a=r.CompositeMode,f=r.Common,v=r.MouseEventArgs,a=r.CompositeMode,c=r.IdGenerator,s=r.Quirks,e=f.stopPropagation,n=f.createElement,e=f.stopPropagation,n=f.createElement;new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof l){f=n.length;while(f--)n[f]===i&&(u=t[f]);u||(u=new h(i),n.push(i),t.push(u))}return u};a.registerEntityRenderer(i)},delete window.Microsoft.Maps.initInfoboxRenderer},Microsoft.Maps.Map&&Microsoft.Maps.initInfoboxRenderer&&Microsoft.Maps.initInfoboxRenderer(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},window.Microsoft.Maps.Streetside=window.Microsoft.Maps.Streetside||{},window.Microsoft.Maps.initStreetsideAvailabilityCode=function(){function a(i,r,u){var e=i.bounds,a=i.center,p=i.radius||n.BlockLookupService.defaultRadiusInMeters,y,f,l,w,h;u=u||t.streetside360,u===t.streetside360?(y=n.CubeLookupService,f=[1,e],e instanceof s||(l=c(p),e=new s(a,l,l),f=[1,e])):(y=n.BlockLookupService,f=[a,p],a instanceof o||(w=v(e),f=[e.center,w])),h=nt(u,r),f.push(h.available,h.unavailable,h.error),y.lookup.apply(window,f)}function v(n){var i=n.height*h.earthCircumferenceInMeters/360,t=n.width*Math.cos(n.center.latitude*w.radiansPerDegree)*h.earthCircumferenceInMeters/360;return Math.floor(Math.sqrt(t*t+i*i)/2)}function c(n){return n*720/h.earthCircumferenceInMeters}function nt(n,i){function f(n){i(!0,{mapTypeId:t.streetside360,cubeID:n[1].id,center:new o(n[1].la,n[1].lo,n[1].al,g.ellipsoid),cubePitch:n[1].pi,cubeHeading:n[1].he,cubeRoll:n[1].ro})}function e(n,r){n.streetsideMetadata=r,n.mapTypeId=t.streetsideSlide,n.center=n.projectedLatitude!=null&&n.projectedLongitude!=null?new o(n.projectedLatitude,n.projectedLongitude):location,i(!0,n)}function r(){i(!1,null)}function u(){i(!1,null)}return{available:n===t.streetside360?f:e,unavailable:r,error:u}}var r=window.Microsoft.Maps,d=r.Map,y=r.Gimme,i=r.Globals,o=r.Location,s=r.LocationRect,t=r.MapTypeId,g=r.AltitudeReference,n=r.Streetside,u=r.InternalNamespaceForDelay,k=u.Dispatcher,h,w,p,l,e,b,f;u.Streetside=u.Streetside||{},h=u.MapMath,w=u.VectorMath,t.streetside360="ss360",t.streetsideSlide="ssSlide",p=1e6,l=8.5,n.isAvailabilityRectTooLarge=function(i,r){return r===t.streetsideSlide?n.isAvailabilityRadiusTooLarge(v(i),r):i.getNorth()-i.getSouth()>l||i.getEast()-i.getWest()>l},n.isAvailabilityRadiusTooLarge=function(i,r){if(r===t.streetsideSlide)return i>p;var u=c(i),f=new location(0,0);return n.isAvailabilityRectTooLarge(new s(f,u,u))},n.isValidMapTypeId=function(n){return n===t.streetside360||n===t.streetsideSlide},n.checkAvailabilityRadius=function(n,t,i,r){if(n instanceof o&&t>=0){var u={center:n,radius:t,bounds:{}};a(u,i,r)}else throw"Cannot invoke availability lookup service -- insufficient or invalid location and/or radius data";},n.checkAvailabilityRect=function(n,t,i){if(n instanceof s){var r={center:{},radius:null,bounds:n};a(r,t,i)}else throw"Cannot invoke availability lookup service -- insufficient or invalid locationRect";},u.Streetside.estimateRectHeightAndWidthFromRadius=c,d.prototype.isStreetside=function(){var n=this.getMapTypeId();return n===t.streetside360||t===n.streetsideSlide},e=n.Config,function(){if(e)return;n.Config={Debug:!0},e=n.Config}(),n.Debug=function(){this.assert=function(n,t){if(!n&&e.Debug)throw"assert failed: "+t;},this.log=function(n){var t=window.console||{};e.Debug&&t.log&&t.log(n)}},b=n.Debug=new n.Debug,f=new function(){var u,e=0,d="microsoftMapsStreetsideCacheableNetworkCallback{0}",g="microsoftMapsStreetsideNetworkCallback{0}",o=5e3,w=30,b=.5,nt=function(){return u||(u=y("HEAD").element()),u},t={},rt=function(){var i=0,n;for(n in t)t.hasOwnProperty(n)&&++i;return i},ut=function(n,t){return n.time>t.time?1:n.time<t.time?-1:0},tt=function(){var f=rt(),e=Math.floor(f*b),r,n,i=[],u;if(f>=w){for(r in t)t.hasOwnProperty(r)&&(u=t[r],u.id=r,i.push(u));for(i.sort(ut),n=0;n<f-e;++n)i[n].inflight===!1&&delete t[i[n].id]}},it=function(n,i){tt();if(t[n]){if(t[n].listeners.length>0){for(var r=0;r<t[n].listeners.length;++r)t[n].listeners[r](i);t[n].listeners.length=0}}else t[n]={},t[n].listeners=[];t[n].inflight=!1,t[n].data=i,t[n].time=new Date},c=function(n){delete t[n]},h=function(i,r,u){t[r]===undefined&&(t[r]={},t[r].listeners=[],t[r].inflight=!1),t[r].data!==undefined?(t[r].time=new Date,k.dispatch(n.Utils.createCallback(null,u,t[r].data))):(t[r].listeners.push(u),t[r].inflight||(t[r].inflight=!0,a(i,r)))},f=function(t,i,r){t?it(r,i):(n.Debug.log("timed out or 404ed id = "+r),c(r))},l=function(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))},r=function(n,t){var n=n,t=t;return function(){if(window[n]!==undefined)try{delete window[n]}catch(i){window[n]=null}l(y("#"+n).element()),t&&window.clearTimeout(t)}},p=function(n,t,i){var n=n,t=t,i=i,u=r(t,i);return function(t){f(!0,t,n),u()}},v=function(n,t){var n=n,t=t,i=r(t);return function(){f(!1,null,n),i()}},s=function(n,t){var i=document.createElement("script");i.type="text/javascript",i.language="javascript",i.src=n,i.id=t,nt().appendChild(i)},a=function(n,t){var i=d.replace("{0}",t),u=window.setTimeout(v(t,i),o),r;window[i]=p(t,i,u),r=n.replace("{callbackName}",i),s(r,i)};this.getChunkMetadataAsync=function(n,t,r){var u=i.streetsideChunkMetadataUriFormat.replace("{0}",i.locale).replace("{1}",t).replace("{2}",n).replace("{3}",i.streetsideTileGeneration).replace("{4}","{callbackName}");h(u,n,r)},this.getGlobalMetadataAsync=function(n,t,r){var u=i.streetsideGlobalMetadataUriFormat.replace("{0}",i.locale).replace("{1}",t).replace("{2}",n).replace("{3}",i.streetsideTileGeneration).replace("{4}","{callbackName}");h(u,n,r)},this.getJsonAsync=function(n,t){var i=g.replace("{0}",e),h=n.replace("{callbackName}",i),f=function(n,t,i){var u=r(n,t),i=i;return function(n){u(),i(n)}},u=window.setTimeout(r(i),o);window[i]=f(i,u,t),++e,s(h,i)}},n.MetadataService=f,n.BlockLookupService=new function(){this.defaultRadiusInMeters=20;var r=15,u=10,e=1e6,t=function(t,i,r){return function(u){u===null?i():u.statusCode&&u.statusCode!==200?(n.Debug.log("Invalid JSON data"+u.errorDetails),r(u)):u.bl&&u.smd?t(u.bl,u.smd):(n.Debug.log("Unexpected JSON response"),r(u))}};this.lookup=function(o,s,h,c,l){if(!o||o.latitude<-90||o.latitude>90||o.longitude<-180||o.longitude>180||!s||typeof h!="function"||typeof c!="function"||typeof l!="function")n.Debug.assert(!1,"Expected location, radius, and 3 callback functions as arguments");else{s=Math.min(Math.max(s,u),e);var a=i.streetsideSingleBlockLookupWithDataUriFormat.replace("{0}",i.locale).replace("{1}",i.streetsideTileGeneration).replace("{2}",o.latitude.toFixed(r)).replace("{3}",o.longitude.toFixed(r)).replace("{4}",s).replace("{5}","{callbackName}");f.getJsonAsync(a,t(h,c,l))}},this.tokenLookup=function(r,u,e,o){if(r&&typeof u=="function"&&typeof e=="function"&&typeof o=="function"){var s=i.streetsideSingleBlockTokenLookupWithDataUriFormat.replace("{0}",i.locale).replace("{1}",i.streetsideTileGeneration).replace("{2}",r).replace("{3}","{callbackName}");f.getJsonAsync(s,t(u,e,o))}else n.Debug.assert(!1,"Expected token, and 3 callback functions as arguments")}},n.CubeLookupService=new function(){function t(t,i,r){return function(u){u===null?(n.Debug.log("Unexpected JSON response"),r(u)):u.length>1?t(u):i()}}var r=i.streetsideCubeDataLookupUriFormat;this.lookup=function(i,u,e,o,s,h){i=i||1,o=o||function(){},s=s||function(){},h=h||"",n.Debug.assert(u&&e,"Minimum expected arguments: locationRect, and a callback function");var c=r.replace("{0}",i).replace("{1}",u.getNorth()).replace("{2}",u.getSouth()).replace("{3}",u.getEast()).replace("{4}",u.getWest()).replace("{5}","{callbackName}").replace("{6}",h);f.getJsonAsync(c,t(e,o,s))}},delete window.Microsoft.Maps.initStreetsideAvailabilityCode},Microsoft.Maps.Map&&Microsoft.Maps.initStreetsideAvailabilityCode&&window.Microsoft.Maps.initStreetsideAvailabilityCode(),window.Microsoft=window.Microsoft||{},window.Microsoft.Maps=window.Microsoft.Maps||{},window.Microsoft.Maps.initMapAnalytics=function(){var n="length",o="indexOf",l="apply",r=window.Microsoft.Maps,c=r.Analytics=r.Analytics||{},f=r.Gimme,e=r.Globals,i=r.Events,u=r.InternalNamespaceForDelay,h=u.Common,t;if(!e.disableAnalytics){function s(r){function y(n){if(n&&n.currentTarget){var t=f(n.currentTarget).get_attr("uici");t&&d({uici:t,autoLog:!0})}}function ti(n){if(n){n.lod=u.getZoom().toPrecision(2),n.mo=u.getHeading().toPrecision(3);var t=u.getCenter();n.mc="["+t.latitude.toPrecision(6)+","+t.longitude.toPrecision(6)+"]",n.til=a,k=!1}}function ii(){var n=u.getTileDownloadMetrics();a=n>a?n:a+n,k=!0}function gt(){!k||u.isDownloadingTiles()||t.getDataBacklog()>0||d({})}function ni(n){n.componentName===ot&&(ut(),i.removeHandler(tt),tt=null)}function ut(){u&&u.overlays&&ft(u.overlays.getDomElement())}function lt(){for(var r=p[n],t,i=0;i<r;i++)t=p.shift(),typeof t[3]!="string"&&(t[3]=l?v:c),rt.LogIG.apply(s,t)}function d(n){var e,o,r,i,u;if(n){var t=n.customData||{},f=l?v:n.IG||c,a=n.autoLog;ti(t),t.uici=n.uici;if(a)for(e in h)h[e](t);if(n&&n.onClientAction)n.onClientAction(t);o=n.forceDispatch||!1,r=[bt,0,o,f];for(i in t)u=t[i],i!==null&&i!==undefined&&u!==null&&u!==undefined&&r.push(i,u);f&&it?rt.LogIG.apply(s,r):p.push(r)}}function ft(n){f(n).select(et).add_event(g,y)}function vt(n){f(n).add_event(g,y)}function at(n,t){typeof n=="string"&&typeof t=="function"&&(h[n]=t)}function yt(n){typeof n=="string"&&delete h[n]}function pt(n){it||(n&&(c=n.pageViewId||null,v=n.sessionKey||null,b=n.cId||null,st=n.pcId||null),(c||l&&v)&&(it=!0,lt(),ct=window.setInterval(gt,dt)))}function ht(){var r,n;window.clearInterval(ct),t.dispose(),i.removeHandler(nt),nt=null,i.removeHandler(w),w=null;for(r in h)delete h[r];h=null,u&&u.overlays&&(n=f(u.overlays.getDomElement()),n.select(et).remove_event(g,y))}function wt(){u&&(nt=i.addHandler(u,"ondispose",ht),u.getComponent(ot)?ut():tt=i.addHandler(u,"componentadded",ni),u.addComponent("analyticsManager",s),w=i.addHandler(u,"tiledownloadcomplete",ii))}var s=r.getComponent("analyticsManager");if(s)return s;s=this;var c,b,st=null,et="a,input[type=button],input[type=submit],input[type=checkbox],input[type=radio],button,.button,.pathNode",bt="MAPSAction",g="mousedown",h={},u=r,nt=null,tt=null,it=!1,ot="navigationBar",p=[],v=null,l=e.frontdoorLogUrl?!1:!0,kt=e.biciLoggingService||e.frontdoorLogUrl,dt=3e4,ct=-1,ri="tdd",a=0,k=!0,ui=null,w=null,rt=new function(){function w(){r("Init","CI","Base",!1),a=window.setInterval(h,y),v=1,f(window).add_event("beforeunload",s)}function r(i,r,u,f,e){var y="",w=e||c,v,a,h,p;if(w){if(f)for(v=0;v<f[n];v+=2)a=f[v],h=f[v+1],(typeof a!="string"||a[o]('"')<0)&&(a='"'+a+'"'),typeof h=="string"&&h[o]("{")<0&&h[o]('"')<0&&(h='"'+h+'"'),y+=a+":"+h+",";p='"TS":'+ +new Date,y+=l?p:'"T":"CI.'+i+'",'+(typeof r=="number"?'"K":'+r:'"FID":"'+r+'"')+","+p,t.add(w,y),u&&s()}}function k(){var n=kt;return n+=l?"?sk=%ig%&pid="+e.biciPID+"&DATA=":"?IG=%ig%"+(b?"&CID="+b:"")+(st?"&PM=Y":"")+"&TYPE=Event.ClientInst&DATA="}function s(){while(t.getDataBacklog()>0)h()}function h(){if(t.getDataBacklog()>0&&!u.isDownloadingTiles()){var n=t.fetchNextRequest(k(),p);n&&(i.ping.src=n)}}var i=this,p=2048,y=2e3,v=0,a=-1;i.ping=new Image,i.LogIG=function(n,t,i,u){v||w(),r(n,t,i,[].slice.apply(arguments).slice(4),u)}};s.removePreProcessor=yt,s.addPreProcessor=at,s.registerAction=vt,s.registerChildActions=ft,s.logClientAction=d,s.dispose=ht,s.enable=pt,wt()}c.AnalyticsManager=s}t=new function(){var t={},i=0;this.getDataBacklog=function(){return i},this.add=function(r,u){var f=t[r],u="{"+encodeURIComponent(u)+"}";f||(f=t[r]=[]),f.push(u),i+=u[n]},this.dispose=function(){for(var n in t)t.hasOwnProperty(n)&&(t[n]=null,delete t[n]);t={},i=0},this.fetchNextRequest=function(r,u){var l=null,e,s,v,o,a,f,c;if(typeof r=="string"&&u>0)for(e in t){s=e&&t[e],r=r.replace("%ig%",e),v=r[n]+e[n]+1;if(h.isArray(s)&&s[n]>0){o="[",a=!0;while(s[n]>0){f=s.shift();if(f){c=f[n],i-=c,f=(a?"":",")+f,c=f[n];if(c+o[n]+v>=u){l=r+o+"]";break}o+=f,a=!1}}l=r+o+"]",delete t[e];break}}return l}},delete window.Microsoft.Maps.initMapAnalytics,u&&u.Dynamic&&u.Dynamic.done("Microsoft.Maps.Analytics"),u&&u.PRF.end("Module initialized","Microsoft.Maps.Analytics",{module:"Analytics"})},Microsoft.Maps.Map&&Microsoft.Maps.initMapAnalytics&&window.Microsoft.Maps.initMapAnalytics()